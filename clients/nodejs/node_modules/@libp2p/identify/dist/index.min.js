(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PIdentify = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PIdentify=(()=>{var fc=Object.create;var Nr=Object.defineProperty;var lc=Object.getOwnPropertyDescriptor;var dc=Object.getOwnPropertyNames;var hc=Object.getPrototypeOf,pc=Object.prototype.hasOwnProperty;var mc=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),St=(r,t)=>{for(var e in t)Nr(r,e,{get:t[e],enumerable:!0})},Os=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of dc(t))!pc.call(r,o)&&o!==e&&Nr(r,o,{get:()=>t[o],enumerable:!(n=lc(t,o))||n.enumerable});return r};var yc=(r,t,e)=>(e=r!=null?fc(hc(r)):{},Os(t||!r||!r.__esModule?Nr(e,"default",{value:r,enumerable:!0}):e,r)),gc=r=>Os(Nr({},"__esModule",{value:!0}),r);var Za=mc(Dr=>{(function(){var r,t,e,n,o,s,i,c;c=function(a){var f,u,l,d;return f=(a&255<<24)>>>24,u=(a&255<<16)>>>16,l=(a&65280)>>>8,d=a&255,[f,u,l,d].join(".")},i=function(a){var f,u,l,d,b,m;for(f=[],l=d=0;d<=3&&a.length!==0;l=++d){if(l>0){if(a[0]!==".")throw new Error("Invalid IP");a=a.substring(1)}m=t(a),b=m[0],u=m[1],a=a.substring(u),f.push(b)}if(a.length!==0)throw new Error("Invalid IP");switch(f.length){case 1:if(f[0]>4294967295)throw new Error("Invalid IP");return f[0]>>>0;case 2:if(f[0]>255||f[1]>16777215)throw new Error("Invalid IP");return(f[0]<<24|f[1])>>>0;case 3:if(f[0]>255||f[1]>255||f[2]>65535)throw new Error("Invalid IP");return(f[0]<<24|f[1]<<16|f[2])>>>0;case 4:if(f[0]>255||f[1]>255||f[2]>255||f[3]>255)throw new Error("Invalid IP");return(f[0]<<24|f[1]<<16|f[2]<<8|f[3])>>>0;default:throw new Error("Invalid IP")}},e=function(a){return a.charCodeAt(0)},n=e("0"),s=e("a"),o=e("A"),t=function(a){var f,u,l,d,b;for(d=0,f=10,u="9",l=0,a.length>1&&a[l]==="0"&&(a[l+1]==="x"||a[l+1]==="X"?(l+=2,f=16):"0"<=a[l+1]&&a[l+1]<="9"&&(l++,f=8,u="7")),b=l;l<a.length;){if("0"<=a[l]&&a[l]<=u)d=d*f+(e(a[l])-n)>>>0;else if(f===16)if("a"<=a[l]&&a[l]<="f")d=d*f+(10+e(a[l])-s)>>>0;else if("A"<=a[l]&&a[l]<="F")d=d*f+(10+e(a[l])-o)>>>0;else break;else break;if(d>4294967295)throw new Error("too large");l++}if(l===b)throw new Error("empty octet");return[d,l]},r=function(){function a(f,u){var l,d,b,m;if(typeof f!="string")throw new Error("Missing `net' parameter");if(u||(m=f.split("/",2),f=m[0],u=m[1]),u||(u=32),typeof u=="string"&&u.indexOf(".")>-1){try{this.maskLong=i(u)}catch(g){throw l=g,new Error("Invalid mask: "+u)}for(d=b=32;b>=0;d=--b)if(this.maskLong===4294967295<<32-d>>>0){this.bitmask=d;break}}else if(u||u===0)this.bitmask=parseInt(u,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0);else throw new Error("Invalid mask: empty");try{this.netLong=(i(f)&this.maskLong)>>>0}catch(g){throw l=g,new Error("Invalid net address: "+f)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+u);this.size=Math.pow(2,32-this.bitmask),this.base=c(this.netLong),this.mask=c(this.maskLong),this.hostmask=c(~this.maskLong),this.first=this.bitmask<=30?c(this.netLong+1):this.base,this.last=this.bitmask<=30?c(this.netLong+this.size-2):c(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?c(this.netLong+this.size-1):void 0}return a.prototype.contains=function(f){return typeof f=="string"&&(f.indexOf("/")>0||f.split(".").length!==4)&&(f=new a(f)),f instanceof a?this.contains(f.base)&&this.contains(f.broadcast||f.last):(i(f)&this.maskLong)>>>0===(this.netLong&this.maskLong)>>>0},a.prototype.next=function(f){return f==null&&(f=1),new a(c(this.netLong+this.size*f),this.mask)},a.prototype.forEach=function(f){var u,l,d;for(d=i(this.first),l=i(this.last),u=0;d<=l;)f(c(d),d,u),u++,d++},a.prototype.toString=function(){return this.base+"/"+this.bitmask},a}(),Dr.ip2long=i,Dr.long2ip=c,Dr.Netmask=r}).call(Dr)});var Ql={};St(Ql,{identify:()=>Xl,identifyPush:()=>Jl});var Dn=Symbol.for("@libp2p/peer-id");var ft=class extends Error{static name="InvalidParametersError";constructor(t="Invalid parameters"){super(t),this.name="InvalidParametersError"}},Ne=class extends Error{static name="InvalidPublicKeyError";constructor(t="Invalid public key"){super(t),this.name="InvalidPublicKeyError"}};var Kr=class extends Error{static name="InvalidCIDError";constructor(t="Invalid CID"){super(t),this.name="InvalidCIDError"}},kr=class extends Error{static name="InvalidMultihashError";constructor(t="Invalid Multihash"){super(t),this.name="InvalidMultihashError"}},Mr=class extends Error{static name="UnsupportedProtocolError";constructor(t="Unsupported protocol error"){super(t),this.name="UnsupportedProtocolError"}},Ut=class extends Error{static name="InvalidMessageError";constructor(t="Invalid message"){super(t),this.name="InvalidMessageError"}};var xe=class extends Error{static name="UnsupportedKeyTypeError";constructor(t="Unsupported key type"){super(t),this.name="UnsupportedKeyTypeError"}};var Fr=Symbol.for("@libp2p/service-capabilities"),nd=Symbol.for("@libp2p/service-dependencies");var Kn={};St(Kn,{base58btc:()=>X,base58flickr:()=>Ac});var Bd=new Uint8Array(0);function Ns(r,t){if(r===t)return!0;if(r.byteLength!==t.byteLength)return!1;for(let e=0;e<r.byteLength;e++)if(r[e]!==t[e])return!1;return!0}function Yt(r){if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")}function Ks(r){return new TextEncoder().encode(r)}function ks(r){return new TextDecoder().decode(r)}function bc(r,t){if(r.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),n=0;n<e.length;n++)e[n]=255;for(var o=0;o<r.length;o++){var s=r.charAt(o),i=s.charCodeAt(0);if(e[i]!==255)throw new TypeError(s+" is ambiguous");e[i]=o}var c=r.length,a=r.charAt(0),f=Math.log(c)/Math.log(256),u=Math.log(256)/Math.log(c);function l(m){if(m instanceof Uint8Array||(ArrayBuffer.isView(m)?m=new Uint8Array(m.buffer,m.byteOffset,m.byteLength):Array.isArray(m)&&(m=Uint8Array.from(m))),!(m instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(m.length===0)return"";for(var g=0,h=0,w=0,S=m.length;w!==S&&m[w]===0;)w++,g++;for(var y=(S-w)*u+1>>>0,I=new Uint8Array(y);w!==S;){for(var D=m[w],_=0,P=y-1;(D!==0||_<h)&&P!==-1;P--,_++)D+=256*I[P]>>>0,I[P]=D%c>>>0,D=D/c>>>0;if(D!==0)throw new Error("Non-zero carry");h=_,w++}for(var C=y-h;C!==y&&I[C]===0;)C++;for(var L=a.repeat(g);C<y;++C)L+=r.charAt(I[C]);return L}function d(m){if(typeof m!="string")throw new TypeError("Expected String");if(m.length===0)return new Uint8Array;var g=0;if(m[g]!==" "){for(var h=0,w=0;m[g]===a;)h++,g++;for(var S=(m.length-g)*f+1>>>0,y=new Uint8Array(S);m[g];){var I=e[m.charCodeAt(g)];if(I===255)return;for(var D=0,_=S-1;(I!==0||D<w)&&_!==-1;_--,D++)I+=c*y[_]>>>0,y[_]=I%256>>>0,I=I/256>>>0;if(I!==0)throw new Error("Non-zero carry");w=D,g++}if(m[g]!==" "){for(var P=S-w;P!==S&&y[P]===0;)P++;for(var C=new Uint8Array(h+(S-P)),L=h;P!==S;)C[L++]=y[P++];return C}}}function b(m){var g=d(m);if(g)return g;throw new Error(`Non-${t} character`)}return{encode:l,decodeUnsafe:d,decode:b}}var xc=bc,wc=xc,Fs=wc;var Rn=class{name;prefix;baseEncode;constructor(t,e,n){this.name=t,this.prefix=e,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},Un=class{name;prefix;baseDecode;prefixCodePoint;constructor(t,e,n){this.name=t,this.prefix=e;let o=e.codePointAt(0);if(o===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=o,this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Vs(this,t)}},On=class{decoders;constructor(t){this.decoders=t}or(t){return Vs(this,t)}decode(t){let e=t[0],n=this.decoders[e];if(n!=null)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function Vs(r,t){return new On({...r.decoders??{[r.prefix]:r},...t.decoders??{[t.prefix]:t}})}var Nn=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(t,e,n,o){this.name=t,this.prefix=e,this.baseEncode=n,this.baseDecode=o,this.encoder=new Rn(t,e,n),this.decoder=new Un(t,e,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}};function Ke({name:r,prefix:t,encode:e,decode:n}){return new Nn(r,t,e,n)}function ie({name:r,prefix:t,alphabet:e}){let{encode:n,decode:o}=Fs(e,r);return Ke({prefix:t,name:r,encode:n,decode:s=>Yt(o(s))})}function Ec(r,t,e,n){let o={};for(let u=0;u<t.length;++u)o[t[u]]=u;let s=r.length;for(;r[s-1]==="=";)--s;let i=new Uint8Array(s*e/8|0),c=0,a=0,f=0;for(let u=0;u<s;++u){let l=o[r[u]];if(l===void 0)throw new SyntaxError(`Non-${n} character`);a=a<<e|l,c+=e,c>=8&&(c-=8,i[f++]=255&a>>c)}if(c>=e||(255&a<<8-c)!==0)throw new SyntaxError("Unexpected end of data");return i}function vc(r,t,e){let n=t[t.length-1]==="=",o=(1<<e)-1,s="",i=0,c=0;for(let a=0;a<r.length;++a)for(c=c<<8|r[a],i+=8;i>e;)i-=e,s+=t[o&c>>i];if(i!==0&&(s+=t[o&c<<e-i]),n)for(;(s.length*e&7)!==0;)s+="=";return s}function nt({name:r,prefix:t,bitsPerChar:e,alphabet:n}){return Ke({prefix:t,name:r,encode(o){return vc(o,n,e)},decode(o){return Ec(o,n,e,r)}})}var X=ie({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Ac=ie({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var kn={};St(kn,{base32:()=>Xt,base32hex:()=>Pc,base32hexpad:()=>Lc,base32hexpadupper:()=>Tc,base32hexupper:()=>Cc,base32pad:()=>Ic,base32padupper:()=>Bc,base32upper:()=>Sc,base32z:()=>_c});var Xt=nt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Sc=nt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ic=nt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Bc=nt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Pc=nt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Cc=nt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Lc=nt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Tc=nt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),_c=nt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Mn={};St(Mn,{base36:()=>ir,base36upper:()=>Dc});var ir=ie({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Dc=ie({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Rc=zs,qs=128,Uc=127,Oc=~Uc,Nc=Math.pow(2,31);function zs(r,t,e){t=t||[],e=e||0;for(var n=e;r>=Nc;)t[e++]=r&255|qs,r/=128;for(;r&Oc;)t[e++]=r&255|qs,r>>>=7;return t[e]=r|0,zs.bytes=e-n+1,t}var Kc=Fn,kc=128,Hs=127;function Fn(r,n){var e=0,n=n||0,o=0,s=n,i,c=r.length;do{if(s>=c)throw Fn.bytes=0,new RangeError("Could not decode varint");i=r[s++],e+=o<28?(i&Hs)<<o:(i&Hs)*Math.pow(2,o),o+=7}while(i>=kc);return Fn.bytes=s-n,e}var Mc=Math.pow(2,7),Fc=Math.pow(2,14),Vc=Math.pow(2,21),qc=Math.pow(2,28),Hc=Math.pow(2,35),zc=Math.pow(2,42),Gc=Math.pow(2,49),$c=Math.pow(2,56),Zc=Math.pow(2,63),jc=function(r){return r<Mc?1:r<Fc?2:r<Vc?3:r<qc?4:r<Hc?5:r<zc?6:r<Gc?7:r<$c?8:r<Zc?9:10},Wc={encode:Rc,decode:Kc,encodingLength:jc},Yc=Wc,ar=Yc;function cr(r,t=0){return[ar.decode(r,t),ar.decode.bytes]}function ke(r,t,e=0){return ar.encode(r,t,e),t}function Me(r){return ar.encodingLength(r)}function Ot(r,t){let e=t.byteLength,n=Me(r),o=n+Me(e),s=new Uint8Array(o+e);return ke(r,s,0),ke(e,s,n),s.set(t,o),new Fe(r,e,t,s)}function we(r){let t=Yt(r),[e,n]=cr(t),[o,s]=cr(t.subarray(n)),i=t.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new Fe(e,o,i,t)}function Gs(r,t){if(r===t)return!0;{let e=t;return r.code===e.code&&r.size===e.size&&e.bytes instanceof Uint8Array&&Ns(r.bytes,e.bytes)}}var Fe=class{code;size;digest;bytes;constructor(t,e,n,o){this.code=t,this.size=e,this.digest=n,this.bytes=o}};function $s(r,t){let{bytes:e,version:n}=r;switch(n){case 0:return Jc(e,Vn(r),t??X.encoder);default:return Qc(e,Vn(r),t??Xt.encoder)}}var Zs=new WeakMap;function Vn(r){let t=Zs.get(r);if(t==null){let e=new Map;return Zs.set(r,e),e}return t}var ct=class r{code;version;multihash;bytes;"/";constructor(t,e,n,o){this.code=e,this.version=t,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:e}=this;if(t!==ur)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(e.code!==tu)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return r.createV0(e)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:e}=this.multihash,n=Ot(t,e);return r.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return r.equals(this,t)}static equals(t,e){let n=e;return n!=null&&t.code===n.code&&t.version===n.version&&Gs(t.multihash,n.multihash)}toString(t){return $s(this,t)}toJSON(){return{"/":$s(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let e=t;if(e instanceof r)return e;if(e["/"]!=null&&e["/"]===e.bytes||e.asCID===e){let{version:n,code:o,multihash:s,bytes:i}=e;return new r(n,o,s,i??js(n,o,s.bytes))}else if(e[eu]===!0){let{version:n,multihash:o,code:s}=e,i=we(o);return r.create(n,s,i)}else return null}static create(t,e,n){if(typeof e!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(e!==ur)throw new Error(`Version 0 CID must use dag-pb (code: ${ur}) block encoding`);return new r(t,e,n,n.bytes)}case 1:{let o=js(t,e,n.bytes);return new r(t,e,n,o)}default:throw new Error("Invalid version")}}static createV0(t){return r.create(0,ur,t)}static createV1(t,e){return r.create(1,t,e)}static decode(t){let[e,n]=r.decodeFirst(t);if(n.length!==0)throw new Error("Incorrect length");return e}static decodeFirst(t){let e=r.inspectBytes(t),n=e.size-e.multihashSize,o=Yt(t.subarray(n,n+e.multihashSize));if(o.byteLength!==e.multihashSize)throw new Error("Incorrect length");let s=o.subarray(e.multihashSize-e.digestSize),i=new Fe(e.multihashCode,e.digestSize,s,o);return[e.version===0?r.createV0(i):r.createV1(e.codec,i),t.subarray(e.size)]}static inspectBytes(t){let e=0,n=()=>{let[l,d]=cr(t.subarray(e));return e+=d,l},o=n(),s=ur;if(o===18?(o=0,e=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=e,c=n(),a=n(),f=e+a,u=f-i;return{version:o,codec:s,multihashCode:c,digestSize:a,multihashSize:u,size:f}}static parse(t,e){let[n,o]=Xc(t,e),s=r.decode(o);if(s.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Vn(s).set(n,t),s}};function Xc(r,t){switch(r[0]){case"Q":{let e=t??X;return[X.prefix,e.decode(`${X.prefix}${r}`)]}case X.prefix:{let e=t??X;return[X.prefix,e.decode(r)]}case Xt.prefix:{let e=t??Xt;return[Xt.prefix,e.decode(r)]}case ir.prefix:{let e=t??ir;return[ir.prefix,e.decode(r)]}default:{if(t==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[r[0],t.decode(r)]}}}function Jc(r,t,e){let{prefix:n}=e;if(n!==X.prefix)throw Error(`Cannot string encode V0 in ${e.name} encoding`);let o=t.get(n);if(o==null){let s=e.encode(r).slice(1);return t.set(n,s),s}else return o}function Qc(r,t,e){let{prefix:n}=e,o=t.get(n);if(o==null){let s=e.encode(r);return t.set(n,s),s}else return o}var ur=112,tu=18;function js(r,t,e){let n=Me(r),o=n+Me(t),s=new Uint8Array(o+e.byteLength);return ke(r,s,0),ke(t,s,n),s.set(e,o),s}var eu=Symbol.for("@ipld/js-cid/CID");var qn={};St(qn,{identity:()=>Nt});var Ws=0,ru="identity",Ys=Yt;function nu(r){return Ot(Ws,Ys(r))}var Nt={code:Ws,name:ru,encode:Ys,digest:nu};function ht(r,t){if(r===t)return!0;if(r.byteLength!==t.byteLength)return!1;for(let e=0;e<r.byteLength;e++)if(r[e]!==t[e])return!1;return!0}function yt(r=0){return new Uint8Array(r)}function It(r=0){return new Uint8Array(r)}function Lt(r,t){t==null&&(t=r.reduce((o,s)=>o+s.length,0));let e=It(t),n=0;for(let o of r)e.set(o,n),n+=o.length;return e}var Js=Symbol.for("@achingbrain/uint8arraylist");function Xs(r,t){if(t==null||t<0)throw new RangeError("index is out of bounds");let e=0;for(let n of r){let o=e+n.byteLength;if(t<o)return{buf:n,index:t-e};e=o}throw new RangeError("index is out of bounds")}function qr(r){return!!r?.[Js]}var st=class r{bufs;length;[Js]=!0;constructor(...t){this.bufs=[],this.length=0,t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...t){this.appendAll(t)}appendAll(t){let e=0;for(let n of t)if(n instanceof Uint8Array)e+=n.byteLength,this.bufs.push(n);else if(qr(n))e+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=e}prepend(...t){this.prependAll(t)}prependAll(t){let e=0;for(let n of t.reverse())if(n instanceof Uint8Array)e+=n.byteLength,this.bufs.unshift(n);else if(qr(n))e+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=e}get(t){let e=Xs(this.bufs,t);return e.buf[e.index]}set(t,e){let n=Xs(this.bufs,t);n.buf[n.index]=e}write(t,e=0){if(t instanceof Uint8Array)for(let n=0;n<t.length;n++)this.set(e+n,t[n]);else if(qr(t))for(let n=0;n<t.length;n++)this.set(e+n,t.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(t){if(t=Math.trunc(t),!(Number.isNaN(t)||t<=0)){if(t===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(t>=this.bufs[0].byteLength)t-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(t),this.length-=t;break}}}slice(t,e){let{bufs:n,length:o}=this._subList(t,e);return Lt(n,o)}subarray(t,e){let{bufs:n,length:o}=this._subList(t,e);return n.length===1?n[0]:Lt(n,o)}sublist(t,e){let{bufs:n,length:o}=this._subList(t,e),s=new r;return s.length=o,s.bufs=[...n],s}_subList(t,e){if(t=t??0,e=e??this.length,t<0&&(t=this.length+t),e<0&&(e=this.length+e),t<0||e>this.length)throw new RangeError("index is out of bounds");if(t===e)return{bufs:[],length:0};if(t===0&&e===this.length)return{bufs:this.bufs,length:this.length};let n=[],o=0;for(let s=0;s<this.bufs.length;s++){let i=this.bufs[s],c=o,a=c+i.byteLength;if(o=a,t>=a)continue;let f=t>=c&&t<a,u=e>c&&e<=a;if(f&&u){if(t===c&&e===a){n.push(i);break}let l=t-c;n.push(i.subarray(l,l+(e-t)));break}if(f){if(t===0){n.push(i);continue}n.push(i.subarray(t-c));continue}if(u){if(e===a){n.push(i);break}n.push(i.subarray(0,e-c));break}n.push(i)}return{bufs:n,length:e-t}}indexOf(t,e=0){if(!qr(t)&&!(t instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=t instanceof Uint8Array?t:t.subarray();if(e=Number(e??0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let o=n.byteLength;if(o===0)throw new TypeError("search must be at least 1 byte long");let s=256,i=new Int32Array(s);for(let l=0;l<s;l++)i[l]=-1;for(let l=0;l<o;l++)i[n[l]]=l;let c=i,a=this.byteLength-n.byteLength,f=n.byteLength-1,u;for(let l=e;l<=a;l+=u){u=0;for(let d=f;d>=0;d--){let b=this.get(l+d);if(n[d]!==b){u=Math.max(1,d-c[b]);break}}if(u===0)return l}return-1}getInt8(t){let e=this.subarray(t,t+1);return new DataView(e.buffer,e.byteOffset,e.byteLength).getInt8(0)}setInt8(t,e){let n=It(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,e),this.write(n,t)}getInt16(t,e){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,e)}setInt16(t,e,n){let o=yt(2);new DataView(o.buffer,o.byteOffset,o.byteLength).setInt16(0,e,n),this.write(o,t)}getInt32(t,e){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,e)}setInt32(t,e,n){let o=yt(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setInt32(0,e,n),this.write(o,t)}getBigInt64(t,e){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,e)}setBigInt64(t,e,n){let o=yt(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setBigInt64(0,e,n),this.write(o,t)}getUint8(t){let e=this.subarray(t,t+1);return new DataView(e.buffer,e.byteOffset,e.byteLength).getUint8(0)}setUint8(t,e){let n=It(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,e),this.write(n,t)}getUint16(t,e){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,e)}setUint16(t,e,n){let o=yt(2);new DataView(o.buffer,o.byteOffset,o.byteLength).setUint16(0,e,n),this.write(o,t)}getUint32(t,e){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,e)}setUint32(t,e,n){let o=yt(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setUint32(0,e,n),this.write(o,t)}getBigUint64(t,e){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,e)}setBigUint64(t,e,n){let o=yt(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setBigUint64(0,e,n),this.write(o,t)}getFloat32(t,e){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,e)}setFloat32(t,e,n){let o=yt(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat32(0,e,n),this.write(o,t)}getFloat64(t,e){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,e)}setFloat64(t,e,n){let o=yt(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat64(0,e,n),this.write(o,t)}equals(t){if(t==null||!(t instanceof r)||t.bufs.length!==this.bufs.length)return!1;for(let e=0;e<this.bufs.length;e++)if(!ht(this.bufs[e],t.bufs[e]))return!1;return!0}static fromUint8Arrays(t,e){let n=new r;return n.bufs=t,e==null&&(e=t.reduce((o,s)=>o+s.byteLength,0)),n.length=e,n}};var Hn={};St(Hn,{base10:()=>ou});var ou=ie({prefix:"9",name:"base10",alphabet:"0123456789"});var zn={};St(zn,{base16:()=>su,base16upper:()=>iu});var su=nt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),iu=nt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Gn={};St(Gn,{base2:()=>au});var au=nt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var $n={};St($n,{base256emoji:()=>du});var Qs=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),cu=Qs.reduce((r,t,e)=>(r[e]=t,r),[]),uu=Qs.reduce((r,t,e)=>{let n=t.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${t}`);return r[n]=e,r},[]);function fu(r){return r.reduce((t,e)=>(t+=cu[e],t),"")}function lu(r){let t=[];for(let e of r){let n=e.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${e}`);let o=uu[n];if(o==null)throw new Error(`Non-base256emoji character: ${e}`);t.push(o)}return new Uint8Array(t)}var du=Ke({prefix:"\u{1F680}",name:"base256emoji",encode:fu,decode:lu});var jn={};St(jn,{base64:()=>hu,base64pad:()=>pu,base64url:()=>Zn,base64urlpad:()=>mu});var hu=nt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),pu=nt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Zn=nt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),mu=nt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Wn={};St(Wn,{base8:()=>yu});var yu=nt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Yn={};St(Yn,{identity:()=>gu});var gu=Ke({prefix:"\0",name:"identity",encode:r=>ks(r),decode:r=>Ks(r)});var uh=new TextEncoder,fh=new TextDecoder;var Qn={};St(Qn,{sha256:()=>fr,sha512:()=>wu});function Jn({name:r,code:t,encode:e}){return new Xn(r,t,e)}var Xn=class{name;code;encode;constructor(t,e,n){this.name=t,this.code=e,this.encode=n}digest(t){if(t instanceof Uint8Array){let e=this.encode(t);return e instanceof Uint8Array?Ot(this.code,e):e.then(n=>Ot(this.code,n))}else throw Error("Unknown type, must be binary type")}};function ei(r){return async t=>new Uint8Array(await crypto.subtle.digest(r,t))}var fr=Jn({name:"sha2-256",code:18,encode:ei("SHA-256")}),wu=Jn({name:"sha2-512",code:19,encode:ei("SHA-512")});var lr={...Yn,...Gn,...Wn,...Hn,...zn,...kn,...Mn,...Kn,...jn,...$n},vh={...Qn,...qn};function ni(r,t,e,n){return{name:r,prefix:t,encoder:{name:r,prefix:t,encode:e},decoder:{decode:n}}}var ri=ni("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),to=ni("ascii","a",r=>{let t="a";for(let e=0;e<r.length;e++)t+=String.fromCharCode(r[e]);return t},r=>{r=r.substring(1);let t=It(r.length);for(let e=0;e<r.length;e++)t[e]=r.charCodeAt(e);return t}),Eu={utf8:ri,"utf-8":ri,hex:lr.base16,latin1:to,ascii:to,binary:to,...lr},Hr=Eu;function M(r,t="utf8"){let e=Hr[t];if(e==null)throw new Error(`Unsupported encoding "${t}"`);return e.decoder.decode(`${e.prefix}${r}`)}function U(r,t="utf8"){let e=Hr[t];if(e==null)throw new Error(`Unsupported encoding "${t}"`);return e.encoder.encode(r).substring(1)}var vu=parseInt("11111",2),eo=parseInt("10000000",2),Au=parseInt("01111111",2),oi={0:dr,1:dr,2:Su,3:Pu,4:Cu,5:Bu,6:Iu,16:dr,22:dr,48:dr};function Jt(r,t={offset:0}){let e=r[t.offset]&vu;if(t.offset++,oi[e]!=null)return oi[e](r,t);throw new Error("No decoder for tag "+e)}function hr(r,t){let e=0;if((r[t.offset]&eo)===eo){let n=r[t.offset]&Au,o="0x";t.offset++;for(let s=0;s<n;s++,t.offset++)o+=r[t.offset].toString(16).padStart(2,"0");e=parseInt(o,16)}else e=r[t.offset],t.offset++;return e}function dr(r,t){hr(r,t);let e=[];for(;!(t.offset>=r.byteLength);){let n=Jt(r,t);if(n===null)break;e.push(n)}return e}function Su(r,t){let e=hr(r,t),n=t.offset,o=t.offset+e,s=[];for(let i=n;i<o;i++)i===n&&r[i]===0||s.push(r[i]);return t.offset+=e,Uint8Array.from(s)}function Iu(r,t){let e=hr(r,t),n=t.offset+e,o=r[t.offset];t.offset++;let s=0,i=0;o<40?(s=0,i=o):o<80?(s=1,i=o-40):(s=2,i=o-80);let c=`${s}.${i}`,a=[];for(;t.offset<n;){let f=r[t.offset];if(t.offset++,a.push(f&127),f<128){a.reverse();let u=0;for(let l=0;l<a.length;l++)u+=a[l]<<l*7;c+=`.${u}`,a=[]}}return c}function Bu(r,t){return t.offset++,null}function Pu(r,t){let e=hr(r,t),n=r[t.offset];t.offset++;let o=r.subarray(t.offset,t.offset+e-1);if(t.offset+=e,n!==0)throw new Error("Unused bits in bit string is unimplemented");return o}function Cu(r,t){let e=hr(r,t),n=r.subarray(t.offset,t.offset+e);return t.offset+=e,n}function Lu(r){let t=r.toString(16);t.length%2===1&&(t="0"+t);let e=new st;for(let n=0;n<t.length;n+=2)e.append(Uint8Array.from([parseInt(`${t[n]}${t[n+1]}`,16)]));return e}function ro(r){if(r.byteLength<128)return Uint8Array.from([r.byteLength]);let t=Lu(r.byteLength);return new st(Uint8Array.from([t.byteLength|eo]),t)}function Bt(r){let t=new st,e=128;return(r.subarray()[0]&e)===e&&t.append(Uint8Array.from([0])),t.append(r),new st(Uint8Array.from([2]),ro(t),t)}function zr(r){let t=Uint8Array.from([0]),e=new st(t,r);return new st(Uint8Array.from([3]),ro(e),e)}function ce(r,t=48){let e=new st;for(let n of r)e.append(n);return new st(Uint8Array.from([t]),ro(e),e)}async function si(r,t,e){let n=await crypto.subtle.importKey("jwk",r,{name:"ECDSA",namedCurve:r.crv??"P-256"},!1,["verify"]);return crypto.subtle.verify({name:"ECDSA",hash:{name:"SHA-256"}},n,t,e.subarray())}var Tu=Uint8Array.from([6,8,42,134,72,206,61,3,1,7]),_u=Uint8Array.from([6,5,43,129,4,0,34]),Du=Uint8Array.from([6,5,43,129,4,0,35]),Ru={ext:!0,kty:"EC",crv:"P-256"},Uu={ext:!0,kty:"EC",crv:"P-384"},Ou={ext:!0,kty:"EC",crv:"P-521"},no=32,oo=48,so=66;function io(r){let t=Jt(r);return ii(t)}function ii(r){let t=r[1][1][0],e=1,n,o;if(t.byteLength===no*2+1)return n=U(t.subarray(e,e+no),"base64url"),o=U(t.subarray(e+no),"base64url"),new Ve({...Ru,key_ops:["verify"],x:n,y:o});if(t.byteLength===oo*2+1)return n=U(t.subarray(e,e+oo),"base64url"),o=U(t.subarray(e+oo),"base64url"),new Ve({...Uu,key_ops:["verify"],x:n,y:o});if(t.byteLength===so*2+1)return n=U(t.subarray(e,e+so),"base64url"),o=U(t.subarray(e+so),"base64url"),new Ve({...Ou,key_ops:["verify"],x:n,y:o});throw new ft(`coordinates were wrong length, got ${t.byteLength}, expected 65, 97 or 133`)}function ai(r){return ce([Bt(Uint8Array.from([1])),ce([Nu(r.crv)],160),ce([zr(new st(Uint8Array.from([4]),M(r.x??"","base64url"),M(r.y??"","base64url")))],161)]).subarray()}function Nu(r){if(r==="P-256")return Tu;if(r==="P-384")return _u;if(r==="P-521")return Du;throw new ft(`Invalid curve ${r}`)}var Ve=class{type="ECDSA";jwk;_raw;constructor(t){this.jwk=t}get raw(){return this._raw==null&&(this._raw=ai(this.jwk)),this._raw}toMultihash(){return Nt.digest(zt(this))}toCID(){return ct.createV1(114,this.toMultihash())}toString(){return X.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:ht(this.raw,t.raw)}async verify(t,e){return si(this.jwk,e,t)}};function ci(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function Ku(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function qe(r,...t){if(!Ku(r))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(r.length))throw new Error("Uint8Array expected of length "+t+", got length="+r.length)}function ui(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");ci(r.outputLen),ci(r.blockLen)}function He(r,t=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(t&&r.finished)throw new Error("Hash#digest() has already been called")}function fi(r,t){qe(r);let e=t.outputLen;if(r.length<e)throw new Error("digestInto() expects output buffer of length at least "+e)}var Ee=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Gr(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function Kt(r,t){return r<<32-t|r>>>t}var np=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function";function li(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function pr(r){return typeof r=="string"&&(r=li(r)),qe(r),r}function ao(...r){let t=0;for(let n=0;n<r.length;n++){let o=r[n];qe(o),t+=o.length}let e=new Uint8Array(t);for(let n=0,o=0;n<r.length;n++){let s=r[n];e.set(s,o),o+=s.length}return e}var ze=class{clone(){return this._cloneInto()}};function $r(r){let t=n=>r().update(pr(n)).digest(),e=r();return t.outputLen=e.outputLen,t.blockLen=e.blockLen,t.create=()=>r(),t}function Zr(r=32){if(Ee&&typeof Ee.getRandomValues=="function")return Ee.getRandomValues(new Uint8Array(r));if(Ee&&typeof Ee.randomBytes=="function")return Uint8Array.from(Ee.randomBytes(r));throw new Error("crypto.getRandomValues must be defined")}function ku(r,t,e,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(t,e,n);let o=BigInt(32),s=BigInt(4294967295),i=Number(e>>o&s),c=Number(e&s),a=n?4:0,f=n?0:4;r.setUint32(t+a,i,n),r.setUint32(t+f,c,n)}function di(r,t,e){return r&t^~r&e}function hi(r,t,e){return r&t^r&e^t&e}var Ge=class extends ze{constructor(t,e,n,o){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=o,this.buffer=new Uint8Array(t),this.view=Gr(this.buffer)}update(t){He(this);let{view:e,buffer:n,blockLen:o}=this;t=pr(t);let s=t.length;for(let i=0;i<s;){let c=Math.min(o-this.pos,s-i);if(c===o){let a=Gr(t);for(;o<=s-i;i+=o)this.process(a,i);continue}n.set(t.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===o&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){He(this),fi(t,this),this.finished=!0;let{buffer:e,view:n,blockLen:o,isLE:s}=this,{pos:i}=this;e[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>o-i&&(this.process(n,0),i=0);for(let l=i;l<o;l++)e[l]=0;ku(n,o-8,BigInt(this.length*8),s),this.process(n,0);let c=Gr(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let f=a/4,u=this.get();if(f>u.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<f;l++)c.setUint32(4*l,u[l],s)}digest(){let{buffer:t,outputLen:e}=this;this.digestInto(t);let n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:e,buffer:n,length:o,finished:s,destroyed:i,pos:c}=this;return t.length=o,t.pos=c,t.finished=s,t.destroyed=i,o%e&&t.buffer.set(n),t}};var Mu=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ue=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),fe=new Uint32Array(64),co=class extends Ge{constructor(t=32){super(64,t,8,!1),this.A=ue[0]|0,this.B=ue[1]|0,this.C=ue[2]|0,this.D=ue[3]|0,this.E=ue[4]|0,this.F=ue[5]|0,this.G=ue[6]|0,this.H=ue[7]|0}get(){let{A:t,B:e,C:n,D:o,E:s,F:i,G:c,H:a}=this;return[t,e,n,o,s,i,c,a]}set(t,e,n,o,s,i,c,a){this.A=t|0,this.B=e|0,this.C=n|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=c|0,this.H=a|0}process(t,e){for(let l=0;l<16;l++,e+=4)fe[l]=t.getUint32(e,!1);for(let l=16;l<64;l++){let d=fe[l-15],b=fe[l-2],m=Kt(d,7)^Kt(d,18)^d>>>3,g=Kt(b,17)^Kt(b,19)^b>>>10;fe[l]=g+fe[l-7]+m+fe[l-16]|0}let{A:n,B:o,C:s,D:i,E:c,F:a,G:f,H:u}=this;for(let l=0;l<64;l++){let d=Kt(c,6)^Kt(c,11)^Kt(c,25),b=u+d+di(c,a,f)+Mu[l]+fe[l]|0,g=(Kt(n,2)^Kt(n,13)^Kt(n,22))+hi(n,o,s)|0;u=f,f=a,a=c,c=i+b|0,i=s,s=o,o=n,n=b+g|0}n=n+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,c=c+this.E|0,a=a+this.F|0,f=f+this.G|0,u=u+this.H|0,this.set(n,o,s,i,c,a,f,u)}roundClean(){fe.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var ve=$r(()=>new co);var jr=BigInt(4294967295),uo=BigInt(32);function pi(r,t=!1){return t?{h:Number(r&jr),l:Number(r>>uo&jr)}:{h:Number(r>>uo&jr)|0,l:Number(r&jr)|0}}function Fu(r,t=!1){let e=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let o=0;o<r.length;o++){let{h:s,l:i}=pi(r[o],t);[e[o],n[o]]=[s,i]}return[e,n]}var Vu=(r,t)=>BigInt(r>>>0)<<uo|BigInt(t>>>0),qu=(r,t,e)=>r>>>e,Hu=(r,t,e)=>r<<32-e|t>>>e,zu=(r,t,e)=>r>>>e|t<<32-e,Gu=(r,t,e)=>r<<32-e|t>>>e,$u=(r,t,e)=>r<<64-e|t>>>e-32,Zu=(r,t,e)=>r>>>e-32|t<<64-e,ju=(r,t)=>t,Wu=(r,t)=>r,Yu=(r,t,e)=>r<<e|t>>>32-e,Xu=(r,t,e)=>t<<e|r>>>32-e,Ju=(r,t,e)=>t<<e-32|r>>>64-e,Qu=(r,t,e)=>r<<e-32|t>>>64-e;function tf(r,t,e,n){let o=(t>>>0)+(n>>>0);return{h:r+e+(o/2**32|0)|0,l:o|0}}var ef=(r,t,e)=>(r>>>0)+(t>>>0)+(e>>>0),rf=(r,t,e,n)=>t+e+n+(r/2**32|0)|0,nf=(r,t,e,n)=>(r>>>0)+(t>>>0)+(e>>>0)+(n>>>0),of=(r,t,e,n,o)=>t+e+n+o+(r/2**32|0)|0,sf=(r,t,e,n,o)=>(r>>>0)+(t>>>0)+(e>>>0)+(n>>>0)+(o>>>0),af=(r,t,e,n,o,s)=>t+e+n+o+s+(r/2**32|0)|0;var cf={fromBig:pi,split:Fu,toBig:Vu,shrSH:qu,shrSL:Hu,rotrSH:zu,rotrSL:Gu,rotrBH:$u,rotrBL:Zu,rotr32H:ju,rotr32L:Wu,rotlSH:Yu,rotlSL:Xu,rotlBH:Ju,rotlBL:Qu,add:tf,add3L:ef,add3H:rf,add4L:nf,add4H:of,add5H:af,add5L:sf},O=cf;var[uf,ff]=O.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),le=new Uint32Array(80),de=new Uint32Array(80),fo=class extends Ge{constructor(t=64){super(128,t,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:e,Bh:n,Bl:o,Ch:s,Cl:i,Dh:c,Dl:a,Eh:f,El:u,Fh:l,Fl:d,Gh:b,Gl:m,Hh:g,Hl:h}=this;return[t,e,n,o,s,i,c,a,f,u,l,d,b,m,g,h]}set(t,e,n,o,s,i,c,a,f,u,l,d,b,m,g,h){this.Ah=t|0,this.Al=e|0,this.Bh=n|0,this.Bl=o|0,this.Ch=s|0,this.Cl=i|0,this.Dh=c|0,this.Dl=a|0,this.Eh=f|0,this.El=u|0,this.Fh=l|0,this.Fl=d|0,this.Gh=b|0,this.Gl=m|0,this.Hh=g|0,this.Hl=h|0}process(t,e){for(let y=0;y<16;y++,e+=4)le[y]=t.getUint32(e),de[y]=t.getUint32(e+=4);for(let y=16;y<80;y++){let I=le[y-15]|0,D=de[y-15]|0,_=O.rotrSH(I,D,1)^O.rotrSH(I,D,8)^O.shrSH(I,D,7),P=O.rotrSL(I,D,1)^O.rotrSL(I,D,8)^O.shrSL(I,D,7),C=le[y-2]|0,L=de[y-2]|0,J=O.rotrSH(C,L,19)^O.rotrBH(C,L,61)^O.shrSH(C,L,6),$=O.rotrSL(C,L,19)^O.rotrBL(C,L,61)^O.shrSL(C,L,6),K=O.add4L(P,$,de[y-7],de[y-16]),ut=O.add4H(K,_,J,le[y-7],le[y-16]);le[y]=ut|0,de[y]=K|0}let{Ah:n,Al:o,Bh:s,Bl:i,Ch:c,Cl:a,Dh:f,Dl:u,Eh:l,El:d,Fh:b,Fl:m,Gh:g,Gl:h,Hh:w,Hl:S}=this;for(let y=0;y<80;y++){let I=O.rotrSH(l,d,14)^O.rotrSH(l,d,18)^O.rotrBH(l,d,41),D=O.rotrSL(l,d,14)^O.rotrSL(l,d,18)^O.rotrBL(l,d,41),_=l&b^~l&g,P=d&m^~d&h,C=O.add5L(S,D,P,ff[y],de[y]),L=O.add5H(C,w,I,_,uf[y],le[y]),J=C|0,$=O.rotrSH(n,o,28)^O.rotrBH(n,o,34)^O.rotrBH(n,o,39),K=O.rotrSL(n,o,28)^O.rotrBL(n,o,34)^O.rotrBL(n,o,39),ut=n&s^n&c^s&c,v=o&i^o&a^i&a;w=g|0,S=h|0,g=b|0,h=m|0,b=l|0,m=d|0,{h:l,l:d}=O.add(f|0,u|0,L|0,J|0),f=c|0,u=a|0,c=s|0,a=i|0,s=n|0,i=o|0;let B=O.add3L(J,K,v);n=O.add3H(B,L,$,ut),o=B|0}({h:n,l:o}=O.add(this.Ah|0,this.Al|0,n|0,o|0)),{h:s,l:i}=O.add(this.Bh|0,this.Bl|0,s|0,i|0),{h:c,l:a}=O.add(this.Ch|0,this.Cl|0,c|0,a|0),{h:f,l:u}=O.add(this.Dh|0,this.Dl|0,f|0,u|0),{h:l,l:d}=O.add(this.Eh|0,this.El|0,l|0,d|0),{h:b,l:m}=O.add(this.Fh|0,this.Fl|0,b|0,m|0),{h:g,l:h}=O.add(this.Gh|0,this.Gl|0,g|0,h|0),{h:w,l:S}=O.add(this.Hh|0,this.Hl|0,w|0,S|0),this.set(n,o,s,i,c,a,f,u,l,d,b,m,g,h,w,S)}roundClean(){le.fill(0),de.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var lo=$r(()=>new fo);var yo=BigInt(0),mo=BigInt(1);function Ae(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function go(r){if(!Ae(r))throw new Error("Uint8Array expected")}function Gt(r,t){if(typeof t!="boolean")throw new Error(r+" boolean expected, got "+t)}function mr(r){let t=r.toString(16);return t.length&1?"0"+t:t}function gi(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?yo:BigInt("0x"+r)}var bi=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",lf=Array.from({length:256},(r,t)=>t.toString(16).padStart(2,"0"));function he(r){if(go(r),bi)return r.toHex();let t="";for(let e=0;e<r.length;e++)t+=lf[r[e]];return t}var Qt={_0:48,_9:57,A:65,F:70,a:97,f:102};function mi(r){if(r>=Qt._0&&r<=Qt._9)return r-Qt._0;if(r>=Qt.A&&r<=Qt.F)return r-(Qt.A-10);if(r>=Qt.a&&r<=Qt.f)return r-(Qt.a-10)}function yr(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);if(bi)return Uint8Array.fromHex(r);let t=r.length,e=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(e);for(let o=0,s=0;o<e;o++,s+=2){let i=mi(r.charCodeAt(s)),c=mi(r.charCodeAt(s+1));if(i===void 0||c===void 0){let a=r[s]+r[s+1];throw new Error('hex string expected, got non-hex character "'+a+'" at index '+s)}n[o]=i*16+c}return n}function te(r){return gi(he(r))}function Se(r){return go(r),gi(he(Uint8Array.from(r).reverse()))}function Ie(r,t){return yr(r.toString(16).padStart(t*2,"0"))}function $e(r,t){return Ie(r,t).reverse()}function rt(r,t,e){let n;if(typeof t=="string")try{n=yr(t)}catch(s){throw new Error(r+" must be hex string or Uint8Array, cause: "+s)}else if(Ae(t))n=Uint8Array.from(t);else throw new Error(r+" must be hex string or Uint8Array");let o=n.length;if(typeof e=="number"&&o!==e)throw new Error(r+" of length "+e+" expected, got "+o);return n}function pe(...r){let t=0;for(let n=0;n<r.length;n++){let o=r[n];go(o),t+=o.length}let e=new Uint8Array(t);for(let n=0,o=0;n<r.length;n++){let s=r[n];e.set(s,o),o+=s.length}return e}var ho=r=>typeof r=="bigint"&&yo<=r;function Wr(r,t,e){return ho(r)&&ho(t)&&ho(e)&&t<=r&&r<e}function Tt(r,t,e,n){if(!Wr(t,e,n))throw new Error("expected valid "+r+": "+e+" <= n < "+n+", got "+t)}function xi(r){let t;for(t=0;r>yo;r>>=mo,t+=1);return t}var Be=r=>(mo<<BigInt(r))-mo,po=r=>new Uint8Array(r),yi=r=>Uint8Array.from(r);function wi(r,t,e){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof e!="function")throw new Error("hmacFn must be a function");let n=po(r),o=po(r),s=0,i=()=>{n.fill(1),o.fill(0),s=0},c=(...l)=>e(o,n,...l),a=(l=po(0))=>{o=c(yi([0]),l),n=c(),l.length!==0&&(o=c(yi([1]),l),n=c())},f=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let l=0,d=[];for(;l<t;){n=c();let b=n.slice();d.push(b),l+=n.length}return pe(...d)};return(l,d)=>{i(),a(l);let b;for(;!(b=d(f()));)a();return i(),b}}var df={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||Ae(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,t)=>t.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function ee(r,t,e={}){let n=(o,s,i)=>{let c=df[s];if(typeof c!="function")throw new Error("invalid validator function");let a=r[o];if(!(i&&a===void 0)&&!c(a,r))throw new Error("param "+String(o)+" is invalid. Expected "+s+", got "+a)};for(let[o,s]of Object.entries(t))n(o,s,!1);for(let[o,s]of Object.entries(e))n(o,s,!0);return r}function Ze(r){let t=new WeakMap;return(e,...n)=>{let o=t.get(e);if(o!==void 0)return o;let s=r(e,...n);return t.set(e,s),s}}var lt=BigInt(0),Q=BigInt(1),Pe=BigInt(2),hf=BigInt(3),bo=BigInt(4),Ei=BigInt(5),vi=BigInt(8),pf=BigInt(9),mf=BigInt(16);function Y(r,t){let e=r%t;return e>=lt?e:t+e}function yf(r,t,e){if(t<lt)throw new Error("invalid exponent, negatives unsupported");if(e<=lt)throw new Error("invalid modulus");if(e===Q)return lt;let n=Q;for(;t>lt;)t&Q&&(n=n*r%e),r=r*r%e,t>>=Q;return n}function tt(r,t,e){let n=r;for(;t-- >lt;)n*=n,n%=e;return n}function Yr(r,t){if(r===lt)throw new Error("invert: expected non-zero number");if(t<=lt)throw new Error("invert: expected positive modulus, got "+t);let e=Y(r,t),n=t,o=lt,s=Q,i=Q,c=lt;for(;e!==lt;){let f=n/e,u=n%e,l=o-i*f,d=s-c*f;n=e,e=u,o=i,s=c,i=l,c=d}if(n!==Q)throw new Error("invert: does not exist");return Y(o,t)}function gf(r){let t=(r-Q)/Pe,e,n,o;for(e=r-Q,n=0;e%Pe===lt;e/=Pe,n++);for(o=Pe;o<r&&yf(o,t,r)!==r-Q;o++)if(o>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){let i=(r+Q)/bo;return function(a,f){let u=a.pow(f,i);if(!a.eql(a.sqr(u),f))throw new Error("Cannot find square root");return u}}let s=(e+Q)/Pe;return function(c,a){if(c.pow(a,t)===c.neg(c.ONE))throw new Error("Cannot find square root");let f=n,u=c.pow(c.mul(c.ONE,o),e),l=c.pow(a,s),d=c.pow(a,e);for(;!c.eql(d,c.ONE);){if(c.eql(d,c.ZERO))return c.ZERO;let b=1;for(let g=c.sqr(d);b<f&&!c.eql(g,c.ONE);b++)g=c.sqr(g);let m=c.pow(u,Q<<BigInt(f-b-1));u=c.sqr(m),l=c.mul(l,m),d=c.mul(d,u),f=b}return l}}function bf(r){if(r%bo===hf){let t=(r+Q)/bo;return function(n,o){let s=n.pow(o,t);if(!n.eql(n.sqr(s),o))throw new Error("Cannot find square root");return s}}if(r%vi===Ei){let t=(r-Ei)/vi;return function(n,o){let s=n.mul(o,Pe),i=n.pow(s,t),c=n.mul(o,i),a=n.mul(n.mul(c,Pe),i),f=n.mul(c,n.sub(a,n.ONE));if(!n.eql(n.sqr(f),o))throw new Error("Cannot find square root");return f}}return r%mf,gf(r)}var Ai=(r,t)=>(Y(r,t)&Q)===Q,xf=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function xo(r){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},e=xf.reduce((n,o)=>(n[o]="function",n),t);return ee(r,e)}function wf(r,t,e){if(e<lt)throw new Error("invalid exponent, negatives unsupported");if(e===lt)return r.ONE;if(e===Q)return t;let n=r.ONE,o=t;for(;e>lt;)e&Q&&(n=r.mul(n,o)),o=r.sqr(o),e>>=Q;return n}function Ef(r,t){let e=new Array(t.length),n=t.reduce((s,i,c)=>r.is0(i)?s:(e[c]=s,r.mul(s,i)),r.ONE),o=r.inv(n);return t.reduceRight((s,i,c)=>r.is0(i)?s:(e[c]=r.mul(s,e[c]),r.mul(s,i)),o),e}function wo(r,t){let e=t!==void 0?t:r.toString(2).length,n=Math.ceil(e/8);return{nBitLength:e,nByteLength:n}}function me(r,t,e=!1,n={}){if(r<=lt)throw new Error("invalid field: expected ORDER > 0, got "+r);let{nBitLength:o,nByteLength:s}=wo(r,t);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let i,c=Object.freeze({ORDER:r,isLE:e,BITS:o,BYTES:s,MASK:Be(o),ZERO:lt,ONE:Q,create:a=>Y(a,r),isValid:a=>{if(typeof a!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof a);return lt<=a&&a<r},is0:a=>a===lt,isOdd:a=>(a&Q)===Q,neg:a=>Y(-a,r),eql:(a,f)=>a===f,sqr:a=>Y(a*a,r),add:(a,f)=>Y(a+f,r),sub:(a,f)=>Y(a-f,r),mul:(a,f)=>Y(a*f,r),pow:(a,f)=>wf(c,a,f),div:(a,f)=>Y(a*Yr(f,r),r),sqrN:a=>a*a,addN:(a,f)=>a+f,subN:(a,f)=>a-f,mulN:(a,f)=>a*f,inv:a=>Yr(a,r),sqrt:n.sqrt||(a=>(i||(i=bf(r)),i(c,a))),invertBatch:a=>Ef(c,a),cmov:(a,f,u)=>u?f:a,toBytes:a=>e?$e(a,s):Ie(a,s),fromBytes:a=>{if(a.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+a.length);return e?Se(a):te(a)}});return Object.freeze(c)}function Si(r){if(typeof r!="bigint")throw new Error("field order must be bigint");let t=r.toString(2).length;return Math.ceil(t/8)}function Eo(r){let t=Si(r);return t+Math.ceil(t/2)}function Ii(r,t,e=!1){let n=r.length,o=Si(t),s=Eo(t);if(n<16||n<s||n>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+n);let i=e?Se(r):te(r),c=Y(i,t-Q)+Q;return e?$e(c,o):Ie(c,o)}var Bi=BigInt(0),Bo=BigInt(1);function vo(r,t){let e=t.negate();return r?e:t}function Ci(r,t){if(!Number.isSafeInteger(r)||r<=0||r>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+r)}function Ao(r,t){Ci(r,t);let e=Math.ceil(t/r)+1,n=2**(r-1),o=2**r,s=Be(r),i=BigInt(r);return{windows:e,windowSize:n,mask:s,maxNumber:o,shiftBy:i}}function Pi(r,t,e){let{windowSize:n,mask:o,maxNumber:s,shiftBy:i}=e,c=Number(r&o),a=r>>i;c>n&&(c-=s,a+=Bo);let f=t*n,u=f+Math.abs(c)-1,l=c===0,d=c<0,b=t%2!==0;return{nextN:a,offset:u,isZero:l,isNeg:d,isNegF:b,offsetF:f}}function vf(r,t){if(!Array.isArray(r))throw new Error("array expected");r.forEach((e,n)=>{if(!(e instanceof t))throw new Error("invalid point at index "+n)})}function Af(r,t){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((e,n)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+n)})}var So=new WeakMap,Li=new WeakMap;function Io(r){return Li.get(r)||1}function Xr(r,t){return{constTimeNegate:vo,hasPrecomputes(e){return Io(e)!==1},unsafeLadder(e,n,o=r.ZERO){let s=e;for(;n>Bi;)n&Bo&&(o=o.add(s)),s=s.double(),n>>=Bo;return o},precomputeWindow(e,n){let{windows:o,windowSize:s}=Ao(n,t),i=[],c=e,a=c;for(let f=0;f<o;f++){a=c,i.push(a);for(let u=1;u<s;u++)a=a.add(c),i.push(a);c=a.double()}return i},wNAF(e,n,o){let s=r.ZERO,i=r.BASE,c=Ao(e,t);for(let a=0;a<c.windows;a++){let{nextN:f,offset:u,isZero:l,isNeg:d,isNegF:b,offsetF:m}=Pi(o,a,c);o=f,l?i=i.add(vo(b,n[m])):s=s.add(vo(d,n[u]))}return{p:s,f:i}},wNAFUnsafe(e,n,o,s=r.ZERO){let i=Ao(e,t);for(let c=0;c<i.windows&&o!==Bi;c++){let{nextN:a,offset:f,isZero:u,isNeg:l}=Pi(o,c,i);if(o=a,!u){let d=n[f];s=s.add(l?d.negate():d)}}return s},getPrecomputes(e,n,o){let s=So.get(n);return s||(s=this.precomputeWindow(n,e),e!==1&&So.set(n,o(s))),s},wNAFCached(e,n,o){let s=Io(e);return this.wNAF(s,this.getPrecomputes(s,e,o),n)},wNAFCachedUnsafe(e,n,o,s){let i=Io(e);return i===1?this.unsafeLadder(e,n,s):this.wNAFUnsafe(i,this.getPrecomputes(i,e,o),n,s)},setWindowSize(e,n){Ci(n,t),Li.set(e,n),So.delete(e)}}}function Jr(r,t,e,n){if(vf(e,r),Af(n,t),e.length!==n.length)throw new Error("arrays of points and scalars must have equal length");let o=r.ZERO,s=xi(BigInt(e.length)),i=s>12?s-3:s>4?s-2:s?2:1,c=Be(i),a=new Array(Number(c)+1).fill(o),f=Math.floor((t.BITS-1)/i)*i,u=o;for(let l=f;l>=0;l-=i){a.fill(o);for(let b=0;b<n.length;b++){let m=n[b],g=Number(m>>BigInt(l)&c);a[g]=a[g].add(e[b])}let d=o;for(let b=a.length-1,m=o;b>0;b--)m=m.add(a[b]),d=d.add(m);if(u=u.add(d),l!==0)for(let b=0;b<i;b++)u=u.double()}return u}function gr(r){return xo(r.Fp),ee(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...wo(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}var $t=BigInt(0),vt=BigInt(1),Ti=BigInt(2),Sf=BigInt(8),If={zip215:!0};function Bf(r){let t=gr(r);return ee(r,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function _i(r){let t=Bf(r),{Fp:e,n,prehash:o,hash:s,randomBytes:i,nByteLength:c,h:a}=t,f=Ti<<BigInt(c*8)-vt,u=e.create,l=me(t.n,t.nBitLength),d=t.uvRatio||((x,p)=>{try{return{isValid:!0,value:e.sqrt(x*e.inv(p))}}catch{return{isValid:!1,value:$t}}}),b=t.adjustScalarBytes||(x=>x),m=t.domain||((x,p,E)=>{if(Gt("phflag",E),p.length||E)throw new Error("Contexts/pre-hash are not supported");return x});function g(x,p,E=!1){let A=E?vt:$t;Tt("coordinate "+x,p,A,f)}function h(x){if(!(x instanceof y))throw new Error("ExtendedPoint expected")}let w=Ze((x,p)=>{let{ex:E,ey:A,ez:R}=x,N=x.is0();p==null&&(p=N?Sf:e.inv(R));let k=u(E*p),F=u(A*p),H=u(R*p);if(N)return{x:$t,y:vt};if(H!==vt)throw new Error("invZ was invalid");return{x:k,y:F}}),S=Ze(x=>{let{a:p,d:E}=t;if(x.is0())throw new Error("bad point: ZERO");let{ex:A,ey:R,ez:N,et:k}=x,F=u(A*A),H=u(R*R),j=u(N*N),at=u(j*j),ot=u(F*p),mt=u(j*u(ot+H)),At=u(at+u(E*u(F*H)));if(mt!==At)throw new Error("bad point: equation left != right (1)");let dt=u(A*R),gt=u(N*k);if(dt!==gt)throw new Error("bad point: equation left != right (2)");return!0});class y{constructor(p,E,A,R){g("x",p),g("y",E),g("z",A,!0),g("t",R),this.ex=p,this.ey=E,this.ez=A,this.et=R,Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(p){if(p instanceof y)throw new Error("extended point not allowed");let{x:E,y:A}=p||{};return g("x",E),g("y",A),new y(E,A,vt,u(E*A))}static normalizeZ(p){let E=e.invertBatch(p.map(A=>A.ez));return p.map((A,R)=>A.toAffine(E[R])).map(y.fromAffine)}static msm(p,E){return Jr(y,l,p,E)}_setWindowSize(p){_.setWindowSize(this,p)}assertValidity(){S(this)}equals(p){h(p);let{ex:E,ey:A,ez:R}=this,{ex:N,ey:k,ez:F}=p,H=u(E*F),j=u(N*R),at=u(A*F),ot=u(k*R);return H===j&&at===ot}is0(){return this.equals(y.ZERO)}negate(){return new y(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){let{a:p}=t,{ex:E,ey:A,ez:R}=this,N=u(E*E),k=u(A*A),F=u(Ti*u(R*R)),H=u(p*N),j=E+A,at=u(u(j*j)-N-k),ot=H+k,mt=ot-F,At=H-k,dt=u(at*mt),gt=u(ot*At),Ct=u(at*At),Rt=u(mt*ot);return new y(dt,gt,Rt,Ct)}add(p){h(p);let{a:E,d:A}=t,{ex:R,ey:N,ez:k,et:F}=this,{ex:H,ey:j,ez:at,et:ot}=p,mt=u(R*H),At=u(N*j),dt=u(F*A*ot),gt=u(k*at),Ct=u((R+N)*(H+j)-mt-At),Rt=gt-dt,sr=gt+dt,Us=u(At-E*mt),ic=u(Ct*Rt),ac=u(sr*Us),cc=u(Ct*Us),uc=u(Rt*sr);return new y(ic,ac,uc,cc)}subtract(p){return this.add(p.negate())}wNAF(p){return _.wNAFCached(this,p,y.normalizeZ)}multiply(p){let E=p;Tt("scalar",E,vt,n);let{p:A,f:R}=this.wNAF(E);return y.normalizeZ([A,R])[0]}multiplyUnsafe(p,E=y.ZERO){let A=p;return Tt("scalar",A,$t,n),A===$t?D:this.is0()||A===vt?this:_.wNAFCachedUnsafe(this,A,y.normalizeZ,E)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}isTorsionFree(){return _.unsafeLadder(this,n).is0()}toAffine(p){return w(this,p)}clearCofactor(){let{h:p}=t;return p===vt?this:this.multiplyUnsafe(p)}static fromHex(p,E=!1){let{d:A,a:R}=t,N=e.BYTES;p=rt("pointHex",p,N),Gt("zip215",E);let k=p.slice(),F=p[N-1];k[N-1]=F&-129;let H=Se(k),j=E?f:e.ORDER;Tt("pointHex.y",H,$t,j);let at=u(H*H),ot=u(at-vt),mt=u(A*at-R),{isValid:At,value:dt}=d(ot,mt);if(!At)throw new Error("Point.fromHex: invalid y coordinate");let gt=(dt&vt)===vt,Ct=(F&128)!==0;if(!E&&dt===$t&&Ct)throw new Error("Point.fromHex: x=0 and x_0=1");return Ct!==gt&&(dt=u(-dt)),y.fromAffine({x:dt,y:H})}static fromPrivateKey(p){let{scalar:E}=L(p);return I.multiply(E)}toRawBytes(){let{x:p,y:E}=this.toAffine(),A=$e(E,e.BYTES);return A[A.length-1]|=p&vt?128:0,A}toHex(){return he(this.toRawBytes())}}y.BASE=new y(t.Gx,t.Gy,vt,u(t.Gx*t.Gy)),y.ZERO=new y($t,vt,vt,$t);let{BASE:I,ZERO:D}=y,_=Xr(y,c*8);function P(x){return Y(x,n)}function C(x){return P(Se(x))}function L(x){let p=e.BYTES;x=rt("private key",x,p);let E=rt("hashed private key",s(x),2*p),A=b(E.slice(0,p)),R=E.slice(p,2*p),N=C(A);return{head:A,prefix:R,scalar:N}}function J(x){let{head:p,prefix:E,scalar:A}=L(x),R=I.multiply(A),N=R.toRawBytes();return{head:p,prefix:E,scalar:A,point:R,pointBytes:N}}function $(x){return J(x).pointBytes}function K(x=new Uint8Array,...p){let E=pe(...p);return C(s(m(E,rt("context",x),!!o)))}function ut(x,p,E={}){x=rt("message",x),o&&(x=o(x));let{prefix:A,scalar:R,pointBytes:N}=J(p),k=K(E.context,A,x),F=I.multiply(k).toRawBytes(),H=K(E.context,F,N,x),j=P(k+H*R);Tt("signature.s",j,$t,n);let at=pe(F,$e(j,e.BYTES));return rt("result",at,e.BYTES*2)}let v=If;function B(x,p,E,A=v){let{context:R,zip215:N}=A,k=e.BYTES;x=rt("signature",x,2*k),p=rt("message",p),E=rt("publicKey",E,k),N!==void 0&&Gt("zip215",N),o&&(p=o(p));let F=Se(x.slice(k,2*k)),H,j,at;try{H=y.fromHex(E,N),j=y.fromHex(x.slice(0,k),N),at=I.multiplyUnsafe(F)}catch{return!1}if(!N&&H.isSmallOrder())return!1;let ot=K(R,j.toRawBytes(),H.toRawBytes(),p);return j.add(H.multiplyUnsafe(ot)).subtract(at).clearCofactor().equals(y.ZERO)}return I._setWindowSize(8),{CURVE:t,getPublicKey:$,sign:ut,verify:B,ExtendedPoint:y,utils:{getExtendedPublicKey:J,randomPrivateKey:()=>i(e.BYTES),precompute(x=8,p=y.BASE){return p._setWindowSize(x),p.multiply(BigInt(3)),p}}}}var Po=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Di=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),kp=BigInt(0),Pf=BigInt(1),Ri=BigInt(2),Mp=BigInt(3),Cf=BigInt(5),Lf=BigInt(8);function Tf(r){let t=BigInt(10),e=BigInt(20),n=BigInt(40),o=BigInt(80),s=Po,c=r*r%s*r%s,a=tt(c,Ri,s)*c%s,f=tt(a,Pf,s)*r%s,u=tt(f,Cf,s)*f%s,l=tt(u,t,s)*u%s,d=tt(l,e,s)*l%s,b=tt(d,n,s)*d%s,m=tt(b,o,s)*b%s,g=tt(m,o,s)*b%s,h=tt(g,t,s)*u%s;return{pow_p_5_8:tt(h,Ri,s)*r%s,b2:c}}function _f(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}function Df(r,t){let e=Po,n=Y(t*t*t,e),o=Y(n*n*t,e),s=Tf(r*o).pow_p_5_8,i=Y(r*n*s,e),c=Y(t*i*i,e),a=i,f=Y(i*Di,e),u=c===r,l=c===Y(-r,e),d=c===Y(-r*Di,e);return u&&(i=a),(l||d)&&(i=f),Ai(i,e)&&(i=Y(-i,e)),{isValid:u||l,value:i}}var Ui=me(Po,void 0,!0),Rf={a:Ui.create(BigInt(-1)),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Ui,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:Lf,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:lo,randomBytes:Zr,adjustScalarBytes:_f,uvRatio:Df},Oi=_i(Rf);var Qr=32;function Ni(r,t,e){return Oi.verify(t,e instanceof Uint8Array?e:e.subarray(),r)}var tn=class{type="Ed25519";raw;constructor(t){this.raw=Co(t,Qr)}toMultihash(){return Nt.digest(zt(this))}toCID(){return ct.createV1(114,this.toMultihash())}toString(){return X.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:ht(this.raw,t.raw)}verify(t,e){return Ni(this.raw,e,t)}};function Lo(r){return r=Co(r,Qr),new tn(r)}function Co(r,t){if(r=Uint8Array.from(r??[]),r.length!==t)throw new ft(`Key must be a Uint8Array of length ${t}, got ${r.length}`);return r}var Of=Math.pow(2,7),Nf=Math.pow(2,14),Kf=Math.pow(2,21),To=Math.pow(2,28),_o=Math.pow(2,35),Do=Math.pow(2,42),Ro=Math.pow(2,49),Z=128,bt=127;function xt(r){if(r<Of)return 1;if(r<Nf)return 2;if(r<Kf)return 3;if(r<To)return 4;if(r<_o)return 5;if(r<Do)return 6;if(r<Ro)return 7;if(Number.MAX_SAFE_INTEGER!=null&&r>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function Uo(r,t,e=0){switch(xt(r)){case 8:t[e++]=r&255|Z,r/=128;case 7:t[e++]=r&255|Z,r/=128;case 6:t[e++]=r&255|Z,r/=128;case 5:t[e++]=r&255|Z,r/=128;case 4:t[e++]=r&255|Z,r>>>=7;case 3:t[e++]=r&255|Z,r>>>=7;case 2:t[e++]=r&255|Z,r>>>=7;case 1:{t[e++]=r&255,r>>>=7;break}default:throw new Error("unreachable")}return t}function kf(r,t,e=0){switch(xt(r)){case 8:t.set(e++,r&255|Z),r/=128;case 7:t.set(e++,r&255|Z),r/=128;case 6:t.set(e++,r&255|Z),r/=128;case 5:t.set(e++,r&255|Z),r/=128;case 4:t.set(e++,r&255|Z),r>>>=7;case 3:t.set(e++,r&255|Z),r>>>=7;case 2:t.set(e++,r&255|Z),r>>>=7;case 1:{t.set(e++,r&255),r>>>=7;break}default:throw new Error("unreachable")}return t}function Oo(r,t){let e=r[t],n=0;if(n+=e&bt,e<Z||(e=r[t+1],n+=(e&bt)<<7,e<Z)||(e=r[t+2],n+=(e&bt)<<14,e<Z)||(e=r[t+3],n+=(e&bt)<<21,e<Z)||(e=r[t+4],n+=(e&bt)*To,e<Z)||(e=r[t+5],n+=(e&bt)*_o,e<Z)||(e=r[t+6],n+=(e&bt)*Do,e<Z)||(e=r[t+7],n+=(e&bt)*Ro,e<Z))return n;throw new RangeError("Could not decode varint")}function Mf(r,t){let e=r.get(t),n=0;if(n+=e&bt,e<Z||(e=r.get(t+1),n+=(e&bt)<<7,e<Z)||(e=r.get(t+2),n+=(e&bt)<<14,e<Z)||(e=r.get(t+3),n+=(e&bt)<<21,e<Z)||(e=r.get(t+4),n+=(e&bt)*To,e<Z)||(e=r.get(t+5),n+=(e&bt)*_o,e<Z)||(e=r.get(t+6),n+=(e&bt)*Do,e<Z)||(e=r.get(t+7),n+=(e&bt)*Ro,e<Z))return n;throw new RangeError("Could not decode varint")}function Dt(r,t,e=0){return t==null&&(t=It(xt(r))),t instanceof Uint8Array?Uo(r,t,e):kf(r,t,e)}function re(r,t=0){return r instanceof Uint8Array?Oo(r,t):Mf(r,t)}var No=new Float32Array([-0]),ye=new Uint8Array(No.buffer);function ki(r,t,e){No[0]=r,t[e]=ye[0],t[e+1]=ye[1],t[e+2]=ye[2],t[e+3]=ye[3]}function Mi(r,t){return ye[0]=r[t],ye[1]=r[t+1],ye[2]=r[t+2],ye[3]=r[t+3],No[0]}var Ko=new Float64Array([-0]),wt=new Uint8Array(Ko.buffer);function Fi(r,t,e){Ko[0]=r,t[e]=wt[0],t[e+1]=wt[1],t[e+2]=wt[2],t[e+3]=wt[3],t[e+4]=wt[4],t[e+5]=wt[5],t[e+6]=wt[6],t[e+7]=wt[7]}function Vi(r,t){return wt[0]=r[t],wt[1]=r[t+1],wt[2]=r[t+2],wt[3]=r[t+3],wt[4]=r[t+4],wt[5]=r[t+5],wt[6]=r[t+6],wt[7]=r[t+7],Ko[0]}var Ff=BigInt(Number.MAX_SAFE_INTEGER),Vf=BigInt(Number.MIN_SAFE_INTEGER),_t=class r{lo;hi;constructor(t,e){this.lo=t|0,this.hi=e|0}toNumber(t=!1){if(!t&&this.hi>>>31>0){let e=~this.lo+1>>>0,n=~this.hi>>>0;return e===0&&(n=n+1>>>0),-(e+n*4294967296)}return this.lo+this.hi*4294967296}toBigInt(t=!1){if(t)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let e=~this.lo+1>>>0,n=~this.hi>>>0;return e===0&&(n=n+1>>>0),-(BigInt(e)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(t=!1){return this.toBigInt(t).toString()}zzEncode(){let t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this}zzDecode(){let t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this}length(){let t=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?e===0?t<16384?t<128?1:2:t<2097152?3:4:e<16384?e<128?5:6:e<2097152?7:8:n<128?9:10}static fromBigInt(t){if(t===0n)return Ce;if(t<Ff&&t>Vf)return this.fromNumber(Number(t));let e=t<0n;e&&(t=-t);let n=t>>32n,o=t-(n<<32n);return e&&(n=~n|0n,o=~o|0n,++o>qi&&(o=0n,++n>qi&&(n=0n))),new r(Number(o),Number(n))}static fromNumber(t){if(t===0)return Ce;let e=t<0;e&&(t=-t);let n=t>>>0,o=(t-n)/4294967296>>>0;return e&&(o=~o>>>0,n=~n>>>0,++n>4294967295&&(n=0,++o>4294967295&&(o=0))),new r(n,o)}static from(t){return typeof t=="number"?r.fromNumber(t):typeof t=="bigint"?r.fromBigInt(t):typeof t=="string"?r.fromBigInt(BigInt(t)):t.low!=null||t.high!=null?new r(t.low>>>0,t.high>>>0):Ce}},Ce=new _t(0,0);Ce.toBigInt=function(){return 0n};Ce.zzEncode=Ce.zzDecode=function(){return this};Ce.length=function(){return 1};var qi=4294967296n;function Hi(r){let t=0,e=0;for(let n=0;n<r.length;++n)e=r.charCodeAt(n),e<128?t+=1:e<2048?t+=2:(e&64512)===55296&&(r.charCodeAt(n+1)&64512)===56320?(++n,t+=4):t+=3;return t}function zi(r,t,e){if(e-t<1)return"";let o,s=[],i=0,c;for(;t<e;)c=r[t++],c<128?s[i++]=c:c>191&&c<224?s[i++]=(c&31)<<6|r[t++]&63:c>239&&c<365?(c=((c&7)<<18|(r[t++]&63)<<12|(r[t++]&63)<<6|r[t++]&63)-65536,s[i++]=55296+(c>>10),s[i++]=56320+(c&1023)):s[i++]=(c&15)<<12|(r[t++]&63)<<6|r[t++]&63,i>8191&&((o??(o=[])).push(String.fromCharCode.apply(String,s)),i=0);return o!=null?(i>0&&o.push(String.fromCharCode.apply(String,s.slice(0,i))),o.join("")):String.fromCharCode.apply(String,s.slice(0,i))}function ko(r,t,e){let n=e,o,s;for(let i=0;i<r.length;++i)o=r.charCodeAt(i),o<128?t[e++]=o:o<2048?(t[e++]=o>>6|192,t[e++]=o&63|128):(o&64512)===55296&&((s=r.charCodeAt(i+1))&64512)===56320?(o=65536+((o&1023)<<10)+(s&1023),++i,t[e++]=o>>18|240,t[e++]=o>>12&63|128,t[e++]=o>>6&63|128,t[e++]=o&63|128):(t[e++]=o>>12|224,t[e++]=o>>6&63|128,t[e++]=o&63|128);return e-n}function kt(r,t){return RangeError(`index out of range: ${r.pos} + ${t??1} > ${r.len}`)}function rn(r,t){return(r[t-4]|r[t-3]<<8|r[t-2]<<16|r[t-1]<<24)>>>0}var Mo=class{buf;pos;len;_slice=Uint8Array.prototype.subarray;constructor(t){this.buf=t,this.pos=0,this.len=t.length}uint32(){let t=4294967295;if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,kt(this,10);return t}int32(){return this.uint32()|0}sint32(){let t=this.uint32();return t>>>1^-(t&1)|0}bool(){return this.uint32()!==0}fixed32(){if(this.pos+4>this.len)throw kt(this,4);return rn(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw kt(this,4);return rn(this.buf,this.pos+=4)|0}float(){if(this.pos+4>this.len)throw kt(this,4);let t=Mi(this.buf,this.pos);return this.pos+=4,t}double(){if(this.pos+8>this.len)throw kt(this,4);let t=Vi(this.buf,this.pos);return this.pos+=8,t}bytes(){let t=this.uint32(),e=this.pos,n=this.pos+t;if(n>this.len)throw kt(this,t);return this.pos+=t,e===n?new Uint8Array(0):this.buf.subarray(e,n)}string(){let t=this.bytes();return zi(t,0,t.length)}skip(t){if(typeof t=="number"){if(this.pos+t>this.len)throw kt(this,t);this.pos+=t}else do if(this.pos>=this.len)throw kt(this);while((this.buf[this.pos++]&128)!==0);return this}skipType(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${t} at offset ${this.pos}`)}return this}readLongVarint(){let t=new _t(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw kt(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw kt(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw kt(this,8);let t=rn(this.buf,this.pos+=4),e=rn(this.buf,this.pos+=4);return new _t(t,e)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){let t=Oo(this.buf,this.pos);return this.pos+=xt(t),t}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}};function Fo(r){return new Mo(r instanceof Uint8Array?r:r.subarray())}function Mt(r,t,e){let n=Fo(r);return t.decode(n,void 0,e)}function Vo(r){let t=r??8192,e=t>>>1,n,o=t;return function(i){if(i<1||i>e)return It(i);o+i>t&&(n=It(t),o=0);let c=n.subarray(o,o+=i);return(o&7)!==0&&(o=(o|7)+1),c}}var Le=class{fn;len;next;val;constructor(t,e,n){this.fn=t,this.len=e,this.next=void 0,this.val=n}};function qo(){}var zo=class{head;tail;len;next;constructor(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}},qf=Vo();function Hf(r){return globalThis.Buffer!=null?It(r):qf(r)}var xr=class{len;head;tail;states;constructor(){this.len=0,this.head=new Le(qo,0,0),this.tail=this.head,this.states=null}_push(t,e,n){return this.tail=this.tail.next=new Le(t,e,n),this.len+=e,this}uint32(t){return this.len+=(this.tail=this.tail.next=new Go((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this}int32(t){return t<0?this._push(nn,10,_t.fromNumber(t)):this.uint32(t)}sint32(t){return this.uint32((t<<1^t>>31)>>>0)}uint64(t){let e=_t.fromBigInt(t);return this._push(nn,e.length(),e)}uint64Number(t){return this._push(Uo,xt(t),t)}uint64String(t){return this.uint64(BigInt(t))}int64(t){return this.uint64(t)}int64Number(t){return this.uint64Number(t)}int64String(t){return this.uint64String(t)}sint64(t){let e=_t.fromBigInt(t).zzEncode();return this._push(nn,e.length(),e)}sint64Number(t){let e=_t.fromNumber(t).zzEncode();return this._push(nn,e.length(),e)}sint64String(t){return this.sint64(BigInt(t))}bool(t){return this._push(Ho,1,t?1:0)}fixed32(t){return this._push(br,4,t>>>0)}sfixed32(t){return this.fixed32(t)}fixed64(t){let e=_t.fromBigInt(t);return this._push(br,4,e.lo)._push(br,4,e.hi)}fixed64Number(t){let e=_t.fromNumber(t);return this._push(br,4,e.lo)._push(br,4,e.hi)}fixed64String(t){return this.fixed64(BigInt(t))}sfixed64(t){return this.fixed64(t)}sfixed64Number(t){return this.fixed64Number(t)}sfixed64String(t){return this.fixed64String(t)}float(t){return this._push(ki,4,t)}double(t){return this._push(Fi,8,t)}bytes(t){let e=t.length>>>0;return e===0?this._push(Ho,1,0):this.uint32(e)._push(Gf,e,t)}string(t){let e=Hi(t);return e!==0?this.uint32(e)._push(ko,e,t):this._push(Ho,1,0)}fork(){return this.states=new zo(this),this.head=this.tail=new Le(qo,0,0),this.len=0,this}reset(){return this.states!=null?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Le(qo,0,0),this.len=0),this}ldelim(){let t=this.head,e=this.tail,n=this.len;return this.reset().uint32(n),n!==0&&(this.tail.next=t.next,this.tail=e,this.len+=n),this}finish(){let t=this.head.next,e=Hf(this.len),n=0;for(;t!=null;)t.fn(t.val,e,n),n+=t.len,t=t.next;return e}};function Ho(r,t,e){t[e]=r&255}function zf(r,t,e){for(;r>127;)t[e++]=r&127|128,r>>>=7;t[e]=r}var Go=class extends Le{next;constructor(t,e){super(zf,t,e),this.next=void 0}};function nn(r,t,e){for(;r.hi!==0;)t[e++]=r.lo&127|128,r.lo=(r.lo>>>7|r.hi<<25)>>>0,r.hi>>>=7;for(;r.lo>127;)t[e++]=r.lo&127|128,r.lo=r.lo>>>7;t[e++]=r.lo}function br(r,t,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24}function Gf(r,t,e){t.set(r,e)}globalThis.Buffer!=null&&(xr.prototype.bytes=function(r){let t=r.length>>>0;return this.uint32(t),t>0&&this._push($f,t,r),this},xr.prototype.string=function(r){let t=globalThis.Buffer.byteLength(r);return this.uint32(t),t>0&&this._push(Zf,t,r),this});function $f(r,t,e){t.set(r,e)}function Zf(r,t,e){r.length<40?ko(r,t,e):t.utf8Write!=null?t.utf8Write(r,e):t.set(M(r),e)}function $o(){return new xr}function Ft(r,t){let e=$o();return t.encode(r,e,{lengthDelimited:!1}),e.finish()}var je;(function(r){r[r.VARINT=0]="VARINT",r[r.BIT64=1]="BIT64",r[r.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",r[r.START_GROUP=3]="START_GROUP",r[r.END_GROUP=4]="END_GROUP",r[r.BIT32=5]="BIT32"})(je||(je={}));function on(r,t,e,n){return{name:r,type:t,encode:e,decode:n}}function Zo(r){function t(o){if(r[o.toString()]==null)throw new Error("Invalid enum value");return r[o]}let e=function(s,i){let c=t(s);i.int32(c)},n=function(s){let i=s.int32();return t(i)};return on("enum",je.VARINT,e,n)}function Vt(r,t){return on("message",je.LENGTH_DELIMITED,r,t)}var Te=class extends Error{code="ERR_MAX_LENGTH";name="MaxLengthError"};var it;(function(r){r.RSA="RSA",r.Ed25519="Ed25519",r.secp256k1="secp256k1",r.ECDSA="ECDSA"})(it||(it={}));var jo;(function(r){r[r.RSA=0]="RSA",r[r.Ed25519=1]="Ed25519",r[r.secp256k1=2]="secp256k1",r[r.ECDSA=3]="ECDSA"})(jo||(jo={}));(function(r){r.codec=()=>Zo(jo)})(it||(it={}));var Zt;(function(r){let t;r.codec=()=>(t==null&&(t=Vt((e,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),e.Type!=null&&(n.uint32(8),it.codec().encode(e.Type,n)),e.Data!=null&&(n.uint32(18),n.bytes(e.Data)),o.lengthDelimited!==!1&&n.ldelim()},(e,n,o={})=>{let s={},i=n==null?e.len:e.pos+n;for(;e.pos<i;){let c=e.uint32();switch(c>>>3){case 1:{s.Type=it.codec().decode(e);break}case 2:{s.Data=e.bytes();break}default:{e.skipType(c&7);break}}}return s})),t),r.encode=e=>Ft(e,r.codec()),r.decode=(e,n)=>Mt(e,r.codec(),n)})(Zt||(Zt={}));var Wo;(function(r){let t;r.codec=()=>(t==null&&(t=Vt((e,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),e.Type!=null&&(n.uint32(8),it.codec().encode(e.Type,n)),e.Data!=null&&(n.uint32(18),n.bytes(e.Data)),o.lengthDelimited!==!1&&n.ldelim()},(e,n,o={})=>{let s={},i=n==null?e.len:e.pos+n;for(;e.pos<i;){let c=e.uint32();switch(c>>>3){case 1:{s.Type=it.codec().decode(e);break}case 2:{s.Data=e.bytes();break}default:{e.skipType(c&7);break}}}return s})),t),r.encode=e=>Ft(e,r.codec()),r.decode=(e,n)=>Mt(e,r.codec(),n)})(Wo||(Wo={}));var wr=class extends Error{constructor(t="An error occurred while verifying a message"){super(t),this.name="VerificationError"}},sn=class extends Error{constructor(t="Missing Web Crypto API"){super(t),this.name="WebCryptoMissingError"}};var Zi={get(r=globalThis){let t=r.crypto;if(t?.subtle==null)throw new sn("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api");return t}};var ge=Zi;var vr={};St(vr,{MAX_RSA_KEY_SIZE:()=>Yo,generateRSAKeyPair:()=>Xi,jwkToJWKKeyPair:()=>Ji,jwkToPkcs1:()=>Xf,jwkToPkix:()=>ts,jwkToRSAPrivateKey:()=>os,pkcs1MessageToJwk:()=>Jo,pkcs1MessageToRSAPrivateKey:()=>es,pkcs1ToJwk:()=>Yf,pkcs1ToRSAPrivateKey:()=>Yi,pkixMessageToJwk:()=>Qo,pkixMessageToRSAPublicKey:()=>ns,pkixToJwk:()=>Jf,pkixToRSAPublicKey:()=>rs});var We=class{type="RSA";jwk;_raw;_multihash;constructor(t,e){this.jwk=t,this._multihash=e}get raw(){return this._raw==null&&(this._raw=vr.jwkToPkix(this.jwk)),this._raw}toMultihash(){return this._multihash}toCID(){return ct.createV1(114,this._multihash)}toString(){return X.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:ht(this.raw,t.raw)}verify(t,e){return Wi(this.jwk,e,t)}},Er=class{type="RSA";jwk;_raw;publicKey;constructor(t,e){this.jwk=t,this.publicKey=e}get raw(){return this._raw==null&&(this._raw=vr.jwkToPkcs1(this.jwk)),this._raw}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:ht(this.raw,t.raw)}sign(t){return ji(this.jwk,t)}};var Yo=8192,Xo=18,jf=1062,Wf=Uint8Array.from([48,13,6,9,42,134,72,134,247,13,1,1,1,5,0]);function Yf(r){let t=Jt(r);return Jo(t)}function Jo(r){return{n:U(r[1],"base64url"),e:U(r[2],"base64url"),d:U(r[3],"base64url"),p:U(r[4],"base64url"),q:U(r[5],"base64url"),dp:U(r[6],"base64url"),dq:U(r[7],"base64url"),qi:U(r[8],"base64url"),kty:"RSA"}}function Xf(r){if(r.n==null||r.e==null||r.d==null||r.p==null||r.q==null||r.dp==null||r.dq==null||r.qi==null)throw new ft("JWK was missing components");return ce([Bt(Uint8Array.from([0])),Bt(M(r.n,"base64url")),Bt(M(r.e,"base64url")),Bt(M(r.d,"base64url")),Bt(M(r.p,"base64url")),Bt(M(r.q,"base64url")),Bt(M(r.dp,"base64url")),Bt(M(r.dq,"base64url")),Bt(M(r.qi,"base64url"))]).subarray()}function Jf(r){let t=Jt(r,{offset:0});return Qo(t)}function Qo(r){let t=Jt(r[1],{offset:0});return{kty:"RSA",n:U(t[0],"base64url"),e:U(t[1],"base64url")}}function ts(r){if(r.n==null||r.e==null)throw new ft("JWK was missing components");return ce([Wf,zr(ce([Bt(M(r.n,"base64url")),Bt(M(r.e,"base64url"))]))]).subarray()}function Yi(r){let t=Jt(r);return es(t)}function es(r){let t=Jo(r);return os(t)}function rs(r,t){if(r.byteLength>=jf)throw new Ne("Key size is too large");let e=Jt(r,{offset:0});return ns(e,r,t)}function ns(r,t,e){let n=Qo(r);if(e==null){let o=ve(Zt.encode({Type:it.RSA,Data:t}));e=Ot(Xo,o)}return new We(n,e)}function os(r){if(ta(r)>Yo)throw new ft("Key size is too large");let t=Ji(r),e=ve(Zt.encode({Type:it.RSA,Data:ts(t.publicKey)})),n=Ot(Xo,e);return new Er(t.privateKey,new We(t.publicKey,n))}async function Xi(r){if(r>Yo)throw new ft("Key size is too large");let t=await Qi(r),e=ve(Zt.encode({Type:it.RSA,Data:ts(t.publicKey)})),n=Ot(Xo,e);return new Er(t.privateKey,new We(t.publicKey,n))}function Ji(r){if(r==null)throw new ft("Missing key parameter");return{privateKey:r,publicKey:{kty:r.kty,n:r.n,e:r.e}}}async function Qi(r){let t=await ge.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),e=await Qf(t);return{privateKey:e[0],publicKey:e[1]}}async function ji(r,t){let e=await ge.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await ge.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},e,t instanceof Uint8Array?t:t.subarray());return new Uint8Array(n,0,n.byteLength)}async function Wi(r,t,e){let n=await ge.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return ge.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,e instanceof Uint8Array?e:e.subarray())}async function Qf(r){if(r.privateKey==null||r.publicKey==null)throw new ft("Private and public key are required");return Promise.all([ge.get().subtle.exportKey("jwk",r.privateKey),ge.get().subtle.exportKey("jwk",r.publicKey)])}function ta(r){if(r.kty!=="RSA")throw new ft("invalid key type");if(r.n==null)throw new ft("invalid key modulus");return M(r.n,"base64url").length*8}var an=class extends ze{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,ui(t);let n=pr(e);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,s=new Uint8Array(o);s.set(n.length>o?t.create().update(n).digest():n);for(let i=0;i<s.length;i++)s[i]^=54;this.iHash.update(s),this.oHash=t.create();for(let i=0;i<s.length;i++)s[i]^=106;this.oHash.update(s),s.fill(0)}update(t){return He(this),this.iHash.update(t),this}digestInto(t){He(this),qe(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:e,iHash:n,finished:o,destroyed:s,blockLen:i,outputLen:c}=this;return t=t,t.finished=o,t.destroyed=s,t.blockLen=i,t.outputLen=c,t.oHash=e._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},ss=(r,t,e)=>new an(r,t).update(e).digest();ss.create=(r,t)=>new an(r,t);function ea(r){r.lowS!==void 0&&Gt("lowS",r.lowS),r.prehash!==void 0&&Gt("prehash",r.prehash)}function tl(r){let t=gr(r);ee(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:e,Fp:n,a:o}=t;if(e){if(!n.eql(o,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof e!="object"||typeof e.beta!="bigint"||typeof e.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...t})}var is=class extends Error{constructor(t=""){super(t)}},ne={Err:is,_tlv:{encode:(r,t)=>{let{Err:e}=ne;if(r<0||r>256)throw new e("tlv.encode: wrong tag");if(t.length&1)throw new e("tlv.encode: unpadded data");let n=t.length/2,o=mr(n);if(o.length/2&128)throw new e("tlv.encode: long form length too big");let s=n>127?mr(o.length/2|128):"";return mr(r)+s+o+t},decode(r,t){let{Err:e}=ne,n=0;if(r<0||r>256)throw new e("tlv.encode: wrong tag");if(t.length<2||t[n++]!==r)throw new e("tlv.decode: wrong tlv");let o=t[n++],s=!!(o&128),i=0;if(!s)i=o;else{let a=o&127;if(!a)throw new e("tlv.decode(long): indefinite length not supported");if(a>4)throw new e("tlv.decode(long): byte length is too big");let f=t.subarray(n,n+a);if(f.length!==a)throw new e("tlv.decode: length bytes not complete");if(f[0]===0)throw new e("tlv.decode(long): zero leftmost byte");for(let u of f)i=i<<8|u;if(n+=a,i<128)throw new e("tlv.decode(long): not minimal encoding")}let c=t.subarray(n,n+i);if(c.length!==i)throw new e("tlv.decode: wrong value length");return{v:c,l:t.subarray(n+i)}}},_int:{encode(r){let{Err:t}=ne;if(r<oe)throw new t("integer: negative integers are not allowed");let e=mr(r);if(Number.parseInt(e[0],16)&8&&(e="00"+e),e.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return e},decode(r){let{Err:t}=ne;if(r[0]&128)throw new t("invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return te(r)}},toSig(r){let{Err:t,_int:e,_tlv:n}=ne,o=rt("signature",r),{v:s,l:i}=n.decode(48,o);if(i.length)throw new t("invalid signature: left bytes after parsing");let{v:c,l:a}=n.decode(2,s),{v:f,l:u}=n.decode(2,a);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:e.decode(c),s:e.decode(f)}},hexFromSig(r){let{_tlv:t,_int:e}=ne,n=t.encode(2,e.encode(r.r)),o=t.encode(2,e.encode(r.s)),s=n+o;return t.encode(48,s)}},oe=BigInt(0),pt=BigInt(1),lm=BigInt(2),ra=BigInt(3),dm=BigInt(4);function el(r){let t=tl(r),{Fp:e}=t,n=me(t.n,t.nBitLength),o=t.toBytes||((g,h,w)=>{let S=h.toAffine();return pe(Uint8Array.from([4]),e.toBytes(S.x),e.toBytes(S.y))}),s=t.fromBytes||(g=>{let h=g.subarray(1),w=e.fromBytes(h.subarray(0,e.BYTES)),S=e.fromBytes(h.subarray(e.BYTES,2*e.BYTES));return{x:w,y:S}});function i(g){let{a:h,b:w}=t,S=e.sqr(g),y=e.mul(S,g);return e.add(e.add(y,e.mul(g,h)),w)}if(!e.eql(e.sqr(t.Gy),i(t.Gx)))throw new Error("bad generator point: equation left != right");function c(g){return Wr(g,pt,t.n)}function a(g){let{allowedPrivateKeyLengths:h,nByteLength:w,wrapPrivateKey:S,n:y}=t;if(h&&typeof g!="bigint"){if(Ae(g)&&(g=he(g)),typeof g!="string"||!h.includes(g.length))throw new Error("invalid private key");g=g.padStart(w*2,"0")}let I;try{I=typeof g=="bigint"?g:te(rt("private key",g,w))}catch{throw new Error("invalid private key, expected hex or "+w+" bytes, got "+typeof g)}return S&&(I=Y(I,y)),Tt("private key",I,pt,y),I}function f(g){if(!(g instanceof d))throw new Error("ProjectivePoint expected")}let u=Ze((g,h)=>{let{px:w,py:S,pz:y}=g;if(e.eql(y,e.ONE))return{x:w,y:S};let I=g.is0();h==null&&(h=I?e.ONE:e.inv(y));let D=e.mul(w,h),_=e.mul(S,h),P=e.mul(y,h);if(I)return{x:e.ZERO,y:e.ZERO};if(!e.eql(P,e.ONE))throw new Error("invZ was invalid");return{x:D,y:_}}),l=Ze(g=>{if(g.is0()){if(t.allowInfinityPoint&&!e.is0(g.py))return;throw new Error("bad point: ZERO")}let{x:h,y:w}=g.toAffine();if(!e.isValid(h)||!e.isValid(w))throw new Error("bad point: x or y not FE");let S=e.sqr(w),y=i(h);if(!e.eql(S,y))throw new Error("bad point: equation left != right");if(!g.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class d{constructor(h,w,S){if(h==null||!e.isValid(h))throw new Error("x required");if(w==null||!e.isValid(w))throw new Error("y required");if(S==null||!e.isValid(S))throw new Error("z required");this.px=h,this.py=w,this.pz=S,Object.freeze(this)}static fromAffine(h){let{x:w,y:S}=h||{};if(!h||!e.isValid(w)||!e.isValid(S))throw new Error("invalid affine point");if(h instanceof d)throw new Error("projective point not allowed");let y=I=>e.eql(I,e.ZERO);return y(w)&&y(S)?d.ZERO:new d(w,S,e.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(h){let w=e.invertBatch(h.map(S=>S.pz));return h.map((S,y)=>S.toAffine(w[y])).map(d.fromAffine)}static fromHex(h){let w=d.fromAffine(s(rt("pointHex",h)));return w.assertValidity(),w}static fromPrivateKey(h){return d.BASE.multiply(a(h))}static msm(h,w){return Jr(d,n,h,w)}_setWindowSize(h){m.setWindowSize(this,h)}assertValidity(){l(this)}hasEvenY(){let{y:h}=this.toAffine();if(e.isOdd)return!e.isOdd(h);throw new Error("Field doesn't support isOdd")}equals(h){f(h);let{px:w,py:S,pz:y}=this,{px:I,py:D,pz:_}=h,P=e.eql(e.mul(w,_),e.mul(I,y)),C=e.eql(e.mul(S,_),e.mul(D,y));return P&&C}negate(){return new d(this.px,e.neg(this.py),this.pz)}double(){let{a:h,b:w}=t,S=e.mul(w,ra),{px:y,py:I,pz:D}=this,_=e.ZERO,P=e.ZERO,C=e.ZERO,L=e.mul(y,y),J=e.mul(I,I),$=e.mul(D,D),K=e.mul(y,I);return K=e.add(K,K),C=e.mul(y,D),C=e.add(C,C),_=e.mul(h,C),P=e.mul(S,$),P=e.add(_,P),_=e.sub(J,P),P=e.add(J,P),P=e.mul(_,P),_=e.mul(K,_),C=e.mul(S,C),$=e.mul(h,$),K=e.sub(L,$),K=e.mul(h,K),K=e.add(K,C),C=e.add(L,L),L=e.add(C,L),L=e.add(L,$),L=e.mul(L,K),P=e.add(P,L),$=e.mul(I,D),$=e.add($,$),L=e.mul($,K),_=e.sub(_,L),C=e.mul($,J),C=e.add(C,C),C=e.add(C,C),new d(_,P,C)}add(h){f(h);let{px:w,py:S,pz:y}=this,{px:I,py:D,pz:_}=h,P=e.ZERO,C=e.ZERO,L=e.ZERO,J=t.a,$=e.mul(t.b,ra),K=e.mul(w,I),ut=e.mul(S,D),v=e.mul(y,_),B=e.add(w,S),T=e.add(I,D);B=e.mul(B,T),T=e.add(K,ut),B=e.sub(B,T),T=e.add(w,y);let x=e.add(I,_);return T=e.mul(T,x),x=e.add(K,v),T=e.sub(T,x),x=e.add(S,y),P=e.add(D,_),x=e.mul(x,P),P=e.add(ut,v),x=e.sub(x,P),L=e.mul(J,T),P=e.mul($,v),L=e.add(P,L),P=e.sub(ut,L),L=e.add(ut,L),C=e.mul(P,L),ut=e.add(K,K),ut=e.add(ut,K),v=e.mul(J,v),T=e.mul($,T),ut=e.add(ut,v),v=e.sub(K,v),v=e.mul(J,v),T=e.add(T,v),K=e.mul(ut,T),C=e.add(C,K),K=e.mul(x,T),P=e.mul(B,P),P=e.sub(P,K),K=e.mul(B,ut),L=e.mul(x,L),L=e.add(L,K),new d(P,C,L)}subtract(h){return this.add(h.negate())}is0(){return this.equals(d.ZERO)}wNAF(h){return m.wNAFCached(this,h,d.normalizeZ)}multiplyUnsafe(h){let{endo:w,n:S}=t;Tt("scalar",h,oe,S);let y=d.ZERO;if(h===oe)return y;if(this.is0()||h===pt)return this;if(!w||m.hasPrecomputes(this))return m.wNAFCachedUnsafe(this,h,d.normalizeZ);let{k1neg:I,k1:D,k2neg:_,k2:P}=w.splitScalar(h),C=y,L=y,J=this;for(;D>oe||P>oe;)D&pt&&(C=C.add(J)),P&pt&&(L=L.add(J)),J=J.double(),D>>=pt,P>>=pt;return I&&(C=C.negate()),_&&(L=L.negate()),L=new d(e.mul(L.px,w.beta),L.py,L.pz),C.add(L)}multiply(h){let{endo:w,n:S}=t;Tt("scalar",h,pt,S);let y,I;if(w){let{k1neg:D,k1:_,k2neg:P,k2:C}=w.splitScalar(h),{p:L,f:J}=this.wNAF(_),{p:$,f:K}=this.wNAF(C);L=m.constTimeNegate(D,L),$=m.constTimeNegate(P,$),$=new d(e.mul($.px,w.beta),$.py,$.pz),y=L.add($),I=J.add(K)}else{let{p:D,f:_}=this.wNAF(h);y=D,I=_}return d.normalizeZ([y,I])[0]}multiplyAndAddUnsafe(h,w,S){let y=d.BASE,I=(_,P)=>P===oe||P===pt||!_.equals(y)?_.multiplyUnsafe(P):_.multiply(P),D=I(this,w).add(I(h,S));return D.is0()?void 0:D}toAffine(h){return u(this,h)}isTorsionFree(){let{h,isTorsionFree:w}=t;if(h===pt)return!0;if(w)return w(d,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h,clearCofactor:w}=t;return h===pt?this:w?w(d,this):this.multiplyUnsafe(t.h)}toRawBytes(h=!0){return Gt("isCompressed",h),this.assertValidity(),o(d,this,h)}toHex(h=!0){return Gt("isCompressed",h),he(this.toRawBytes(h))}}d.BASE=new d(t.Gx,t.Gy,e.ONE),d.ZERO=new d(e.ZERO,e.ONE,e.ZERO);let b=t.nBitLength,m=Xr(d,t.endo?Math.ceil(b/2):b);return{CURVE:t,ProjectivePoint:d,normPrivateKeyToScalar:a,weierstrassEquation:i,isWithinCurveOrder:c}}function rl(r){let t=gr(r);return ee(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function na(r){let t=rl(r),{Fp:e,n}=t,o=e.BYTES+1,s=2*e.BYTES+1;function i(v){return Y(v,n)}function c(v){return Yr(v,n)}let{ProjectivePoint:a,normPrivateKeyToScalar:f,weierstrassEquation:u,isWithinCurveOrder:l}=el({...t,toBytes(v,B,T){let x=B.toAffine(),p=e.toBytes(x.x),E=pe;return Gt("isCompressed",T),T?E(Uint8Array.from([B.hasEvenY()?2:3]),p):E(Uint8Array.from([4]),p,e.toBytes(x.y))},fromBytes(v){let B=v.length,T=v[0],x=v.subarray(1);if(B===o&&(T===2||T===3)){let p=te(x);if(!Wr(p,pt,e.ORDER))throw new Error("Point is not on curve");let E=u(p),A;try{A=e.sqrt(E)}catch(k){let F=k instanceof Error?": "+k.message:"";throw new Error("Point is not on curve"+F)}let R=(A&pt)===pt;return(T&1)===1!==R&&(A=e.neg(A)),{x:p,y:A}}else if(B===s&&T===4){let p=e.fromBytes(x.subarray(0,e.BYTES)),E=e.fromBytes(x.subarray(e.BYTES,2*e.BYTES));return{x:p,y:E}}else{let p=o,E=s;throw new Error("invalid Point, expected length of "+p+", or uncompressed "+E+", got "+B)}}}),d=v=>he(Ie(v,t.nByteLength));function b(v){let B=n>>pt;return v>B}function m(v){return b(v)?i(-v):v}let g=(v,B,T)=>te(v.slice(B,T));class h{constructor(B,T,x){Tt("r",B,pt,n),Tt("s",T,pt,n),this.r=B,this.s=T,x!=null&&(this.recovery=x),Object.freeze(this)}static fromCompact(B){let T=t.nByteLength;return B=rt("compactSignature",B,T*2),new h(g(B,0,T),g(B,T,2*T))}static fromDER(B){let{r:T,s:x}=ne.toSig(rt("DER",B));return new h(T,x)}assertValidity(){}addRecoveryBit(B){return new h(this.r,this.s,B)}recoverPublicKey(B){let{r:T,s:x,recovery:p}=this,E=_(rt("msgHash",B));if(p==null||![0,1,2,3].includes(p))throw new Error("recovery id invalid");let A=p===2||p===3?T+t.n:T;if(A>=e.ORDER)throw new Error("recovery id 2 or 3 invalid");let R=(p&1)===0?"02":"03",N=a.fromHex(R+d(A)),k=c(A),F=i(-E*k),H=i(x*k),j=a.BASE.multiplyAndAddUnsafe(N,F,H);if(!j)throw new Error("point at infinify");return j.assertValidity(),j}hasHighS(){return b(this.s)}normalizeS(){return this.hasHighS()?new h(this.r,i(-this.s),this.recovery):this}toDERRawBytes(){return yr(this.toDERHex())}toDERHex(){return ne.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return yr(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}let w={isValidPrivateKey(v){try{return f(v),!0}catch{return!1}},normPrivateKeyToScalar:f,randomPrivateKey:()=>{let v=Eo(t.n);return Ii(t.randomBytes(v),t.n)},precompute(v=8,B=a.BASE){return B._setWindowSize(v),B.multiply(BigInt(3)),B}};function S(v,B=!0){return a.fromPrivateKey(v).toRawBytes(B)}function y(v){let B=Ae(v),T=typeof v=="string",x=(B||T)&&v.length;return B?x===o||x===s:T?x===2*o||x===2*s:v instanceof a}function I(v,B,T=!0){if(y(v))throw new Error("first arg must be private key");if(!y(B))throw new Error("second arg must be public key");return a.fromHex(B).multiply(f(v)).toRawBytes(T)}let D=t.bits2int||function(v){if(v.length>8192)throw new Error("input is too large");let B=te(v),T=v.length*8-t.nBitLength;return T>0?B>>BigInt(T):B},_=t.bits2int_modN||function(v){return i(D(v))},P=Be(t.nBitLength);function C(v){return Tt("num < 2^"+t.nBitLength,v,oe,P),Ie(v,t.nByteLength)}function L(v,B,T=J){if(["recovered","canonical"].some(ot=>ot in T))throw new Error("sign() legacy options not supported");let{hash:x,randomBytes:p}=t,{lowS:E,prehash:A,extraEntropy:R}=T;E==null&&(E=!0),v=rt("msgHash",v),ea(T),A&&(v=rt("prehashed msgHash",x(v)));let N=_(v),k=f(B),F=[C(k),C(N)];if(R!=null&&R!==!1){let ot=R===!0?p(e.BYTES):R;F.push(rt("extraEntropy",ot))}let H=pe(...F),j=N;function at(ot){let mt=D(ot);if(!l(mt))return;let At=c(mt),dt=a.BASE.multiply(mt).toAffine(),gt=i(dt.x);if(gt===oe)return;let Ct=i(At*i(j+gt*k));if(Ct===oe)return;let Rt=(dt.x===gt?0:2)|Number(dt.y&pt),sr=Ct;return E&&b(Ct)&&(sr=m(Ct),Rt^=1),new h(gt,sr,Rt)}return{seed:H,k2sig:at}}let J={lowS:t.lowS,prehash:!1},$={lowS:t.lowS,prehash:!1};function K(v,B,T=J){let{seed:x,k2sig:p}=L(v,B,T),E=t;return wi(E.hash.outputLen,E.nByteLength,E.hmac)(x,p)}a.BASE._setWindowSize(8);function ut(v,B,T,x=$){let p=v;B=rt("msgHash",B),T=rt("publicKey",T);let{lowS:E,prehash:A,format:R}=x;if(ea(x),"strict"in x)throw new Error("options.strict was renamed to lowS");if(R!==void 0&&R!=="compact"&&R!=="der")throw new Error("format must be compact or der");let N=typeof p=="string"||Ae(p),k=!N&&!R&&typeof p=="object"&&p!==null&&typeof p.r=="bigint"&&typeof p.s=="bigint";if(!N&&!k)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let F,H;try{if(k&&(F=new h(p.r,p.s)),N){try{R!=="compact"&&(F=h.fromDER(p))}catch(Rt){if(!(Rt instanceof ne.Err))throw Rt}!F&&R!=="der"&&(F=h.fromCompact(p))}H=a.fromHex(T)}catch{return!1}if(!F||E&&F.hasHighS())return!1;A&&(B=t.hash(B));let{r:j,s:at}=F,ot=_(B),mt=c(at),At=i(ot*mt),dt=i(j*mt),gt=a.BASE.multiplyAndAddUnsafe(H,At,dt)?.toAffine();return gt?i(gt.x)===j:!1}return{CURVE:t,getPublicKey:S,getSharedSecret:I,sign:K,verify:ut,ProjectivePoint:a,Signature:h,utils:w}}function nl(r){return{hash:r,hmac:(t,...e)=>ss(r,t,ao(...e)),randomBytes:Zr}}function oa(r,t){let e=n=>na({...r,...nl(n)});return{...e(t),create:e}}var aa=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),sa=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),ol=BigInt(1),as=BigInt(2),ia=(r,t)=>(r+t/as)/t;function sl(r){let t=aa,e=BigInt(3),n=BigInt(6),o=BigInt(11),s=BigInt(22),i=BigInt(23),c=BigInt(44),a=BigInt(88),f=r*r*r%t,u=f*f*r%t,l=tt(u,e,t)*u%t,d=tt(l,e,t)*u%t,b=tt(d,as,t)*f%t,m=tt(b,o,t)*b%t,g=tt(m,s,t)*m%t,h=tt(g,c,t)*g%t,w=tt(h,a,t)*h%t,S=tt(w,c,t)*g%t,y=tt(S,e,t)*u%t,I=tt(y,i,t)*m%t,D=tt(I,n,t)*f%t,_=tt(D,as,t);if(!cs.eql(cs.sqr(_),r))throw new Error("Cannot find square root");return _}var cs=me(aa,void 0,void 0,{sqrt:sl}),_e=oa({a:BigInt(0),b:BigInt(7),Fp:cs,n:sa,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:r=>{let t=sa,e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-ol*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=e,i=BigInt("0x100000000000000000000000000000000"),c=ia(s*r,t),a=ia(-n*r,t),f=Y(r-c*e-a*o,t),u=Y(-c*n-a*s,t),l=f>i,d=u>i;if(l&&(f=t-f),d&&(u=t-u),f>i||u>i)throw new Error("splitScalar: Endomorphism failed, k="+r);return{k1neg:l,k1:f,k2neg:d,k2:u}}}},ve),Em=BigInt(0);var vm=_e.ProjectivePoint;function ca(r){return r==null?!1:typeof r.then=="function"&&typeof r.catch=="function"&&typeof r.finally=="function"}function ua(r,t,e){let n=fr.digest(e instanceof Uint8Array?e:e.subarray());if(ca(n))return n.then(({digest:o})=>_e.verify(t,o,r)).catch(o=>{throw new wr(String(o))});try{return _e.verify(t,n.digest,r)}catch(o){throw new wr(String(o))}}var cn=class{type="secp256k1";raw;_key;constructor(t){this._key=la(t),this.raw=fa(this._key)}toMultihash(){return Nt.digest(zt(this))}toCID(){return ct.createV1(114,this.toMultihash())}toString(){return X.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:ht(this.raw,t.raw)}verify(t,e){return ua(this._key,e,t)}};function us(r){return new cn(r)}function fa(r){return _e.ProjectivePoint.fromHex(r).toRawBytes(!0)}function la(r){try{return _e.ProjectivePoint.fromHex(r),r}catch(t){throw new Ne(String(t))}}function Ye(r,t){let{Type:e,Data:n}=Zt.decode(r),o=n??new Uint8Array;switch(e){case it.RSA:return rs(o,t);case it.Ed25519:return Lo(o);case it.secp256k1:return us(o);case it.ECDSA:return io(o);default:throw new xe}}function da(r){let{Type:t,Data:e}=Zt.decode(r.digest),n=e??new Uint8Array;switch(t){case it.Ed25519:return Lo(n);case it.secp256k1:return us(n);case it.ECDSA:return io(n);default:throw new xe}}function zt(r){return Zt.encode({Type:it[r.type],Data:r.raw})}var Ar;(function(r){let t;r.codec=()=>(t==null&&(t=Vt((e,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),e.publicKey!=null&&e.publicKey.byteLength>0&&(n.uint32(10),n.bytes(e.publicKey)),e.payloadType!=null&&e.payloadType.byteLength>0&&(n.uint32(18),n.bytes(e.payloadType)),e.payload!=null&&e.payload.byteLength>0&&(n.uint32(26),n.bytes(e.payload)),e.signature!=null&&e.signature.byteLength>0&&(n.uint32(42),n.bytes(e.signature)),o.lengthDelimited!==!1&&n.ldelim()},(e,n,o={})=>{let s={publicKey:yt(0),payloadType:yt(0),payload:yt(0),signature:yt(0)},i=n==null?e.len:e.pos+n;for(;e.pos<i;){let c=e.uint32();switch(c>>>3){case 1:{s.publicKey=e.bytes();break}case 2:{s.payloadType=e.bytes();break}case 3:{s.payload=e.bytes();break}case 5:{s.signature=e.bytes();break}default:{e.skipType(c&7);break}}}return s})),t),r.encode=e=>Ft(e,r.codec()),r.decode=(e,n)=>Mt(e,r.codec(),n)})(Ar||(Ar={}));var un=class extends Error{constructor(t="Invalid signature"){super(t),this.name="InvalidSignatureError"}};var jt=class r{static createFromProtobuf=async t=>{let e=Ar.decode(t),n=Ye(e.publicKey);return new r({publicKey:n,payloadType:e.payloadType,payload:e.payload,signature:e.signature})};static seal=async(t,e)=>{if(e==null)throw new Error("Missing private key");let n=t.domain,o=t.codec,s=t.marshal(),i=ha(n,o,s),c=await e.sign(i.subarray());return new r({publicKey:e.publicKey,payloadType:o,payload:s,signature:c})};static openAndCertify=async(t,e)=>{let n=await r.createFromProtobuf(t);if(!await n.validate(e))throw new un("Envelope signature is not valid for the given domain");return n};publicKey;payloadType;payload;signature;marshaled;constructor(t){let{publicKey:e,payloadType:n,payload:o,signature:s}=t;this.publicKey=e,this.payloadType=n,this.payload=o,this.signature=s}marshal(){return this.marshaled==null&&(this.marshaled=Ar.encode({publicKey:zt(this.publicKey),payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(t){return ht(this.marshal(),t.marshal())}async validate(t){let e=ha(t,this.payloadType,this.payload);return this.publicKey.verify(e.subarray(),this.signature)}},ha=(r,t,e)=>{let n=M(r),o=Dt(n.byteLength),s=Dt(t.length),i=Dt(e.length);return new st(o,n,s,t,i,e)};var pa=Symbol.for("nodejs.util.inspect.custom"),il=114,Sr=class{type;multihash;publicKey;string;constructor(t){this.type=t.type,this.multihash=t.multihash,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[Dn]=!0;toString(){return this.string==null&&(this.string=X.encode(this.multihash.bytes).slice(1)),this.string}toMultihash(){return this.multihash}toCID(){return ct.createV1(il,this.multihash)}toJSON(){return this.toString()}equals(t){if(t==null)return!1;if(t instanceof Uint8Array)return ht(this.multihash.bytes,t);if(typeof t=="string")return this.toString()===t;if(t?.toMultihash()?.bytes!=null)return ht(this.multihash.bytes,t.toMultihash().bytes);throw new Error("not valid Id")}[pa](){return`PeerId(${this.toString()})`}},Ir=class extends Sr{type="RSA";publicKey;constructor(t){super({...t,type:"RSA"}),this.publicKey=t.publicKey}},Br=class extends Sr{type="Ed25519";publicKey;constructor(t){super({...t,type:"Ed25519"}),this.publicKey=t.publicKey}},Pr=class extends Sr{type="secp256k1";publicKey;constructor(t){super({...t,type:"secp256k1"}),this.publicKey=t.publicKey}},al=2336,Cr=class{type="url";multihash;publicKey;url;constructor(t){this.url=t.toString(),this.multihash=Nt.digest(M(this.url))}[pa](){return`PeerId(${this.url})`}[Dn]=!0;toString(){return this.toCID().toString()}toMultihash(){return this.multihash}toCID(){return ct.createV1(al,this.toMultihash())}toJSON(){return this.toString()}equals(t){return t==null?!1:(t instanceof Uint8Array&&(t=U(t)),t.toString()===this.toString())}};var cl=114,ma=2336;function ya(r){if(r.type==="Ed25519")return new Br({multihash:r.toCID().multihash,publicKey:r});if(r.type==="secp256k1")return new Pr({multihash:r.toCID().multihash,publicKey:r});if(r.type==="RSA")return new Ir({multihash:r.toCID().multihash,publicKey:r});throw new xe}function fs(r){if(fl(r))return new Ir({multihash:r});if(ul(r))try{let t=da(r);if(t.type==="Ed25519")return new Br({multihash:r,publicKey:t});if(t.type==="secp256k1")return new Pr({multihash:r,publicKey:t})}catch{let e=U(r.digest);return new Cr(new URL(e))}throw new kr("Supplied PeerID Multihash is invalid")}function fn(r){if(r?.multihash==null||r.version==null||r.version===1&&r.code!==cl&&r.code!==ma)throw new Kr("Supplied PeerID CID is invalid");if(r.code===ma){let t=U(r.multihash.digest);return new Cr(new URL(t))}return fs(r.multihash)}function ul(r){return r.code===Nt.code}function fl(r){return r.code===fr.code}function ga(r,t){let e=(n,o)=>n.toString().localeCompare(o.toString());return r.length!==t.length?!1:(t.sort(e),r.sort(e).every((n,o)=>t[o].equals(n)))}var ln=class{index=0;input="";new(t){return this.index=0,this.input=t,this}readAtomically(t){let e=this.index,n=t();return n===void 0&&(this.index=e),n}parseWith(t){let e=t();if(this.index===this.input.length)return e}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(t){return this.readAtomically(()=>{let e=this.readChar();if(e===t)return e})}readSeparator(t,e,n){return this.readAtomically(()=>{if(!(e>0&&this.readGivenChar(t)===void 0))return n()})}readNumber(t,e,n,o){return this.readAtomically(()=>{let s=0,i=0,c=this.peekChar();if(c===void 0)return;let a=c==="0",f=2**(8*o)-1;for(;;){let u=this.readAtomically(()=>{let l=this.readChar();if(l===void 0)return;let d=Number.parseInt(l,t);if(!Number.isNaN(d))return d});if(u===void 0)break;if(s*=t,s+=u,s>f||(i+=1,e!==void 0&&i>e))return}if(i!==0)return!n&&a&&i>1?void 0:s})}readIPv4Addr(){return this.readAtomically(()=>{let t=new Uint8Array(4);for(let e=0;e<t.length;e++){let n=this.readSeparator(".",e,()=>this.readNumber(10,3,!1,1));if(n===void 0)return;t[e]=n}return t})}readIPv6Addr(){let t=e=>{for(let n=0;n<e.length/2;n++){let o=n*2;if(n<e.length-3){let i=this.readSeparator(":",n,()=>this.readIPv4Addr());if(i!==void 0)return e[o]=i[0],e[o+1]=i[1],e[o+2]=i[2],e[o+3]=i[3],[o+4,!0]}let s=this.readSeparator(":",n,()=>this.readNumber(16,4,!0,2));if(s===void 0)return[o,!1];e[o]=s>>8,e[o+1]=s&255}return[e.length,!1]};return this.readAtomically(()=>{let e=new Uint8Array(16),[n,o]=t(e);if(n===16)return e;if(o||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;let s=new Uint8Array(14),i=16-(n+2),[c]=t(s.subarray(0,i));return e.set(s.subarray(0,c),16-c),e})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}};var ba=45,ll=15,Xe=new ln;function dn(r){if(!(r.length>ll))return Xe.new(r).parseWith(()=>Xe.readIPv4Addr())}function hn(r){if(r.includes("%")&&(r=r.split("%")[0]),!(r.length>ba))return Xe.new(r).parseWith(()=>Xe.readIPv6Addr())}function De(r,t=!1){if(r.includes("%")&&(r=r.split("%")[0]),r.length>ba)return;let e=Xe.new(r).parseWith(()=>Xe.readIPAddr());if(e)return t&&e.length===4?Uint8Array.from([0,0,0,0,0,0,0,0,0,0,255,255,e[0],e[1],e[2],e[3]]):e}function xa(r,t,e){let n=0;for(let o of r)if(!(n<t)){if(n>e)break;if(o!==255)return!1;n++}return!0}function wa(r,t,e,n){let o=0;for(let s of r)if(!(o<e)){if(o>n)break;if(s!==t[o])return!1;o++}return!0}function ls(r){switch(r.length){case Re:return r.join(".");case Ue:{let t=[];for(let e=0;e<r.length;e++)e%2===0&&t.push(r[e].toString(16).padStart(2,"0")+r[e+1].toString(16).padStart(2,"0"));return t.join(":")}default:throw new Error("Invalid ip length")}}function Ea(r){let t=0;for(let[e,n]of r.entries()){if(n===255){t+=8;continue}for(;(n&128)!=0;)t++,n=n<<1;if((n&128)!=0)return-1;for(let o=e+1;o<r.length;o++)if(r[o]!=0)return-1;break}return t}function va(r){let t="0x";for(let e of r)t+=(e>>4).toString(16)+(e&15).toString(16);return t}var Re=4,Ue=16,$y=parseInt("0xFFFF",16),dl=new Uint8Array([0,0,0,0,0,0,0,0,0,0,255,255]);function Lr(r,t){t.length===Ue&&r.length===Re&&xa(t,0,11)&&(t=t.slice(12)),t.length===Re&&r.length===Ue&&wa(r,dl,0,11)&&(r=r.slice(12));let e=r.length;if(e!=t.length)throw new Error("Failed to mask ip");let n=new Uint8Array(e);for(let o=0;o<e;o++)n[o]=r[o]&t[o];return n}function Aa(r,t){if(typeof t=="string"&&(t=De(t)),t==null)throw new Error("Invalid ip");if(t.length!==r.network.length)return!1;for(let e=0;e<t.length;e++)if((r.network[e]&r.mask[e])!==(t[e]&r.mask[e]))return!1;return!0}function ds(r){let[t,e]=r.split("/");if(!t||!e)throw new Error("Failed to parse given CIDR: "+r);let n=Re,o=dn(t);if(o==null&&(n=Ue,o=hn(t),o==null))throw new Error("Failed to parse given CIDR: "+r);let s=parseInt(e,10);if(Number.isNaN(s)||String(s).length!==e.length||s<0||s>n*8)throw new Error("Failed to parse given CIDR: "+r);let i=hs(s,8*n);return{network:Lr(o,i),mask:i}}function hs(r,t){if(t!==8*Re&&t!==8*Ue)throw new Error("Invalid CIDR mask");if(r<0||r>t)throw new Error("Invalid CIDR mask");let e=t/8,n=new Uint8Array(e);for(let o=0;o<e;o++){if(r>=8){n[o]=255,r-=8;continue}n[o]=255-(255>>r),r=0}return n}var Je=class{constructor(t,e){if(e==null)({network:this.network,mask:this.mask}=ds(t));else{let n=De(t);if(n==null)throw new Error("Failed to parse network");e=String(e);let o=parseInt(e,10);if(Number.isNaN(o)||String(o).length!==e.length||o<0||o>n.length*8){let s=De(e);if(s==null)throw new Error("Failed to parse mask");this.mask=s}else this.mask=hs(o,8*n.length);this.network=Lr(n,this.mask)}}contains(t){return Aa({network:this.network,mask:this.mask},t)}toString(){let t=Ea(this.mask),e=t!==-1?String(t):va(this.mask);return ls(this.network)+"/"+e}};function Sa(r,t){return new Je(r).contains(t)}function Qe(r){return!!dn(r)}function tr(r){return!!hn(r)}function pn(r){return!!De(r)}var Ia=Qe,hl=tr,ps=function(r){let t=0;if(r=r.toString().trim(),Ia(r)){let e=new Uint8Array(t+4);return r.split(/\./g).forEach(n=>{e[t++]=parseInt(n,10)&255}),e}if(hl(r)){let e=r.split(":",8),n;for(n=0;n<e.length;n++){let s=Ia(e[n]),i;s&&(i=ps(e[n]),e[n]=U(i.slice(0,2),"base16")),i!=null&&++n<8&&e.splice(n,0,U(i.slice(2,4),"base16"))}if(e[0]==="")for(;e.length<8;)e.unshift("0");else if(e[e.length-1]==="")for(;e.length<8;)e.push("0");else if(e.length<8){for(n=0;n<e.length&&e[n]!=="";n++);let s=[n,1];for(n=9-e.length;n>0;n--)s.push("0");e.splice.apply(e,s)}let o=new Uint8Array(t+16);for(n=0;n<e.length;n++){let s=parseInt(e[n],16);o[t++]=s>>8&255,o[t++]=s&255}return o}throw new Error("invalid ip address")},Ba=function(r,t=0,e){t=~~t,e=e??r.length-t;let n=new DataView(r.buffer);if(e===4){let o=[];for(let s=0;s<e;s++)o.push(r[t+s]);return o.join(".")}if(e===16){let o=[];for(let s=0;s<e;s+=2)o.push(n.getUint16(t+s).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var er={},ms={},ml=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[481,-1,"http-path"],[777,-1,"memory"]];ml.forEach(r=>{let t=yl(...r);ms[t.code]=t,er[t.name]=t});function yl(r,t,e,n,o){return{code:r,size:t,name:e,resolvable:!!n,path:!!o}}function z(r){if(typeof r=="number"){if(ms[r]!=null)return ms[r];throw new Error(`no protocol with code: ${r}`)}else if(typeof r=="string"){if(er[r]!=null)return er[r];throw new Error(`no protocol with name: ${r}`)}throw new Error(`invalid protocol id type: ${typeof r}`)}var Ig=z("ip4"),Bg=z("ip6"),Pg=z("ipcidr");function xs(r,t){switch(z(r).code){case 4:case 41:return bl(t);case 42:return bs(t);case 43:return U(t,"base10");case 6:case 273:case 33:case 132:return La(t).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return bs(t);case 421:return vl(t);case 444:return Ca(t);case 445:return Ca(t);case 466:return El(t);case 481:return globalThis.encodeURIComponent(bs(t));default:return U(t,"base16")}}function ws(r,t){switch(z(r).code){case 4:return Pa(t);case 41:return Pa(t);case 42:return gs(t);case 43:return M(t,"base10");case 6:case 273:case 33:case 132:return Es(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return gs(t);case 421:return xl(t);case 444:return Al(t);case 445:return Sl(t);case 466:return wl(t);case 481:return gs(globalThis.decodeURIComponent(t));default:return M(t,"base16")}}var ys=Object.values(lr).map(r=>r.decoder),gl=function(){let r=ys[0].or(ys[1]);return ys.slice(2).forEach(t=>r=r.or(t)),r}();function Pa(r){if(!pn(r))throw new Error("invalid ip address");return ps(r)}function bl(r){let t=Ba(r,0,r.length);if(t==null)throw new Error("ipBuff is required");if(!pn(t))throw new Error("invalid ip address");return t}function Es(r){let t=new ArrayBuffer(2);return new DataView(t).setUint16(0,r),new Uint8Array(t)}function La(r){return new DataView(r.buffer).getUint16(r.byteOffset)}function gs(r){let t=M(r),e=Uint8Array.from(Dt(t.length));return Lt([e,t],e.length+t.length)}function bs(r){let t=re(r);if(r=r.slice(xt(t)),r.length!==t)throw new Error("inconsistent lengths");return U(r)}function xl(r){let t;r[0]==="Q"||r[0]==="1"?t=we(X.decode(`z${r}`)).bytes:t=ct.parse(r).multihash.bytes;let e=Uint8Array.from(Dt(t.length));return Lt([e,t],e.length+t.length)}function wl(r){let t=gl.decode(r),e=Uint8Array.from(Dt(t.length));return Lt([e,t],e.length+t.length)}function El(r){let t=re(r),e=r.slice(xt(t));if(e.length!==t)throw new Error("inconsistent lengths");return"u"+U(e,"base64url")}function vl(r){let t=re(r),e=r.slice(xt(t));if(e.length!==t)throw new Error("inconsistent lengths");return U(e,"base58btc")}function Al(r){let t=r.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==16)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);let e=Xt.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=Es(n);return Lt([e,o],e.length+o.length)}function Sl(r){let t=r.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==56)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);let e=Xt.decode(`b${t[0]}`),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=Es(n);return Lt([e,o],e.length+o.length)}function Ca(r){let t=r.slice(0,r.length-2),e=r.slice(r.length-2),n=U(t,"base32"),o=La(e);return`${n}:${o}`}function Ta(r){r=vs(r);let t=[],e=[],n=null,o=r.split("/").slice(1);if(o.length===1&&o[0]==="")return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let s=0;s<o.length;s++){let i=o[s],c=z(i);if(c.size===0){t.push([c.code]),e.push([c.code]);continue}if(s++,s>=o.length)throw new mn("invalid address: "+r);if(c.path===!0){n=vs(o.slice(s).join("/")),t.push([c.code,ws(c.code,n)]),e.push([c.code,n]);break}let a=ws(c.code,o[s]);t.push([c.code,a]),e.push([c.code,xs(c.code,a)])}return{string:_a(e),bytes:yn(t),tuples:t,stringTuples:e,path:n}}function As(r){let t=[],e=[],n=null,o=0;for(;o<r.length;){let s=re(r,o),i=xt(s),c=z(s),a=Il(c,r.slice(o+i));if(a===0){t.push([s]),e.push([s]),o+=i;continue}let f=r.slice(o+i,o+i+a);if(o+=a+i,o>r.length)throw new mn("Invalid address Uint8Array: "+U(r,"base16"));t.push([s,f]);let u=xs(s,f);if(e.push([s,u]),c.path===!0){n=u;break}}return{bytes:Uint8Array.from(r),string:_a(e),tuples:t,stringTuples:e,path:n}}function _a(r){let t=[];return r.map(e=>{let n=z(e[0]);return t.push(n.name),e.length>1&&e[1]!=null&&t.push(e[1]),null}),vs(t.join("/"))}function yn(r){return Lt(r.map(t=>{let e=z(t[0]),n=Uint8Array.from(Dt(e.code));return t.length>1&&t[1]!=null&&(n=Lt([n,t[1]])),n}))}function Il(r,t){if(r.size>0)return r.size/8;if(r.size===0)return 0;{let e=re(t instanceof Uint8Array?t:Uint8Array.from(t));return e+xt(e)}}function vs(r){return"/"+r.trim().split("/").filter(t=>t).join("/")}var mn=class extends Error{static name="ParseError";name="ParseError";constructor(t){super(`Error parsing address: ${t}`)}};var Bl=Symbol.for("nodejs.util.inspect.custom"),Is=Symbol.for("@multiformats/js-multiaddr/multiaddr"),Pl=[z("dns").code,z("dns4").code,z("dns6").code,z("dnsaddr").code],Ss=class extends Error{constructor(t="No available resolver"){super(t),this.name="NoAvailableResolverError"}},gn=class r{bytes;#e;#t;#r;#n;[Is]=!0;constructor(t){t==null&&(t="");let e;if(t instanceof Uint8Array)e=As(t);else if(typeof t=="string"){if(t.length>0&&t.charAt(0)!=="/")throw new Error(`multiaddr "${t}" must start with a "/"`);e=Ta(t)}else if(Ra(t))e=As(t.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=e.bytes,this.#e=e.string,this.#t=e.tuples,this.#r=e.stringTuples,this.#n=e.path}toString(){return this.#e}toJSON(){return this.toString()}toOptions(){let t,e,n,o,s="",i=z("tcp"),c=z("udp"),a=z("ip4"),f=z("ip6"),u=z("dns6"),l=z("ip6zone");for(let[b,m]of this.stringTuples())b===l.code&&(s=`%${m??""}`),Pl.includes(b)&&(e=i.name==="tcp"?"tcp":"udp",o=443,n=`${m??""}${s}`,t=b===u.code?6:4),(b===i.code||b===c.code)&&(e=z(b).name==="tcp"?"tcp":"udp",o=parseInt(m??"")),(b===a.code||b===f.code)&&(e=z(b).name==="tcp"?"tcp":"udp",n=`${m??""}${s}`,t=b===f.code?6:4);if(t==null||e==null||n==null||o==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:t,host:n,transport:e,port:o}}protos(){return this.#t.map(([t])=>Object.assign({},z(t)))}protoCodes(){return this.#t.map(([t])=>t)}protoNames(){return this.#t.map(([t])=>z(t).name)}tuples(){return this.#t.map(([t,e])=>e==null?[t]:[t,e])}stringTuples(){return this.#r.map(([t,e])=>e==null?[t]:[t,e])}encapsulate(t){return t=new r(t),new r(this.toString()+t.toString())}decapsulate(t){let e=t.toString(),n=this.toString(),o=n.lastIndexOf(e);if(o<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${t.toString()}`);return new r(n.slice(0,o))}decapsulateCode(t){let e=this.tuples();for(let n=e.length-1;n>=0;n--)if(e[n][0]===t)return new r(yn(e.slice(0,n)));return this}getPeerId(){try{let t=[];this.stringTuples().forEach(([n,o])=>{n===er.p2p.code&&t.push([n,o]),n===er["p2p-circuit"].code&&(t=[])});let e=t.pop();if(e?.[1]!=null){let n=e[1];return n[0]==="Q"||n[0]==="1"?U(X.decode(`z${n}`),"base58btc"):U(ct.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){return this.#n}equals(t){return ht(this.bytes,t.bytes)}async resolve(t){let e=this.protos().find(s=>s.resolvable);if(e==null)return[this];let n=Da.get(e.name);if(n==null)throw new Ss(`no available resolver for ${e.name}`);return(await n(this,t)).map(s=>Wt(s))}nodeAddress(){let t=this.toOptions();if(t.transport!=="tcp"&&t.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${t.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:t.family,address:t.host,port:t.port}}isThinWaistAddress(t){let e=(t??this).protos();return!(e.length!==2||e[0].code!==4&&e[0].code!==41||e[1].code!==6&&e[1].code!==273)}[Bl](){return`Multiaddr(${this.#e})`}};var Da=new Map;function Ra(r){return!!r?.[Is]}function Wt(r){return new gn(r)}var Ua="libp2p-peer-record",Oa=Uint8Array.from([3,1]);var Tr;(function(r){let t;(function(n){let o;n.codec=()=>(o==null&&(o=Vt((s,i,c={})=>{c.lengthDelimited!==!1&&i.fork(),s.multiaddr!=null&&s.multiaddr.byteLength>0&&(i.uint32(10),i.bytes(s.multiaddr)),c.lengthDelimited!==!1&&i.ldelim()},(s,i,c={})=>{let a={multiaddr:yt(0)},f=i==null?s.len:s.pos+i;for(;s.pos<f;){let u=s.uint32();switch(u>>>3){case 1:{a.multiaddr=s.bytes();break}default:{s.skipType(u&7);break}}}return a})),o),n.encode=s=>Ft(s,n.codec()),n.decode=(s,i)=>Mt(s,n.codec(),i)})(t=r.AddressInfo||(r.AddressInfo={}));let e;r.codec=()=>(e==null&&(e=Vt((n,o,s={})=>{if(s.lengthDelimited!==!1&&o.fork(),n.peerId!=null&&n.peerId.byteLength>0&&(o.uint32(10),o.bytes(n.peerId)),n.seq!=null&&n.seq!==0n&&(o.uint32(16),o.uint64(n.seq)),n.addresses!=null)for(let i of n.addresses)o.uint32(26),r.AddressInfo.codec().encode(i,o);s.lengthDelimited!==!1&&o.ldelim()},(n,o,s={})=>{let i={peerId:yt(0),seq:0n,addresses:[]},c=o==null?n.len:n.pos+o;for(;n.pos<c;){let a=n.uint32();switch(a>>>3){case 1:{i.peerId=n.bytes();break}case 2:{i.seq=n.uint64();break}case 3:{if(s.limits?.addresses!=null&&i.addresses.length===s.limits.addresses)throw new Te('Decode error - map field "addresses" had too many elements');i.addresses.push(r.AddressInfo.codec().decode(n,n.uint32(),{limits:s.limits?.addresses$}));break}default:{n.skipType(a&7);break}}}return i})),e),r.encode=n=>Ft(n,r.codec()),r.decode=(n,o)=>Mt(n,r.codec(),o)})(Tr||(Tr={}));var qt=class r{static createFromProtobuf=t=>{let e=Tr.decode(t),n=fs(we(e.peerId)),o=(e.addresses??[]).map(i=>Wt(i.multiaddr)),s=e.seq;return new r({peerId:n,multiaddrs:o,seqNumber:s})};static DOMAIN=Ua;static CODEC=Oa;peerId;multiaddrs;seqNumber;domain=r.DOMAIN;codec=r.CODEC;marshaled;constructor(t){let{peerId:e,multiaddrs:n,seqNumber:o}=t;this.peerId=e,this.multiaddrs=n??[],this.seqNumber=o??BigInt(Date.now())}marshal(){return this.marshaled==null&&(this.marshaled=Tr.encode({peerId:this.peerId.toMultihash().bytes,seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map(t=>({multiaddr:t.bytes}))})),this.marshaled}equals(t){return!(!(t instanceof r)||!this.peerId.equals(t.peerId)||this.seqNumber!==t.seqNumber||!ga(this.multiaddrs,t.multiaddrs))}};function Cl(r){return r[Symbol.asyncIterator]!=null}function Ll(r){if(Cl(r))return(async()=>{for await(let t of r);})();for(let t of r);}var Na=Ll;function Ht(){let r={};return r.promise=new Promise((t,e)=>{r.resolve=t,r.reject=e}),r}var bn=globalThis.CustomEvent??Event;async function*Bs(r,t={}){let e=t.concurrency??1/0;e<1&&(e=1/0);let n=t.ordered??!1,o=new EventTarget,s=[],i=Ht(),c=Ht(),a=!1,f,u=!1;o.addEventListener("task-complete",()=>{c.resolve()}),Promise.resolve().then(async()=>{try{for await(let m of r){if(s.length===e&&(i=Ht(),await i.promise),u)break;let g={done:!1};s.push(g),m().then(h=>{g.done=!0,g.ok=!0,g.value=h,o.dispatchEvent(new bn("task-complete"))},h=>{g.done=!0,g.err=h,o.dispatchEvent(new bn("task-complete"))})}a=!0,o.dispatchEvent(new bn("task-complete"))}catch(m){f=m,o.dispatchEvent(new bn("task-complete"))}});function l(){return n?s[0]?.done:!!s.find(m=>m.done)}function*d(){for(;s.length>0&&s[0].done;){let m=s[0];if(s.shift(),m.ok)yield m.value;else throw u=!0,i.resolve(),m.err;i.resolve()}}function*b(){for(;l();)for(let m=0;m<s.length;m++)if(s[m].done){let g=s[m];if(s.splice(m,1),m--,g.ok)yield g.value;else throw u=!0,i.resolve(),g.err;i.resolve()}}for(;;){if(l()||(c=Ht(),await c.promise),f!=null)throw f;if(n?yield*d():yield*b(),a&&s.length===0)break}}var xn=class extends Error{type;code;constructor(t,e,n){super(t??"The operation was aborted"),this.type="aborted",this.name=n??"AbortError",this.code=e??"ABORT_ERR"}};async function _r(r,t,e){if(t==null)return r;if(t.aborted)return r.catch(()=>{}),Promise.reject(new xn(e?.errorMessage,e?.errorCode,e?.errorName));let n,o=new xn(e?.errorMessage,e?.errorCode,e?.errorName);try{return await Promise.race([r,new Promise((s,i)=>{n=()=>{i(o)},t.addEventListener("abort",n)})])}finally{n!=null&&t.removeEventListener("abort",n)}}var Ps=class{readNext;haveNext;ended;nextResult;error;constructor(){this.ended=!1,this.readNext=Ht(),this.haveNext=Ht()}[Symbol.asyncIterator](){return this}async next(){if(this.nextResult==null&&await this.haveNext.promise,this.nextResult==null)throw new Error("HaveNext promise resolved but nextResult was undefined");let t=this.nextResult;return this.nextResult=void 0,this.readNext.resolve(),this.readNext=Ht(),t}async throw(t){return this.ended=!0,this.error=t,t!=null&&(this.haveNext.promise.catch(()=>{}),this.haveNext.reject(t)),{done:!0,value:void 0}}async return(){let t={done:!0,value:void 0};return this.ended=!0,this.nextResult=t,this.haveNext.resolve(),t}async push(t,e){await this._push(t,e)}async end(t,e){t!=null?await this.throw(t):await this._push(void 0,e)}async _push(t,e){if(t!=null&&this.ended)throw this.error??new Error("Cannot push value onto an ended pushable");for(;this.nextResult!=null;)await this.readNext.promise;t!=null?this.nextResult={done:!1,value:t}:(this.ended=!0,this.nextResult={done:!0,value:void 0}),this.haveNext.resolve(),this.haveNext=Ht(),await _r(this.readNext.promise,e?.signal,e)}};function Ka(){return new Ps}var wn=class extends Error{name="UnexpectedEOFError";code="ERR_UNEXPECTED_EOF"};function ka(r,t){let e=Ka();r.sink(e).catch(async i=>{await e.end(i)}),r.sink=async i=>{for await(let c of i)await e.push(c);await e.end()};let n=r.source;r.source[Symbol.iterator]!=null?n=r.source[Symbol.iterator]():r.source[Symbol.asyncIterator]!=null&&(n=r.source[Symbol.asyncIterator]());let o=new st;return{read:async i=>{if(i?.signal?.throwIfAborted(),i?.bytes==null){let{done:a,value:f}=await _r(n.next(),i?.signal);return a===!0?null:f}for(;o.byteLength<i.bytes;){let{value:a,done:f}=await _r(n.next(),i?.signal);if(f===!0)throw new wn("unexpected end of input");o.append(a)}let c=o.sublist(0,i.bytes);return o.consume(i.bytes),c},write:async(i,c)=>{c?.signal?.throwIfAborted(),i instanceof Uint8Array?await e.push(i,c):await e.push(i.subarray(),c)},unwrap:()=>{if(o.byteLength>0){let i=r.source;r.source=async function*(){t?.yieldBytes===!1?yield o:yield*o,yield*i}()}return r}}}var En=class extends Error{name="InvalidMessageLengthError";code="ERR_INVALID_MSG_LENGTH"},vn=class extends Error{name="InvalidDataLengthError";code="ERR_MSG_DATA_TOO_LONG"},An=class extends Error{name="InvalidDataLengthLengthError";code="ERR_MSG_LENGTH_TOO_LONG"};function Ma(r,t={}){let e=ka(r,t);t.maxDataLength!=null&&t.maxLengthLength==null&&(t.maxLengthLength=xt(t.maxDataLength));let n=t?.lengthDecoder??re,o=t?.lengthEncoder??Dt;return{read:async i=>{let c=-1,a=new st;for(;;){a.append(await e.read({...i,bytes:1}));try{c=n(a)}catch(f){if(f instanceof RangeError)continue;throw f}if(c<0)throw new En("Invalid message length");if(t?.maxLengthLength!=null&&a.byteLength>t.maxLengthLength)throw new An("message length length too long");if(c>-1)break}if(t?.maxDataLength!=null&&c>t.maxDataLength)throw new vn("message length too long");return e.read({...i,bytes:c})},write:async(i,c)=>{await e.write(new st(o(i.byteLength),i),c)},writeV:async(i,c)=>{let a=new st(...i.flatMap(f=>[o(f.byteLength),f]));await e.write(a,c)},unwrap:()=>e.unwrap()}}function rr(r,t){let e=Ma(r,t),n={read:async(o,s)=>{let i=await e.read(s);return o.decode(i)},write:async(o,s,i)=>{await e.write(s.encode(o),i)},writeV:async(o,s,i)=>{await e.writeV(o.map(c=>s.encode(c)),i)},pb:o=>({read:async s=>n.read(o,s),write:async(s,i)=>n.write(s,o,i),writeV:async(s,i)=>n.writeV(s,o,i),unwrap:()=>n}),unwrap:()=>e.unwrap()};return n}var Fa="0.1.0",Va="id",qa="id/push",Ha="1.0.0",za="1.0.0";var be;(function(r){let t;r.codec=()=>(t==null&&(t=Vt((e,n,o={})=>{if(o.lengthDelimited!==!1&&n.fork(),e.protocolVersion!=null&&(n.uint32(42),n.string(e.protocolVersion)),e.agentVersion!=null&&(n.uint32(50),n.string(e.agentVersion)),e.publicKey!=null&&(n.uint32(10),n.bytes(e.publicKey)),e.listenAddrs!=null)for(let s of e.listenAddrs)n.uint32(18),n.bytes(s);if(e.observedAddr!=null&&(n.uint32(34),n.bytes(e.observedAddr)),e.protocols!=null)for(let s of e.protocols)n.uint32(26),n.string(s);e.signedPeerRecord!=null&&(n.uint32(66),n.bytes(e.signedPeerRecord)),o.lengthDelimited!==!1&&n.ldelim()},(e,n,o={})=>{let s={listenAddrs:[],protocols:[]},i=n==null?e.len:e.pos+n;for(;e.pos<i;){let c=e.uint32();switch(c>>>3){case 5:{s.protocolVersion=e.string();break}case 6:{s.agentVersion=e.string();break}case 1:{s.publicKey=e.bytes();break}case 2:{if(o.limits?.listenAddrs!=null&&s.listenAddrs.length===o.limits.listenAddrs)throw new Te('Decode error - map field "listenAddrs" had too many elements');s.listenAddrs.push(e.bytes());break}case 4:{s.observedAddr=e.bytes();break}case 3:{if(o.limits?.protocols!=null&&s.protocols.length===o.limits.protocols)throw new Te('Decode error - map field "protocols" had too many elements');s.protocols.push(e.string());break}case 8:{s.signedPeerRecord=e.bytes();break}default:{e.skipType(c&7);break}}}return s})),t),r.encode=e=>Ft(e,r.codec()),r.decode=(e,n)=>Mt(e,r.codec(),n)})(be||(be={}));var Pt={protocolPrefix:"ipfs",timeout:5e3,maxInboundStreams:1,maxOutboundStreams:1,maxObservedAddresses:10,maxMessageSize:8192,runOnConnectionOpen:!0,runOnSelfUpdate:!0,runOnLimitedConnection:!0,concurrency:32};function Ga(r){if(r!=null&&r.length>0)try{return Wt(r)}catch{}}function Dl(r,t){return t??r.userAgent}async function Sn(r,t,e,n,o){if(e("received identify from %p",n.remotePeer),o==null)throw new Ut("message was null or undefined");let s={};if(o.listenAddrs.length>0&&(s.addresses=o.listenAddrs.map(a=>({isCertified:!1,multiaddr:Wt(a)}))),o.protocols.length>0&&(s.protocols=o.protocols),o.publicKey!=null){let a=Ye(o.publicKey);if(!ya(a).equals(n.remotePeer))throw new Ut("public key did not match remote PeerId");s.publicKey=a}let i;if(o.signedPeerRecord!=null){e.trace("received signedPeerRecord from %p",n.remotePeer);let a=o.signedPeerRecord,f=await jt.openAndCertify(a,qt.DOMAIN),u=qt.createFromProtobuf(f.payload),l=fn(f.publicKey.toCID());if(!u.peerId.equals(l))throw new Ut("signing key does not match PeerId in the PeerRecord");if(!n.remotePeer.equals(u.peerId))throw new Ut("signing key does not match remote PeerId");let d;try{d=await r.get(u.peerId)}catch(b){if(b.name!=="NotFoundError")throw b}if(d!=null&&(s.metadata=d.metadata,d.peerRecordEnvelope!=null)){let b=await jt.createFromProtobuf(d.peerRecordEnvelope),m=qt.createFromProtobuf(b.payload);m.seqNumber>=u.seqNumber&&(e("sequence number was lower or equal to existing sequence number - stored: %d received: %d",m.seqNumber,u.seqNumber),u=m,a=d.peerRecordEnvelope)}s.peerRecordEnvelope=a,s.addresses=u.multiaddrs.map(b=>({isCertified:!0,multiaddr:b})),i={seq:u.seqNumber,addresses:u.multiaddrs}}else e("%p did not send a signed peer record",n.remotePeer);if(e.trace("patching %p with",n.remotePeer,s),await r.patch(n.remotePeer,s),o.agentVersion!=null||o.protocolVersion!=null){let a={};o.agentVersion!=null&&(a.AgentVersion=M(o.agentVersion)),o.protocolVersion!=null&&(a.ProtocolVersion=M(o.protocolVersion)),e.trace("merging %p metadata",n.remotePeer,a),await r.merge(n.remotePeer,{metadata:a})}let c={peerId:n.remotePeer,protocolVersion:o.protocolVersion,agentVersion:o.agentVersion,publicKey:o.publicKey,listenAddrs:o.listenAddrs.map(a=>Wt(a)),observedAddr:o.observedAddr==null?void 0:Wt(o.observedAddr),protocols:o.protocols,signedPeerRecord:i,connection:n};return t.safeDispatchEvent("peer:identify",{detail:c}),c}var nr=class{host;protocol;started;timeout;peerId;privateKey;peerStore;registrar;addressManager;maxInboundStreams;maxOutboundStreams;maxMessageSize;maxObservedAddresses;events;runOnLimitedConnection;log;constructor(t,e){this.protocol=e.protocol,this.started=!1,this.peerId=t.peerId,this.privateKey=t.privateKey,this.peerStore=t.peerStore,this.registrar=t.registrar,this.addressManager=t.addressManager,this.events=t.events,this.log=e.log,this.timeout=e.timeout??Pt.timeout,this.maxInboundStreams=e.maxInboundStreams??Pt.maxInboundStreams,this.maxOutboundStreams=e.maxOutboundStreams??Pt.maxOutboundStreams,this.maxMessageSize=e.maxMessageSize??Pt.maxMessageSize,this.maxObservedAddresses=e.maxObservedAddresses??Pt.maxObservedAddresses,this.runOnLimitedConnection=e.runOnLimitedConnection??Pt.runOnLimitedConnection,this.host={protocolVersion:`${e.protocolPrefix??Pt.protocolPrefix}/${Fa}`,agentVersion:Dl(t.nodeInfo,e.agentVersion)}}isStarted(){return this.started}async start(){this.started||(await this.peerStore.merge(this.peerId,{metadata:{AgentVersion:M(this.host.agentVersion),ProtocolVersion:M(this.host.protocolVersion)}}),await this.registrar.handle(this.protocol,t=>{this.handleProtocol(t).catch(e=>{this.log.error(e)})},{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams,runOnLimitedConnection:this.runOnLimitedConnection}),this.started=!0)}async stop(){await this.registrar.unhandle(this.protocol),this.started=!1}};var In=class extends nr{connectionManager;concurrency;constructor(t,e={}){super(t,{...e,protocol:`/${e.protocolPrefix??Pt.protocolPrefix}/${qa}/${za}`,log:t.logger.forComponent("libp2p:identify-push")}),this.connectionManager=t.connectionManager,this.concurrency=e.concurrency??Pt.concurrency,(e.runOnSelfUpdate??Pt.runOnSelfUpdate)&&t.events.addEventListener("self:peer:update",n=>{this.push().catch(o=>{this.log.error(o)})})}[Fr]=["@libp2p/identify-push"];async push(){if(!this.isStarted())return;let t=this.addressManager.getAddresses().map(u=>u.decapsulateCode(z("p2p").code)),e=new qt({peerId:this.peerId,multiaddrs:t}),n=await jt.seal(e,this.privateKey),o=this.registrar.getProtocols(),s=await this.peerStore.get(this.peerId),i=U(s.metadata.get("AgentVersion")??M(this.host.agentVersion)),c=U(s.metadata.get("ProtocolVersion")??M(this.host.protocolVersion)),a=this;async function*f(){for(let u of a.connectionManager.getConnections())(await a.peerStore.get(u.remotePeer)).protocols.includes(a.protocol)&&(yield async()=>{let d,b=AbortSignal.timeout(a.timeout);try{d=await u.newStream(a.protocol,{signal:b,runOnLimitedConnection:a.runOnLimitedConnection}),await rr(d,{maxDataLength:a.maxMessageSize}).pb(be).write({listenAddrs:t.map(g=>g.bytes),signedPeerRecord:n.marshal(),protocols:o,agentVersion:i,protocolVersion:c},{signal:b}),await d.close({signal:b})}catch(m){a.log.error("could not push identify update to peer",m),d?.abort(m)}})}await Na(Bs(f(),{concurrency:this.concurrency}))}async handleProtocol(t){let{connection:e,stream:n}=t;try{if(this.peerId.equals(e.remotePeer))throw new Error("received push from ourselves?");let o={signal:AbortSignal.timeout(this.timeout)},i=await rr(n,{maxDataLength:this.maxMessageSize}).pb(be).read(o);await n.close(o),await Sn(this.peerStore,this.events,this.log,e,i)}catch(o){this.log.error("received invalid message",o),n.abort(o);return}this.log.trace("handled push from %p",e.remotePeer)}};var Ul=41;function $a(r){try{let[[t,e]]=r.stringTuples();if(e==null)return!1;if(t===Ul)return Sa("2000::/3",e)}catch{}return!1}var ja=yc(Za(),1),Ol=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"],Nl=Ol.map(r=>new ja.Netmask(r));function Cs(r){for(let t of Nl)if(t.contains(r))return!0;return!1}function Kl(r){return/^::ffff:([0-9a-fA-F]{1,4}):([0-9a-fA-F]{1,4})$/.test(r)}function kl(r){let t=r.split(":");if(t.length<2)return!1;let e=t[t.length-1].padStart(4,"0"),n=t[t.length-2].padStart(4,"0"),o=`${parseInt(n.substring(0,2),16)}.${parseInt(n.substring(2),16)}.${parseInt(e.substring(0,2),16)}.${parseInt(e.substring(2),16)}`;return Cs(o)}function Ml(r){return/^::ffff:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(r)}function Fl(r){let t=r.split(":"),e=t[t.length-1];return Cs(e)}function Vl(r){return/^::$/.test(r)||/^::1$/.test(r)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(r)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(r)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(r)||/^ff([0-9a-fA-F]{2,2}):/i.test(r)}function Wa(r){return Qe(r)?Cs(r):Kl(r)?kl(r):Ml(r)?Fl(r):tr(r)?Vl(r):void 0}function Ya(r){try{let[[t]]=r.stringTuples();return t===4||t===41}catch{}return!1}function Xa(r){try{if(!Ya(r))return!1;let[[,t]]=r.stringTuples();return t==null?!1:Wa(t)??!1}catch{}return!0}var ql=r=>r.toString().split("/").slice(1),or=r=>({match:t=>t.length<1?!1:r(t[0])?t.slice(1):!1,pattern:"fn"}),V=r=>({match:t=>or(e=>e===r).match(t),pattern:r}),Oe=()=>({match:r=>or(t=>typeof t=="string").match(r),pattern:"{string}"}),Rr=()=>({match:r=>or(t=>!isNaN(parseInt(t))).match(r),pattern:"{number}"}),W=()=>({match:r=>{if(r.length<2||r[0]!=="p2p"&&r[0]!=="ipfs")return!1;if(r[1].startsWith("Q")||r[1].startsWith("1"))try{X.decode(`z${r[1]}`)}catch{return!1}else return!1;return r.slice(2)},pattern:"/p2p/{peerid}"}),Ur=()=>({match:r=>{if(r.length<2||r[0]!=="certhash")return!1;try{Zn.decode(r[1])}catch{return!1}return r.slice(2)},pattern:"/certhash/{certhash}"}),G=r=>({match:t=>{let e=r.match(t);return e===!1?t:e},pattern:`optional(${r.pattern})`}),Et=(...r)=>({match:t=>{let e;for(let n of r){let o=n.match(t);o!==!1&&(e==null||o.length<e.length)&&(e=o)}return e??!1},pattern:`or(${r.map(t=>t.pattern).join(", ")})`}),q=(...r)=>({match:t=>{for(let e of r){let n=e.match(t);if(n===!1)return!1;t=n}return t},pattern:`and(${r.map(t=>t.pattern).join(", ")})`});function et(...r){function t(o){let s=ql(o);for(let i of r){let c=i.match(s);if(c===!1)return!1;s=c}return s}function e(o){return t(o)!==!1}function n(o){let s=t(o);return s===!1?!1:s.length===0}return{matchers:r,matches:e,exactMatch:n}}var Hl=W(),yx=et(Hl),Pn=q(V("dns4"),Oe()),Cn=q(V("dns6"),Oe()),Ln=q(V("dnsaddr"),Oe()),Ts=q(V("dns"),Oe()),gx=et(Pn,G(W())),bx=et(Cn,G(W())),xx=et(Ln,G(W())),wx=et(Et(Ts,Ln,Pn,Cn),G(W())),Ja=q(V("ip4"),or(Qe)),Qa=q(V("ip6"),or(tr)),_s=Et(Ja,Qa),se=Et(_s,Ts,Pn,Cn,Ln),tc=et(Et(_s,q(Et(Ts,Ln,Pn,Cn),G(W())))),Ex=et(Ja),vx=et(Qa),Ax=et(_s),Ds=q(se,V("tcp"),Rr()),Or=q(se,V("udp"),Rr()),ec=et(q(Ds,G(W()))),Sx=et(Or),Rs=q(Or,V("quic"),G(W())),Tn=q(Or,V("quic-v1"),G(W())),zl=Et(Rs,Tn),Ix=et(Rs),Bx=et(Tn),Ls=Et(se,Ds,Or,Rs,Tn),rc=Et(q(Ls,V("ws"),G(W()))),Px=et(rc),nc=Et(q(Ls,V("wss"),G(W())),q(Ls,V("tls"),G(q(V("sni"),Oe())),V("ws"),G(W()))),Cx=et(nc),oc=q(Or,V("webrtc-direct"),G(Ur()),G(Ur()),G(W())),Lx=et(oc),sc=q(Tn,V("webtransport"),G(Ur()),G(Ur()),G(W())),Tx=et(sc),Bn=Et(rc,nc,q(Ds,G(W())),q(zl,G(W())),q(se,G(W())),oc,sc,W()),_x=et(Bn),Gl=q(Bn,V("p2p-circuit"),W()),Dx=et(Gl),$l=Et(q(Bn,V("p2p-circuit"),V("webrtc"),G(W())),q(Bn,V("webrtc"),G(W())),q(V("webrtc"),G(W()))),Rx=et($l),Zl=Et(q(se,V("tcp"),Rr(),V("http"),G(W())),q(se,V("http"),G(W()))),Ux=et(Zl),jl=Et(q(se,V("tcp"),Et(q(V("443"),V("http")),q(Rr(),V("https"))),G(W())),q(se,V("tls"),V("http"),G(W())),q(se,V("https"),G(W()))),Ox=et(jl),Wl=Et(q(V("memory"),Oe(),G(W()))),Nx=et(Wl);var Yl=41,_n=class extends nr{constructor(t,e={}){super(t,{...e,protocol:`/${e.protocolPrefix??Pt.protocolPrefix}/${Va}/${Ha}`,log:t.logger.forComponent("libp2p:identify")}),(e.runOnConnectionOpen??Pt.runOnConnectionOpen)&&t.events.addEventListener("connection:open",n=>{let o=n.detail;this.identify(o).catch(s=>{s.name!==Mr.name&&this.log.error("error during identify trigged by connection:open",s)})})}[Fr]=["@libp2p/identify"];async _identify(t,e={}){let n;if(e.signal==null){let o=AbortSignal.timeout(this.timeout);e={...e,signal:o}}try{n=await t.newStream(this.protocol,{...e,runOnLimitedConnection:this.runOnLimitedConnection});let s=await rr(n,{maxDataLength:this.maxMessageSize}).pb(be).read(e);return await n.close(e),s}catch(o){throw n?.abort(o),o}}async identify(t,e={}){let n=await this._identify(t,e),{publicKey:o,protocols:s,observedAddr:i}=n;if(o==null)throw new Ut("public key was missing from identify message");let c=Ye(o),a=fn(c.toCID());if(!t.remotePeer.equals(a))throw new Ut("identified peer does not match the expected peer");if(this.peerId.equals(a))throw new Ut("identified peer is our own peer id?");return this.maybeAddObservedAddress(i),this.log("identify completed for peer %p and protocols %o",a,s),Sn(this.peerStore,this.events,this.log,t,n)}maybeAddObservedAddress(t){let e=Ga(t);if(e==null)return;if(this.log.trace("our observed address was %a",e),Xa(e)){this.log.trace("our observed address was private");return}if(e.stringTuples()[0][0]===Yl&&!$a(e)){this.log.trace("our observed address was IPv6 but not a global unicast address");return}ec.exactMatch(e)||(this.log.trace("storing the observed address"),this.addressManager.addObservedAddr(e))}async handleProtocol(t){let{connection:e,stream:n}=t,o=AbortSignal.timeout(this.timeout);try{let s=await this.peerStore.get(this.peerId),i=this.addressManager.getAddresses().map(u=>u.decapsulateCode(z("p2p").code)),c=s.peerRecordEnvelope;if(i.length>0&&c==null){let u=new qt({peerId:this.peerId,multiaddrs:i});c=(await jt.seal(u,this.privateKey)).marshal().subarray()}let a=e.remoteAddr.bytes;tc.matches(e.remoteAddr)||(a=void 0),await rr(n).pb(be).write({protocolVersion:this.host.protocolVersion,agentVersion:this.host.agentVersion,publicKey:zt(this.privateKey.publicKey),listenAddrs:i.map(u=>u.bytes),signedPeerRecord:c,observedAddr:a,protocols:s.protocols},{signal:o}),await n.close({signal:o})}catch(s){this.log.error("could not respond to identify request",s),n.abort(s)}}};function Xl(r={}){return t=>new _n(t,r)}function Jl(r={}){return t=>new In(t,r)}return gc(Ql);})();
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
return Libp2PIdentify}));
