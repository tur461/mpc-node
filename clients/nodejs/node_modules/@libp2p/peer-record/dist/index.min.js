(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PPeerRecord = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PPeerRecord=(()=>{var Nr=Object.defineProperty;var _i=Object.getOwnPropertyDescriptor;var Ki=Object.getOwnPropertyNames;var Ri=Object.prototype.hasOwnProperty;var gt=(r,t)=>{for(var e in t)Nr(r,e,{get:t[e],enumerable:!0})},Ni=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Ki(t))!Ri.call(r,o)&&o!==e&&Nr(r,o,{get:()=>t[o],enumerable:!(n=_i(t,o))||n.enumerable});return r};var ki=r=>Ni(Nr({},"__esModule",{value:!0}),r);var Yu={};gt(Yu,{PeerRecord:()=>Rr,RecordEnvelope:()=>vr});var kr=Symbol.for("@libp2p/peer-id");var ot=class extends Error{static name="InvalidParametersError";constructor(t="Invalid parameters"){super(t),this.name="InvalidParametersError"}},ye=class extends Error{static name="InvalidPublicKeyError";constructor(t="Invalid public key"){super(t),this.name="InvalidPublicKeyError"}};var er=class extends Error{static name="InvalidMultihashError";constructor(t="Invalid Multihash"){super(t),this.name="InvalidMultihashError"}};var ge=class extends Error{static name="UnsupportedKeyTypeError";constructor(t="Unsupported key type"){super(t),this.name="UnsupportedKeyTypeError"}};var Vr={};gt(Vr,{base58btc:()=>$,base58flickr:()=>Fi});var tf=new Uint8Array(0);function Uo(r,t){if(r===t)return!0;if(r.byteLength!==t.byteLength)return!1;for(let e=0;e<r.byteLength;e++)if(r[e]!==t[e])return!1;return!0}function Kt(r){if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")}function Do(r){return new TextEncoder().encode(r)}function _o(r){return new TextDecoder().decode(r)}function Oi(r,t){if(r.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),n=0;n<e.length;n++)e[n]=255;for(var o=0;o<r.length;o++){var s=r.charAt(o),i=s.charCodeAt(0);if(e[i]!==255)throw new TypeError(s+" is ambiguous");e[i]=o}var a=r.length,c=r.charAt(0),f=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function l(E){if(E instanceof Uint8Array||(ArrayBuffer.isView(E)?E=new Uint8Array(E.buffer,E.byteOffset,E.byteLength):Array.isArray(E)&&(E=Uint8Array.from(E))),!(E instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(E.length===0)return"";for(var y=0,h=0,b=0,v=E.length;b!==v&&E[b]===0;)b++,y++;for(var m=(v-b)*u+1>>>0,B=new Uint8Array(m);b!==v;){for(var D=E[b],U=0,T=m-1;(D!==0||U<h)&&T!==-1;T--,U++)D+=256*B[T]>>>0,B[T]=D%a>>>0,D=D/a>>>0;if(D!==0)throw new Error("Non-zero carry");h=U,b++}for(var P=m-h;P!==m&&B[P]===0;)P++;for(var L=c.repeat(y);P<m;++P)L+=r.charAt(B[P]);return L}function p(E){if(typeof E!="string")throw new TypeError("Expected String");if(E.length===0)return new Uint8Array;var y=0;if(E[y]!==" "){for(var h=0,b=0;E[y]===c;)h++,y++;for(var v=(E.length-y)*f+1>>>0,m=new Uint8Array(v);E[y];){var B=e[E.charCodeAt(y)];if(B===255)return;for(var D=0,U=v-1;(B!==0||D<b)&&U!==-1;U--,D++)B+=a*m[U]>>>0,m[U]=B%256>>>0,B=B/256>>>0;if(B!==0)throw new Error("Non-zero carry");b=D,y++}if(E[y]!==" "){for(var T=v-b;T!==v&&m[T]===0;)T++;for(var P=new Uint8Array(h+(v-T)),L=h;T!==v;)P[L++]=m[T++];return P}}}function w(E){var y=p(E);if(y)return y;throw new Error(`Non-${t} character`)}return{encode:l,decodeUnsafe:p,decode:w}}var Mi=Oi,qi=Mi,Ro=qi;var Or=class{name;prefix;baseEncode;constructor(t,e,n){this.name=t,this.prefix=e,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},Mr=class{name;prefix;baseDecode;prefixCodePoint;constructor(t,e,n){this.name=t,this.prefix=e;let o=e.codePointAt(0);if(o===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=o,this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return No(this,t)}},qr=class{decoders;constructor(t){this.decoders=t}or(t){return No(this,t)}decode(t){let e=t[0],n=this.decoders[e];if(n!=null)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function No(r,t){return new qr({...r.decoders??{[r.prefix]:r},...t.decoders??{[t.prefix]:t}})}var Hr=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(t,e,n,o){this.name=t,this.prefix=e,this.baseEncode=n,this.baseDecode=o,this.encoder=new Or(t,e,n),this.decoder=new Mr(t,e,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}};function be({name:r,prefix:t,encode:e,decode:n}){return new Hr(r,t,e,n)}function Gt({name:r,prefix:t,alphabet:e}){let{encode:n,decode:o}=Ro(e,r);return be({prefix:t,name:r,encode:n,decode:s=>Kt(o(s))})}function Hi(r,t,e,n){let o={};for(let u=0;u<t.length;++u)o[t[u]]=u;let s=r.length;for(;r[s-1]==="=";)--s;let i=new Uint8Array(s*e/8|0),a=0,c=0,f=0;for(let u=0;u<s;++u){let l=o[r[u]];if(l===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<e|l,a+=e,a>=8&&(a-=8,i[f++]=255&c>>a)}if(a>=e||(255&c<<8-a)!==0)throw new SyntaxError("Unexpected end of data");return i}function Vi(r,t,e){let n=t[t.length-1]==="=",o=(1<<e)-1,s="",i=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],i+=8;i>e;)i-=e,s+=t[o&a>>i];if(i!==0&&(s+=t[o&a<<e-i]),n)for(;(s.length*e&7)!==0;)s+="=";return s}function J({name:r,prefix:t,bitsPerChar:e,alphabet:n}){return be({prefix:t,name:r,encode(o){return Vi(o,n,e)},decode(o){return Hi(o,n,e,r)}})}var $=Gt({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Fi=Gt({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Fr={};gt(Fr,{base32:()=>Rt,base32hex:()=>Zi,base32hexpad:()=>Wi,base32hexpadupper:()=>Yi,base32hexupper:()=>$i,base32pad:()=>Gi,base32padupper:()=>ji,base32upper:()=>zi,base32z:()=>Xi});var Rt=J({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),zi=J({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Gi=J({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ji=J({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Zi=J({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),$i=J({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Wi=J({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Yi=J({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Xi=J({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var zr={};gt(zr,{base36:()=>Ke,base36upper:()=>Ji});var Ke=Gt({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Ji=Gt({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Qi=Mo,ko=128,ta=127,ea=~ta,ra=Math.pow(2,31);function Mo(r,t,e){t=t||[],e=e||0;for(var n=e;r>=ra;)t[e++]=r&255|ko,r/=128;for(;r&ea;)t[e++]=r&255|ko,r>>>=7;return t[e]=r|0,Mo.bytes=e-n+1,t}var na=Gr,oa=128,Oo=127;function Gr(r,n){var e=0,n=n||0,o=0,s=n,i,a=r.length;do{if(s>=a)throw Gr.bytes=0,new RangeError("Could not decode varint");i=r[s++],e+=o<28?(i&Oo)<<o:(i&Oo)*Math.pow(2,o),o+=7}while(i>=oa);return Gr.bytes=s-n,e}var sa=Math.pow(2,7),ia=Math.pow(2,14),aa=Math.pow(2,21),ca=Math.pow(2,28),ua=Math.pow(2,35),fa=Math.pow(2,42),la=Math.pow(2,49),ha=Math.pow(2,56),da=Math.pow(2,63),pa=function(r){return r<sa?1:r<ia?2:r<aa?3:r<ca?4:r<ua?5:r<fa?6:r<la?7:r<ha?8:r<da?9:10},ma={encode:Qi,decode:na,encodingLength:pa},ya=ma,Re=ya;function Ne(r,t=0){return[Re.decode(r,t),Re.decode.bytes]}function xe(r,t,e=0){return Re.encode(r,t,e),t}function we(r){return Re.encodingLength(r)}function It(r,t){let e=t.byteLength,n=we(r),o=n+we(e),s=new Uint8Array(o+e);return xe(r,s,0),xe(e,s,n),s.set(t,o),new Ee(r,e,t,s)}function oe(r){let t=Kt(r),[e,n]=Ne(t),[o,s]=Ne(t.subarray(n)),i=t.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new Ee(e,o,i,t)}function qo(r,t){if(r===t)return!0;{let e=t;return r.code===e.code&&r.size===e.size&&e.bytes instanceof Uint8Array&&Uo(r.bytes,e.bytes)}}var Ee=class{code;size;digest;bytes;constructor(t,e,n,o){this.code=t,this.size=e,this.digest=n,this.bytes=o}};function Ho(r,t){let{bytes:e,version:n}=r;switch(n){case 0:return ba(e,jr(r),t??$.encoder);default:return xa(e,jr(r),t??Rt.encoder)}}var Vo=new WeakMap;function jr(r){let t=Vo.get(r);if(t==null){let e=new Map;return Vo.set(r,e),e}return t}var rt=class r{code;version;multihash;bytes;"/";constructor(t,e,n,o){this.code=e,this.version=t,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:e}=this;if(t!==ke)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(e.code!==wa)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return r.createV0(e)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:e}=this.multihash,n=It(t,e);return r.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return r.equals(this,t)}static equals(t,e){let n=e;return n!=null&&t.code===n.code&&t.version===n.version&&qo(t.multihash,n.multihash)}toString(t){return Ho(this,t)}toJSON(){return{"/":Ho(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let e=t;if(e instanceof r)return e;if(e["/"]!=null&&e["/"]===e.bytes||e.asCID===e){let{version:n,code:o,multihash:s,bytes:i}=e;return new r(n,o,s,i??Fo(n,o,s.bytes))}else if(e[Ea]===!0){let{version:n,multihash:o,code:s}=e,i=oe(o);return r.create(n,s,i)}else return null}static create(t,e,n){if(typeof e!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(e!==ke)throw new Error(`Version 0 CID must use dag-pb (code: ${ke}) block encoding`);return new r(t,e,n,n.bytes)}case 1:{let o=Fo(t,e,n.bytes);return new r(t,e,n,o)}default:throw new Error("Invalid version")}}static createV0(t){return r.create(0,ke,t)}static createV1(t,e){return r.create(1,t,e)}static decode(t){let[e,n]=r.decodeFirst(t);if(n.length!==0)throw new Error("Incorrect length");return e}static decodeFirst(t){let e=r.inspectBytes(t),n=e.size-e.multihashSize,o=Kt(t.subarray(n,n+e.multihashSize));if(o.byteLength!==e.multihashSize)throw new Error("Incorrect length");let s=o.subarray(e.multihashSize-e.digestSize),i=new Ee(e.multihashCode,e.digestSize,s,o);return[e.version===0?r.createV0(i):r.createV1(e.codec,i),t.subarray(e.size)]}static inspectBytes(t){let e=0,n=()=>{let[l,p]=Ne(t.subarray(e));return e+=p,l},o=n(),s=ke;if(o===18?(o=0,e=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=e,a=n(),c=n(),f=e+c,u=f-i;return{version:o,codec:s,multihashCode:a,digestSize:c,multihashSize:u,size:f}}static parse(t,e){let[n,o]=ga(t,e),s=r.decode(o);if(s.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return jr(s).set(n,t),s}};function ga(r,t){switch(r[0]){case"Q":{let e=t??$;return[$.prefix,e.decode(`${$.prefix}${r}`)]}case $.prefix:{let e=t??$;return[$.prefix,e.decode(r)]}case Rt.prefix:{let e=t??Rt;return[Rt.prefix,e.decode(r)]}case Ke.prefix:{let e=t??Ke;return[Ke.prefix,e.decode(r)]}default:{if(t==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[r[0],t.decode(r)]}}}function ba(r,t,e){let{prefix:n}=e;if(n!==$.prefix)throw Error(`Cannot string encode V0 in ${e.name} encoding`);let o=t.get(n);if(o==null){let s=e.encode(r).slice(1);return t.set(n,s),s}else return o}function xa(r,t,e){let{prefix:n}=e,o=t.get(n);if(o==null){let s=e.encode(r);return t.set(n,s),s}else return o}var ke=112,wa=18;function Fo(r,t,e){let n=we(r),o=n+we(t),s=new Uint8Array(o+e.byteLength);return xe(r,s,0),xe(t,s,n),s.set(e,o),s}var Ea=Symbol.for("@ipld/js-cid/CID");var Zr={};gt(Zr,{identity:()=>Tt});var zo=0,Sa="identity",Go=Kt;function Aa(r){return It(zo,Go(r))}var Tt={code:zo,name:Sa,encode:Go,digest:Aa};function at(r,t){if(r===t)return!0;if(r.byteLength!==t.byteLength)return!1;for(let e=0;e<r.byteLength;e++)if(r[e]!==t[e])return!1;return!0}function ft(r=0){return new Uint8Array(r)}function bt(r=0){return new Uint8Array(r)}function St(r,t){t==null&&(t=r.reduce((o,s)=>o+s.length,0));let e=bt(t),n=0;for(let o of r)e.set(o,n),n+=o.length;return e}var Zo=Symbol.for("@achingbrain/uint8arraylist");function jo(r,t){if(t==null||t<0)throw new RangeError("index is out of bounds");let e=0;for(let n of r){let o=e+n.byteLength;if(t<o)return{buf:n,index:t-e};e=o}throw new RangeError("index is out of bounds")}function nr(r){return!!r?.[Zo]}var pt=class r{bufs;length;[Zo]=!0;constructor(...t){this.bufs=[],this.length=0,t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...t){this.appendAll(t)}appendAll(t){let e=0;for(let n of t)if(n instanceof Uint8Array)e+=n.byteLength,this.bufs.push(n);else if(nr(n))e+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=e}prepend(...t){this.prependAll(t)}prependAll(t){let e=0;for(let n of t.reverse())if(n instanceof Uint8Array)e+=n.byteLength,this.bufs.unshift(n);else if(nr(n))e+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=e}get(t){let e=jo(this.bufs,t);return e.buf[e.index]}set(t,e){let n=jo(this.bufs,t);n.buf[n.index]=e}write(t,e=0){if(t instanceof Uint8Array)for(let n=0;n<t.length;n++)this.set(e+n,t[n]);else if(nr(t))for(let n=0;n<t.length;n++)this.set(e+n,t.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(t){if(t=Math.trunc(t),!(Number.isNaN(t)||t<=0)){if(t===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(t>=this.bufs[0].byteLength)t-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(t),this.length-=t;break}}}slice(t,e){let{bufs:n,length:o}=this._subList(t,e);return St(n,o)}subarray(t,e){let{bufs:n,length:o}=this._subList(t,e);return n.length===1?n[0]:St(n,o)}sublist(t,e){let{bufs:n,length:o}=this._subList(t,e),s=new r;return s.length=o,s.bufs=[...n],s}_subList(t,e){if(t=t??0,e=e??this.length,t<0&&(t=this.length+t),e<0&&(e=this.length+e),t<0||e>this.length)throw new RangeError("index is out of bounds");if(t===e)return{bufs:[],length:0};if(t===0&&e===this.length)return{bufs:this.bufs,length:this.length};let n=[],o=0;for(let s=0;s<this.bufs.length;s++){let i=this.bufs[s],a=o,c=a+i.byteLength;if(o=c,t>=c)continue;let f=t>=a&&t<c,u=e>a&&e<=c;if(f&&u){if(t===a&&e===c){n.push(i);break}let l=t-a;n.push(i.subarray(l,l+(e-t)));break}if(f){if(t===0){n.push(i);continue}n.push(i.subarray(t-a));continue}if(u){if(e===c){n.push(i);break}n.push(i.subarray(0,e-a));break}n.push(i)}return{bufs:n,length:e-t}}indexOf(t,e=0){if(!nr(t)&&!(t instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=t instanceof Uint8Array?t:t.subarray();if(e=Number(e??0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let o=n.byteLength;if(o===0)throw new TypeError("search must be at least 1 byte long");let s=256,i=new Int32Array(s);for(let l=0;l<s;l++)i[l]=-1;for(let l=0;l<o;l++)i[n[l]]=l;let a=i,c=this.byteLength-n.byteLength,f=n.byteLength-1,u;for(let l=e;l<=c;l+=u){u=0;for(let p=f;p>=0;p--){let w=this.get(l+p);if(n[p]!==w){u=Math.max(1,p-a[w]);break}}if(u===0)return l}return-1}getInt8(t){let e=this.subarray(t,t+1);return new DataView(e.buffer,e.byteOffset,e.byteLength).getInt8(0)}setInt8(t,e){let n=bt(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,e),this.write(n,t)}getInt16(t,e){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,e)}setInt16(t,e,n){let o=ft(2);new DataView(o.buffer,o.byteOffset,o.byteLength).setInt16(0,e,n),this.write(o,t)}getInt32(t,e){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,e)}setInt32(t,e,n){let o=ft(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setInt32(0,e,n),this.write(o,t)}getBigInt64(t,e){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,e)}setBigInt64(t,e,n){let o=ft(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setBigInt64(0,e,n),this.write(o,t)}getUint8(t){let e=this.subarray(t,t+1);return new DataView(e.buffer,e.byteOffset,e.byteLength).getUint8(0)}setUint8(t,e){let n=bt(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,e),this.write(n,t)}getUint16(t,e){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,e)}setUint16(t,e,n){let o=ft(2);new DataView(o.buffer,o.byteOffset,o.byteLength).setUint16(0,e,n),this.write(o,t)}getUint32(t,e){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,e)}setUint32(t,e,n){let o=ft(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setUint32(0,e,n),this.write(o,t)}getBigUint64(t,e){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,e)}setBigUint64(t,e,n){let o=ft(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setBigUint64(0,e,n),this.write(o,t)}getFloat32(t,e){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,e)}setFloat32(t,e,n){let o=ft(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat32(0,e,n),this.write(o,t)}getFloat64(t,e){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,e)}setFloat64(t,e,n){let o=ft(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat64(0,e,n),this.write(o,t)}equals(t){if(t==null||!(t instanceof r)||t.bufs.length!==this.bufs.length)return!1;for(let e=0;e<this.bufs.length;e++)if(!at(this.bufs[e],t.bufs[e]))return!1;return!0}static fromUint8Arrays(t,e){let n=new r;return n.bufs=t,e==null&&(e=t.reduce((o,s)=>o+s.byteLength,0)),n.length=e,n}};var $r={};gt($r,{base10:()=>va});var va=Gt({prefix:"9",name:"base10",alphabet:"0123456789"});var Wr={};gt(Wr,{base16:()=>Ba,base16upper:()=>Ia});var Ba=J({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ia=J({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Yr={};gt(Yr,{base2:()=>Ta});var Ta=J({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Xr={};gt(Xr,{base256emoji:()=>Da});var $o=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Pa=$o.reduce((r,t,e)=>(r[e]=t,r),[]),La=$o.reduce((r,t,e)=>{let n=t.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${t}`);return r[n]=e,r},[]);function Ca(r){return r.reduce((t,e)=>(t+=Pa[e],t),"")}function Ua(r){let t=[];for(let e of r){let n=e.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${e}`);let o=La[n];if(o==null)throw new Error(`Non-base256emoji character: ${e}`);t.push(o)}return new Uint8Array(t)}var Da=be({prefix:"\u{1F680}",name:"base256emoji",encode:Ca,decode:Ua});var Jr={};gt(Jr,{base64:()=>_a,base64pad:()=>Ka,base64url:()=>Ra,base64urlpad:()=>Na});var _a=J({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Ka=J({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ra=J({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Na=J({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Qr={};gt(Qr,{base8:()=>ka});var ka=J({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var tn={};gt(tn,{identity:()=>Oa});var Oa=be({prefix:"\0",name:"identity",encode:r=>_o(r),decode:r=>Do(r)});var Of=new TextEncoder,Mf=new TextDecoder;var nn={};gt(nn,{sha256:()=>Oe,sha512:()=>Ha});function rn({name:r,code:t,encode:e}){return new en(r,t,e)}var en=class{name;code;encode;constructor(t,e,n){this.name=t,this.code=e,this.encode=n}digest(t){if(t instanceof Uint8Array){let e=this.encode(t);return e instanceof Uint8Array?It(this.code,e):e.then(n=>It(this.code,n))}else throw Error("Unknown type, must be binary type")}};function Yo(r){return async t=>new Uint8Array(await crypto.subtle.digest(r,t))}var Oe=rn({name:"sha2-256",code:18,encode:Yo("SHA-256")}),Ha=rn({name:"sha2-512",code:19,encode:Yo("SHA-512")});var Me={...tn,...Yr,...Qr,...$r,...Wr,...Fr,...zr,...Vr,...Jr,...Xr},Xf={...nn,...Zr};function Jo(r,t,e,n){return{name:r,prefix:t,encoder:{name:r,prefix:t,encode:e},decoder:{decode:n}}}var Xo=Jo("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),on=Jo("ascii","a",r=>{let t="a";for(let e=0;e<r.length;e++)t+=String.fromCharCode(r[e]);return t},r=>{r=r.substring(1);let t=bt(r.length);for(let e=0;e<r.length;e++)t[e]=r.charCodeAt(e);return t}),Va={utf8:Xo,"utf-8":Xo,hex:Me.base16,latin1:on,ascii:on,binary:on,...Me},or=Va;function G(r,t="utf8"){let e=or[t];if(e==null)throw new Error(`Unsupported encoding "${t}"`);return e.decoder.decode(`${e.prefix}${r}`)}function k(r,t="utf8"){let e=or[t];if(e==null)throw new Error(`Unsupported encoding "${t}"`);return e.encoder.encode(r).substring(1)}var Fa=parseInt("11111",2),sn=parseInt("10000000",2),za=parseInt("01111111",2),Qo={0:qe,1:qe,2:Ga,3:$a,4:Wa,5:Za,6:ja,16:qe,22:qe,48:qe};function Nt(r,t={offset:0}){let e=r[t.offset]&Fa;if(t.offset++,Qo[e]!=null)return Qo[e](r,t);throw new Error("No decoder for tag "+e)}function He(r,t){let e=0;if((r[t.offset]&sn)===sn){let n=r[t.offset]&za,o="0x";t.offset++;for(let s=0;s<n;s++,t.offset++)o+=r[t.offset].toString(16).padStart(2,"0");e=parseInt(o,16)}else e=r[t.offset],t.offset++;return e}function qe(r,t){He(r,t);let e=[];for(;!(t.offset>=r.byteLength);){let n=Nt(r,t);if(n===null)break;e.push(n)}return e}function Ga(r,t){let e=He(r,t),n=t.offset,o=t.offset+e,s=[];for(let i=n;i<o;i++)i===n&&r[i]===0||s.push(r[i]);return t.offset+=e,Uint8Array.from(s)}function ja(r,t){let e=He(r,t),n=t.offset+e,o=r[t.offset];t.offset++;let s=0,i=0;o<40?(s=0,i=o):o<80?(s=1,i=o-40):(s=2,i=o-80);let a=`${s}.${i}`,c=[];for(;t.offset<n;){let f=r[t.offset];if(t.offset++,c.push(f&127),f<128){c.reverse();let u=0;for(let l=0;l<c.length;l++)u+=c[l]<<l*7;a+=`.${u}`,c=[]}}return a}function Za(r,t){return t.offset++,null}function $a(r,t){let e=He(r,t),n=r[t.offset];t.offset++;let o=r.subarray(t.offset,t.offset+e-1);if(t.offset+=e,n!==0)throw new Error("Unused bits in bit string is unimplemented");return o}function Wa(r,t){let e=He(r,t),n=r.subarray(t.offset,t.offset+e);return t.offset+=e,n}function Ya(r){let t=r.toString(16);t.length%2===1&&(t="0"+t);let e=new pt;for(let n=0;n<t.length;n+=2)e.append(Uint8Array.from([parseInt(`${t[n]}${t[n+1]}`,16)]));return e}function an(r){if(r.byteLength<128)return Uint8Array.from([r.byteLength]);let t=Ya(r.byteLength);return new pt(Uint8Array.from([t.byteLength|sn]),t)}function xt(r){let t=new pt,e=128;return(r.subarray()[0]&e)===e&&t.append(Uint8Array.from([0])),t.append(r),new pt(Uint8Array.from([2]),an(t),t)}function sr(r){let t=Uint8Array.from([0]),e=new pt(t,r);return new pt(Uint8Array.from([3]),an(e),e)}function Zt(r,t=48){let e=new pt;for(let n of r)e.append(n);return new pt(Uint8Array.from([t]),an(e),e)}async function ts(r,t,e){let n=await crypto.subtle.importKey("jwk",r,{name:"ECDSA",namedCurve:r.crv??"P-256"},!1,["verify"]);return crypto.subtle.verify({name:"ECDSA",hash:{name:"SHA-256"}},n,t,e.subarray())}var Xa=Uint8Array.from([6,8,42,134,72,206,61,3,1,7]),Ja=Uint8Array.from([6,5,43,129,4,0,34]),Qa=Uint8Array.from([6,5,43,129,4,0,35]),tc={ext:!0,kty:"EC",crv:"P-256"},ec={ext:!0,kty:"EC",crv:"P-384"},rc={ext:!0,kty:"EC",crv:"P-521"},cn=32,un=48,fn=66;function ln(r){let t=Nt(r);return es(t)}function es(r){let t=r[1][1][0],e=1,n,o;if(t.byteLength===cn*2+1)return n=k(t.subarray(e,e+cn),"base64url"),o=k(t.subarray(e+cn),"base64url"),new Se({...tc,key_ops:["verify"],x:n,y:o});if(t.byteLength===un*2+1)return n=k(t.subarray(e,e+un),"base64url"),o=k(t.subarray(e+un),"base64url"),new Se({...ec,key_ops:["verify"],x:n,y:o});if(t.byteLength===fn*2+1)return n=k(t.subarray(e,e+fn),"base64url"),o=k(t.subarray(e+fn),"base64url"),new Se({...rc,key_ops:["verify"],x:n,y:o});throw new ot(`coordinates were wrong length, got ${t.byteLength}, expected 65, 97 or 133`)}function rs(r){return Zt([xt(Uint8Array.from([1])),Zt([nc(r.crv)],160),Zt([sr(new pt(Uint8Array.from([4]),G(r.x??"","base64url"),G(r.y??"","base64url")))],161)]).subarray()}function nc(r){if(r==="P-256")return Xa;if(r==="P-384")return Ja;if(r==="P-521")return Qa;throw new ot(`Invalid curve ${r}`)}var Se=class{type="ECDSA";jwk;_raw;constructor(t){this.jwk=t}get raw(){return this._raw==null&&(this._raw=rs(this.jwk)),this._raw}toMultihash(){return Tt.digest($t(this))}toCID(){return rt.createV1(114,this.toMultihash())}toString(){return $.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:at(this.raw,t.raw)}async verify(t,e){return ts(this.jwk,e,t)}};function ns(r){if(!Number.isSafeInteger(r)||r<0)throw new Error("positive integer expected, got "+r)}function oc(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function Ae(r,...t){if(!oc(r))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(r.length))throw new Error("Uint8Array expected of length "+t+", got length="+r.length)}function os(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");ns(r.outputLen),ns(r.blockLen)}function ve(r,t=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(t&&r.finished)throw new Error("Hash#digest() has already been called")}function ss(r,t){Ae(r);let e=t.outputLen;if(r.length<e)throw new Error("digestInto() expects output buffer of length at least "+e)}var se=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function ir(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}function Pt(r,t){return r<<32-t|r>>>t}var Dl=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function";function is(r){if(typeof r!="string")throw new Error("utf8ToBytes expected string, got "+typeof r);return new Uint8Array(new TextEncoder().encode(r))}function Ve(r){return typeof r=="string"&&(r=is(r)),Ae(r),r}function hn(...r){let t=0;for(let n=0;n<r.length;n++){let o=r[n];Ae(o),t+=o.length}let e=new Uint8Array(t);for(let n=0,o=0;n<r.length;n++){let s=r[n];e.set(s,o),o+=s.length}return e}var Be=class{clone(){return this._cloneInto()}};function ar(r){let t=n=>r().update(Ve(n)).digest(),e=r();return t.outputLen=e.outputLen,t.blockLen=e.blockLen,t.create=()=>r(),t}function cr(r=32){if(se&&typeof se.getRandomValues=="function")return se.getRandomValues(new Uint8Array(r));if(se&&typeof se.randomBytes=="function")return Uint8Array.from(se.randomBytes(r));throw new Error("crypto.getRandomValues must be defined")}function sc(r,t,e,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(t,e,n);let o=BigInt(32),s=BigInt(4294967295),i=Number(e>>o&s),a=Number(e&s),c=n?4:0,f=n?0:4;r.setUint32(t+c,i,n),r.setUint32(t+f,a,n)}function as(r,t,e){return r&t^~r&e}function cs(r,t,e){return r&t^r&e^t&e}var Ie=class extends Be{constructor(t,e,n,o){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=o,this.buffer=new Uint8Array(t),this.view=ir(this.buffer)}update(t){ve(this);let{view:e,buffer:n,blockLen:o}=this;t=Ve(t);let s=t.length;for(let i=0;i<s;){let a=Math.min(o-this.pos,s-i);if(a===o){let c=ir(t);for(;o<=s-i;i+=o)this.process(c,i);continue}n.set(t.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===o&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){ve(this),ss(t,this),this.finished=!0;let{buffer:e,view:n,blockLen:o,isLE:s}=this,{pos:i}=this;e[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>o-i&&(this.process(n,0),i=0);for(let l=i;l<o;l++)e[l]=0;sc(n,o-8,BigInt(this.length*8),s),this.process(n,0);let a=ir(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let f=c/4,u=this.get();if(f>u.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<f;l++)a.setUint32(4*l,u[l],s)}digest(){let{buffer:t,outputLen:e}=this;this.digestInto(t);let n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:e,buffer:n,length:o,finished:s,destroyed:i,pos:a}=this;return t.length=o,t.pos=a,t.finished=s,t.destroyed=i,o%e&&t.buffer.set(n),t}};var ic=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Wt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Yt=new Uint32Array(64),dn=class extends Ie{constructor(t=32){super(64,t,8,!1),this.A=Wt[0]|0,this.B=Wt[1]|0,this.C=Wt[2]|0,this.D=Wt[3]|0,this.E=Wt[4]|0,this.F=Wt[5]|0,this.G=Wt[6]|0,this.H=Wt[7]|0}get(){let{A:t,B:e,C:n,D:o,E:s,F:i,G:a,H:c}=this;return[t,e,n,o,s,i,a,c]}set(t,e,n,o,s,i,a,c){this.A=t|0,this.B=e|0,this.C=n|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=a|0,this.H=c|0}process(t,e){for(let l=0;l<16;l++,e+=4)Yt[l]=t.getUint32(e,!1);for(let l=16;l<64;l++){let p=Yt[l-15],w=Yt[l-2],E=Pt(p,7)^Pt(p,18)^p>>>3,y=Pt(w,17)^Pt(w,19)^w>>>10;Yt[l]=y+Yt[l-7]+E+Yt[l-16]|0}let{A:n,B:o,C:s,D:i,E:a,F:c,G:f,H:u}=this;for(let l=0;l<64;l++){let p=Pt(a,6)^Pt(a,11)^Pt(a,25),w=u+p+as(a,c,f)+ic[l]+Yt[l]|0,y=(Pt(n,2)^Pt(n,13)^Pt(n,22))+cs(n,o,s)|0;u=f,f=c,c=a,a=i+w|0,i=s,s=o,o=n,n=w+y|0}n=n+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,a=a+this.E|0,c=c+this.F|0,f=f+this.G|0,u=u+this.H|0,this.set(n,o,s,i,a,c,f,u)}roundClean(){Yt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var ie=ar(()=>new dn);var ur=BigInt(4294967295),pn=BigInt(32);function us(r,t=!1){return t?{h:Number(r&ur),l:Number(r>>pn&ur)}:{h:Number(r>>pn&ur)|0,l:Number(r&ur)|0}}function ac(r,t=!1){let e=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let o=0;o<r.length;o++){let{h:s,l:i}=us(r[o],t);[e[o],n[o]]=[s,i]}return[e,n]}var cc=(r,t)=>BigInt(r>>>0)<<pn|BigInt(t>>>0),uc=(r,t,e)=>r>>>e,fc=(r,t,e)=>r<<32-e|t>>>e,lc=(r,t,e)=>r>>>e|t<<32-e,hc=(r,t,e)=>r<<32-e|t>>>e,dc=(r,t,e)=>r<<64-e|t>>>e-32,pc=(r,t,e)=>r>>>e-32|t<<64-e,mc=(r,t)=>t,yc=(r,t)=>r,gc=(r,t,e)=>r<<e|t>>>32-e,bc=(r,t,e)=>t<<e|r>>>32-e,xc=(r,t,e)=>t<<e-32|r>>>64-e,wc=(r,t,e)=>r<<e-32|t>>>64-e;function Ec(r,t,e,n){let o=(t>>>0)+(n>>>0);return{h:r+e+(o/2**32|0)|0,l:o|0}}var Sc=(r,t,e)=>(r>>>0)+(t>>>0)+(e>>>0),Ac=(r,t,e,n)=>t+e+n+(r/2**32|0)|0,vc=(r,t,e,n)=>(r>>>0)+(t>>>0)+(e>>>0)+(n>>>0),Bc=(r,t,e,n,o)=>t+e+n+o+(r/2**32|0)|0,Ic=(r,t,e,n,o)=>(r>>>0)+(t>>>0)+(e>>>0)+(n>>>0)+(o>>>0),Tc=(r,t,e,n,o,s)=>t+e+n+o+s+(r/2**32|0)|0;var Pc={fromBig:us,split:ac,toBig:cc,shrSH:uc,shrSL:fc,rotrSH:lc,rotrSL:hc,rotrBH:dc,rotrBL:pc,rotr32H:mc,rotr32L:yc,rotlSH:gc,rotlSL:bc,rotlBH:xc,rotlBL:wc,add:Ec,add3L:Sc,add3H:Ac,add4L:vc,add4H:Bc,add5H:Tc,add5L:Ic},K=Pc;var[Lc,Cc]=K.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),Xt=new Uint32Array(80),Jt=new Uint32Array(80),mn=class extends Ie{constructor(t=64){super(128,t,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:e,Bh:n,Bl:o,Ch:s,Cl:i,Dh:a,Dl:c,Eh:f,El:u,Fh:l,Fl:p,Gh:w,Gl:E,Hh:y,Hl:h}=this;return[t,e,n,o,s,i,a,c,f,u,l,p,w,E,y,h]}set(t,e,n,o,s,i,a,c,f,u,l,p,w,E,y,h){this.Ah=t|0,this.Al=e|0,this.Bh=n|0,this.Bl=o|0,this.Ch=s|0,this.Cl=i|0,this.Dh=a|0,this.Dl=c|0,this.Eh=f|0,this.El=u|0,this.Fh=l|0,this.Fl=p|0,this.Gh=w|0,this.Gl=E|0,this.Hh=y|0,this.Hl=h|0}process(t,e){for(let m=0;m<16;m++,e+=4)Xt[m]=t.getUint32(e),Jt[m]=t.getUint32(e+=4);for(let m=16;m<80;m++){let B=Xt[m-15]|0,D=Jt[m-15]|0,U=K.rotrSH(B,D,1)^K.rotrSH(B,D,8)^K.shrSH(B,D,7),T=K.rotrSL(B,D,1)^K.rotrSL(B,D,8)^K.shrSL(B,D,7),P=Xt[m-2]|0,L=Jt[m-2]|0,Z=K.rotrSH(P,L,19)^K.rotrBH(P,L,61)^K.shrSH(P,L,6),H=K.rotrSL(P,L,19)^K.rotrBL(P,L,61)^K.shrSL(P,L,6),N=K.add4L(T,H,Jt[m-7],Jt[m-16]),nt=K.add4H(N,U,Z,Xt[m-7],Xt[m-16]);Xt[m]=nt|0,Jt[m]=N|0}let{Ah:n,Al:o,Bh:s,Bl:i,Ch:a,Cl:c,Dh:f,Dl:u,Eh:l,El:p,Fh:w,Fl:E,Gh:y,Gl:h,Hh:b,Hl:v}=this;for(let m=0;m<80;m++){let B=K.rotrSH(l,p,14)^K.rotrSH(l,p,18)^K.rotrBH(l,p,41),D=K.rotrSL(l,p,14)^K.rotrSL(l,p,18)^K.rotrBL(l,p,41),U=l&w^~l&y,T=p&E^~p&h,P=K.add5L(v,D,T,Cc[m],Jt[m]),L=K.add5H(P,b,B,U,Lc[m],Xt[m]),Z=P|0,H=K.rotrSH(n,o,28)^K.rotrBH(n,o,34)^K.rotrBH(n,o,39),N=K.rotrSL(n,o,28)^K.rotrBL(n,o,34)^K.rotrBL(n,o,39),nt=n&s^n&a^s&a,S=o&i^o&c^i&c;b=y|0,v=h|0,y=w|0,h=E|0,w=l|0,E=p|0,{h:l,l:p}=K.add(f|0,u|0,L|0,Z|0),f=a|0,u=c|0,a=s|0,c=i|0,s=n|0,i=o|0;let I=K.add3L(Z,N,S);n=K.add3H(I,L,H,nt),o=I|0}({h:n,l:o}=K.add(this.Ah|0,this.Al|0,n|0,o|0)),{h:s,l:i}=K.add(this.Bh|0,this.Bl|0,s|0,i|0),{h:a,l:c}=K.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:f,l:u}=K.add(this.Dh|0,this.Dl|0,f|0,u|0),{h:l,l:p}=K.add(this.Eh|0,this.El|0,l|0,p|0),{h:w,l:E}=K.add(this.Fh|0,this.Fl|0,w|0,E|0),{h:y,l:h}=K.add(this.Gh|0,this.Gl|0,y|0,h|0),{h:b,l:v}=K.add(this.Hh|0,this.Hl|0,b|0,v|0),this.set(n,o,s,i,a,c,f,u,l,p,w,E,y,h,b,v)}roundClean(){Xt.fill(0),Jt.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var yn=ar(()=>new mn);var wn=BigInt(0),xn=BigInt(1);function ae(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&r.constructor.name==="Uint8Array"}function En(r){if(!ae(r))throw new Error("Uint8Array expected")}function Ct(r,t){if(typeof t!="boolean")throw new Error(r+" boolean expected, got "+t)}function Fe(r){let t=r.toString(16);return t.length&1?"0"+t:t}function hs(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return r===""?wn:BigInt("0x"+r)}var ds=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Uc=Array.from({length:256},(r,t)=>t.toString(16).padStart(2,"0"));function Qt(r){if(En(r),ds)return r.toHex();let t="";for(let e=0;e<r.length;e++)t+=Uc[r[e]];return t}var kt={_0:48,_9:57,A:65,F:70,a:97,f:102};function fs(r){if(r>=kt._0&&r<=kt._9)return r-kt._0;if(r>=kt.A&&r<=kt.F)return r-(kt.A-10);if(r>=kt.a&&r<=kt.f)return r-(kt.a-10)}function ze(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);if(ds)return Uint8Array.fromHex(r);let t=r.length,e=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(e);for(let o=0,s=0;o<e;o++,s+=2){let i=fs(r.charCodeAt(s)),a=fs(r.charCodeAt(s+1));if(i===void 0||a===void 0){let c=r[s]+r[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[o]=i*16+a}return n}function Ot(r){return hs(Qt(r))}function ce(r){return En(r),hs(Qt(Uint8Array.from(r).reverse()))}function ue(r,t){return ze(r.toString(16).padStart(t*2,"0"))}function Te(r,t){return ue(r,t).reverse()}function X(r,t,e){let n;if(typeof t=="string")try{n=ze(t)}catch(s){throw new Error(r+" must be hex string or Uint8Array, cause: "+s)}else if(ae(t))n=Uint8Array.from(t);else throw new Error(r+" must be hex string or Uint8Array");let o=n.length;if(typeof e=="number"&&o!==e)throw new Error(r+" of length "+e+" expected, got "+o);return n}function te(...r){let t=0;for(let n=0;n<r.length;n++){let o=r[n];En(o),t+=o.length}let e=new Uint8Array(t);for(let n=0,o=0;n<r.length;n++){let s=r[n];e.set(s,o),o+=s.length}return e}var gn=r=>typeof r=="bigint"&&wn<=r;function fr(r,t,e){return gn(r)&&gn(t)&&gn(e)&&t<=r&&r<e}function At(r,t,e,n){if(!fr(t,e,n))throw new Error("expected valid "+r+": "+e+" <= n < "+n+", got "+t)}function ps(r){let t;for(t=0;r>wn;r>>=xn,t+=1);return t}var fe=r=>(xn<<BigInt(r))-xn,bn=r=>new Uint8Array(r),ls=r=>Uint8Array.from(r);function ms(r,t,e){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof e!="function")throw new Error("hmacFn must be a function");let n=bn(r),o=bn(r),s=0,i=()=>{n.fill(1),o.fill(0),s=0},a=(...l)=>e(o,n,...l),c=(l=bn(0))=>{o=a(ls([0]),l),n=a(),l.length!==0&&(o=a(ls([1]),l),n=a())},f=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let l=0,p=[];for(;l<t;){n=a();let w=n.slice();p.push(w),l+=n.length}return te(...p)};return(l,p)=>{i(),c(l);let w;for(;!(w=p(f()));)c();return i(),w}}var Dc={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||ae(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,t)=>t.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function Mt(r,t,e={}){let n=(o,s,i)=>{let a=Dc[s];if(typeof a!="function")throw new Error("invalid validator function");let c=r[o];if(!(i&&c===void 0)&&!a(c,r))throw new Error("param "+String(o)+" is invalid. Expected "+s+", got "+c)};for(let[o,s]of Object.entries(t))n(o,s,!1);for(let[o,s]of Object.entries(e))n(o,s,!0);return r}function Pe(r){let t=new WeakMap;return(e,...n)=>{let o=t.get(e);if(o!==void 0)return o;let s=r(e,...n);return t.set(e,s),s}}var st=BigInt(0),W=BigInt(1),le=BigInt(2),_c=BigInt(3),Sn=BigInt(4),ys=BigInt(5),gs=BigInt(8),Kc=BigInt(9),Rc=BigInt(16);function z(r,t){let e=r%t;return e>=st?e:t+e}function Nc(r,t,e){if(t<st)throw new Error("invalid exponent, negatives unsupported");if(e<=st)throw new Error("invalid modulus");if(e===W)return st;let n=W;for(;t>st;)t&W&&(n=n*r%e),r=r*r%e,t>>=W;return n}function Y(r,t,e){let n=r;for(;t-- >st;)n*=n,n%=e;return n}function lr(r,t){if(r===st)throw new Error("invert: expected non-zero number");if(t<=st)throw new Error("invert: expected positive modulus, got "+t);let e=z(r,t),n=t,o=st,s=W,i=W,a=st;for(;e!==st;){let f=n/e,u=n%e,l=o-i*f,p=s-a*f;n=e,e=u,o=i,s=a,i=l,a=p}if(n!==W)throw new Error("invert: does not exist");return z(o,t)}function kc(r){let t=(r-W)/le,e,n,o;for(e=r-W,n=0;e%le===st;e/=le,n++);for(o=le;o<r&&Nc(o,t,r)!==r-W;o++)if(o>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){let i=(r+W)/Sn;return function(c,f){let u=c.pow(f,i);if(!c.eql(c.sqr(u),f))throw new Error("Cannot find square root");return u}}let s=(e+W)/le;return function(a,c){if(a.pow(c,t)===a.neg(a.ONE))throw new Error("Cannot find square root");let f=n,u=a.pow(a.mul(a.ONE,o),e),l=a.pow(c,s),p=a.pow(c,e);for(;!a.eql(p,a.ONE);){if(a.eql(p,a.ZERO))return a.ZERO;let w=1;for(let y=a.sqr(p);w<f&&!a.eql(y,a.ONE);w++)y=a.sqr(y);let E=a.pow(u,W<<BigInt(f-w-1));u=a.sqr(E),l=a.mul(l,E),p=a.mul(p,u),f=w}return l}}function Oc(r){if(r%Sn===_c){let t=(r+W)/Sn;return function(n,o){let s=n.pow(o,t);if(!n.eql(n.sqr(s),o))throw new Error("Cannot find square root");return s}}if(r%gs===ys){let t=(r-ys)/gs;return function(n,o){let s=n.mul(o,le),i=n.pow(s,t),a=n.mul(o,i),c=n.mul(n.mul(a,le),i),f=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(f),o))throw new Error("Cannot find square root");return f}}return r%Rc,kc(r)}var bs=(r,t)=>(z(r,t)&W)===W,Mc=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function An(r){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},e=Mc.reduce((n,o)=>(n[o]="function",n),t);return Mt(r,e)}function qc(r,t,e){if(e<st)throw new Error("invalid exponent, negatives unsupported");if(e===st)return r.ONE;if(e===W)return t;let n=r.ONE,o=t;for(;e>st;)e&W&&(n=r.mul(n,o)),o=r.sqr(o),e>>=W;return n}function Hc(r,t){let e=new Array(t.length),n=t.reduce((s,i,a)=>r.is0(i)?s:(e[a]=s,r.mul(s,i)),r.ONE),o=r.inv(n);return t.reduceRight((s,i,a)=>r.is0(i)?s:(e[a]=r.mul(s,e[a]),r.mul(s,i)),o),e}function vn(r,t){let e=t!==void 0?t:r.toString(2).length,n=Math.ceil(e/8);return{nBitLength:e,nByteLength:n}}function ee(r,t,e=!1,n={}){if(r<=st)throw new Error("invalid field: expected ORDER > 0, got "+r);let{nBitLength:o,nByteLength:s}=vn(r,t);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let i,a=Object.freeze({ORDER:r,isLE:e,BITS:o,BYTES:s,MASK:fe(o),ZERO:st,ONE:W,create:c=>z(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return st<=c&&c<r},is0:c=>c===st,isOdd:c=>(c&W)===W,neg:c=>z(-c,r),eql:(c,f)=>c===f,sqr:c=>z(c*c,r),add:(c,f)=>z(c+f,r),sub:(c,f)=>z(c-f,r),mul:(c,f)=>z(c*f,r),pow:(c,f)=>qc(a,c,f),div:(c,f)=>z(c*lr(f,r),r),sqrN:c=>c*c,addN:(c,f)=>c+f,subN:(c,f)=>c-f,mulN:(c,f)=>c*f,inv:c=>lr(c,r),sqrt:n.sqrt||(c=>(i||(i=Oc(r)),i(a,c))),invertBatch:c=>Hc(a,c),cmov:(c,f,u)=>u?f:c,toBytes:c=>e?Te(c,s):ue(c,s),fromBytes:c=>{if(c.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+c.length);return e?ce(c):Ot(c)}});return Object.freeze(a)}function xs(r){if(typeof r!="bigint")throw new Error("field order must be bigint");let t=r.toString(2).length;return Math.ceil(t/8)}function Bn(r){let t=xs(r);return t+Math.ceil(t/2)}function ws(r,t,e=!1){let n=r.length,o=xs(t),s=Bn(t);if(n<16||n<s||n>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+n);let i=e?ce(r):Ot(r),a=z(i,t-W)+W;return e?Te(a,o):ue(a,o)}var Es=BigInt(0),Cn=BigInt(1);function In(r,t){let e=t.negate();return r?e:t}function As(r,t){if(!Number.isSafeInteger(r)||r<=0||r>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+r)}function Tn(r,t){As(r,t);let e=Math.ceil(t/r)+1,n=2**(r-1),o=2**r,s=fe(r),i=BigInt(r);return{windows:e,windowSize:n,mask:s,maxNumber:o,shiftBy:i}}function Ss(r,t,e){let{windowSize:n,mask:o,maxNumber:s,shiftBy:i}=e,a=Number(r&o),c=r>>i;a>n&&(a-=s,c+=Cn);let f=t*n,u=f+Math.abs(a)-1,l=a===0,p=a<0,w=t%2!==0;return{nextN:c,offset:u,isZero:l,isNeg:p,isNegF:w,offsetF:f}}function Vc(r,t){if(!Array.isArray(r))throw new Error("array expected");r.forEach((e,n)=>{if(!(e instanceof t))throw new Error("invalid point at index "+n)})}function Fc(r,t){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((e,n)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+n)})}var Pn=new WeakMap,vs=new WeakMap;function Ln(r){return vs.get(r)||1}function hr(r,t){return{constTimeNegate:In,hasPrecomputes(e){return Ln(e)!==1},unsafeLadder(e,n,o=r.ZERO){let s=e;for(;n>Es;)n&Cn&&(o=o.add(s)),s=s.double(),n>>=Cn;return o},precomputeWindow(e,n){let{windows:o,windowSize:s}=Tn(n,t),i=[],a=e,c=a;for(let f=0;f<o;f++){c=a,i.push(c);for(let u=1;u<s;u++)c=c.add(a),i.push(c);a=c.double()}return i},wNAF(e,n,o){let s=r.ZERO,i=r.BASE,a=Tn(e,t);for(let c=0;c<a.windows;c++){let{nextN:f,offset:u,isZero:l,isNeg:p,isNegF:w,offsetF:E}=Ss(o,c,a);o=f,l?i=i.add(In(w,n[E])):s=s.add(In(p,n[u]))}return{p:s,f:i}},wNAFUnsafe(e,n,o,s=r.ZERO){let i=Tn(e,t);for(let a=0;a<i.windows&&o!==Es;a++){let{nextN:c,offset:f,isZero:u,isNeg:l}=Ss(o,a,i);if(o=c,!u){let p=n[f];s=s.add(l?p.negate():p)}}return s},getPrecomputes(e,n,o){let s=Pn.get(n);return s||(s=this.precomputeWindow(n,e),e!==1&&Pn.set(n,o(s))),s},wNAFCached(e,n,o){let s=Ln(e);return this.wNAF(s,this.getPrecomputes(s,e,o),n)},wNAFCachedUnsafe(e,n,o,s){let i=Ln(e);return i===1?this.unsafeLadder(e,n,s):this.wNAFUnsafe(i,this.getPrecomputes(i,e,o),n,s)},setWindowSize(e,n){As(n,t),vs.set(e,n),Pn.delete(e)}}}function dr(r,t,e,n){if(Vc(e,r),Fc(n,t),e.length!==n.length)throw new Error("arrays of points and scalars must have equal length");let o=r.ZERO,s=ps(BigInt(e.length)),i=s>12?s-3:s>4?s-2:s?2:1,a=fe(i),c=new Array(Number(a)+1).fill(o),f=Math.floor((t.BITS-1)/i)*i,u=o;for(let l=f;l>=0;l-=i){c.fill(o);for(let w=0;w<n.length;w++){let E=n[w],y=Number(E>>BigInt(l)&a);c[y]=c[y].add(e[w])}let p=o;for(let w=c.length-1,E=o;w>0;w--)E=E.add(c[w]),p=p.add(E);if(u=u.add(p),l!==0)for(let w=0;w<i;w++)u=u.double()}return u}function Ge(r){return An(r.Fp),Mt(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...vn(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}var Ut=BigInt(0),mt=BigInt(1),Bs=BigInt(2),zc=BigInt(8),Gc={zip215:!0};function jc(r){let t=Ge(r);return Mt(r,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function Is(r){let t=jc(r),{Fp:e,n,prehash:o,hash:s,randomBytes:i,nByteLength:a,h:c}=t,f=Bs<<BigInt(a*8)-mt,u=e.create,l=ee(t.n,t.nBitLength),p=t.uvRatio||((g,d)=>{try{return{isValid:!0,value:e.sqrt(g*e.inv(d))}}catch{return{isValid:!1,value:Ut}}}),w=t.adjustScalarBytes||(g=>g),E=t.domain||((g,d,x)=>{if(Ct("phflag",x),d.length||x)throw new Error("Contexts/pre-hash are not supported");return g});function y(g,d,x=!1){let A=x?mt:Ut;At("coordinate "+g,d,A,f)}function h(g){if(!(g instanceof m))throw new Error("ExtendedPoint expected")}let b=Pe((g,d)=>{let{ex:x,ey:A,ez:_}=g,R=g.is0();d==null&&(d=R?zc:e.inv(_));let O=u(x*d),M=u(A*d),q=u(_*d);if(R)return{x:Ut,y:mt};if(q!==mt)throw new Error("invZ was invalid");return{x:O,y:M}}),v=Pe(g=>{let{a:d,d:x}=t;if(g.is0())throw new Error("bad point: ZERO");let{ex:A,ey:_,ez:R,et:O}=g,M=u(A*A),q=u(_*_),F=u(R*R),et=u(F*F),Q=u(M*d),ut=u(F*u(Q+q)),yt=u(et+u(x*u(M*q)));if(ut!==yt)throw new Error("bad point: equation left != right (1)");let it=u(A*_),lt=u(R*O);if(it!==lt)throw new Error("bad point: equation left != right (2)");return!0});class m{constructor(d,x,A,_){y("x",d),y("y",x),y("z",A,!0),y("t",_),this.ex=d,this.ey=x,this.ez=A,this.et=_,Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(d){if(d instanceof m)throw new Error("extended point not allowed");let{x,y:A}=d||{};return y("x",x),y("y",A),new m(x,A,mt,u(x*A))}static normalizeZ(d){let x=e.invertBatch(d.map(A=>A.ez));return d.map((A,_)=>A.toAffine(x[_])).map(m.fromAffine)}static msm(d,x){return dr(m,l,d,x)}_setWindowSize(d){U.setWindowSize(this,d)}assertValidity(){v(this)}equals(d){h(d);let{ex:x,ey:A,ez:_}=this,{ex:R,ey:O,ez:M}=d,q=u(x*M),F=u(R*_),et=u(A*M),Q=u(O*_);return q===F&&et===Q}is0(){return this.equals(m.ZERO)}negate(){return new m(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){let{a:d}=t,{ex:x,ey:A,ez:_}=this,R=u(x*x),O=u(A*A),M=u(Bs*u(_*_)),q=u(d*R),F=x+A,et=u(u(F*F)-R-O),Q=q+O,ut=Q-M,yt=q-O,it=u(et*ut),lt=u(Q*yt),Et=u(et*yt),Bt=u(ut*Q);return new m(it,lt,Bt,Et)}add(d){h(d);let{a:x,d:A}=t,{ex:_,ey:R,ez:O,et:M}=this,{ex:q,ey:F,ez:et,et:Q}=d,ut=u(_*q),yt=u(R*F),it=u(M*A*Q),lt=u(O*et),Et=u((_+R)*(q+F)-ut-yt),Bt=lt-it,_e=lt+it,Co=u(yt-x*ut),Li=u(Et*Bt),Ci=u(_e*Co),Ui=u(Et*Co),Di=u(Bt*_e);return new m(Li,Ci,Di,Ui)}subtract(d){return this.add(d.negate())}wNAF(d){return U.wNAFCached(this,d,m.normalizeZ)}multiply(d){let x=d;At("scalar",x,mt,n);let{p:A,f:_}=this.wNAF(x);return m.normalizeZ([A,_])[0]}multiplyUnsafe(d,x=m.ZERO){let A=d;return At("scalar",A,Ut,n),A===Ut?D:this.is0()||A===mt?this:U.wNAFCachedUnsafe(this,A,m.normalizeZ,x)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return U.unsafeLadder(this,n).is0()}toAffine(d){return b(this,d)}clearCofactor(){let{h:d}=t;return d===mt?this:this.multiplyUnsafe(d)}static fromHex(d,x=!1){let{d:A,a:_}=t,R=e.BYTES;d=X("pointHex",d,R),Ct("zip215",x);let O=d.slice(),M=d[R-1];O[R-1]=M&-129;let q=ce(O),F=x?f:e.ORDER;At("pointHex.y",q,Ut,F);let et=u(q*q),Q=u(et-mt),ut=u(A*et-_),{isValid:yt,value:it}=p(Q,ut);if(!yt)throw new Error("Point.fromHex: invalid y coordinate");let lt=(it&mt)===mt,Et=(M&128)!==0;if(!x&&it===Ut&&Et)throw new Error("Point.fromHex: x=0 and x_0=1");return Et!==lt&&(it=u(-it)),m.fromAffine({x:it,y:q})}static fromPrivateKey(d){let{scalar:x}=L(d);return B.multiply(x)}toRawBytes(){let{x:d,y:x}=this.toAffine(),A=Te(x,e.BYTES);return A[A.length-1]|=d&mt?128:0,A}toHex(){return Qt(this.toRawBytes())}}m.BASE=new m(t.Gx,t.Gy,mt,u(t.Gx*t.Gy)),m.ZERO=new m(Ut,mt,mt,Ut);let{BASE:B,ZERO:D}=m,U=hr(m,a*8);function T(g){return z(g,n)}function P(g){return T(ce(g))}function L(g){let d=e.BYTES;g=X("private key",g,d);let x=X("hashed private key",s(g),2*d),A=w(x.slice(0,d)),_=x.slice(d,2*d),R=P(A);return{head:A,prefix:_,scalar:R}}function Z(g){let{head:d,prefix:x,scalar:A}=L(g),_=B.multiply(A),R=_.toRawBytes();return{head:d,prefix:x,scalar:A,point:_,pointBytes:R}}function H(g){return Z(g).pointBytes}function N(g=new Uint8Array,...d){let x=te(...d);return P(s(E(x,X("context",g),!!o)))}function nt(g,d,x={}){g=X("message",g),o&&(g=o(g));let{prefix:A,scalar:_,pointBytes:R}=Z(d),O=N(x.context,A,g),M=B.multiply(O).toRawBytes(),q=N(x.context,M,R,g),F=T(O+q*_);At("signature.s",F,Ut,n);let et=te(M,Te(F,e.BYTES));return X("result",et,e.BYTES*2)}let S=Gc;function I(g,d,x,A=S){let{context:_,zip215:R}=A,O=e.BYTES;g=X("signature",g,2*O),d=X("message",d),x=X("publicKey",x,O),R!==void 0&&Ct("zip215",R),o&&(d=o(d));let M=ce(g.slice(O,2*O)),q,F,et;try{q=m.fromHex(x,R),F=m.fromHex(g.slice(0,O),R),et=B.multiplyUnsafe(M)}catch{return!1}if(!R&&q.isSmallOrder())return!1;let Q=N(_,F.toRawBytes(),q.toRawBytes(),d);return F.add(q.multiplyUnsafe(Q)).subtract(et).clearCofactor().equals(m.ZERO)}return B._setWindowSize(8),{CURVE:t,getPublicKey:H,sign:nt,verify:I,ExtendedPoint:m,utils:{getExtendedPublicKey:Z,randomPrivateKey:()=>i(e.BYTES),precompute(g=8,d=m.BASE){return d._setWindowSize(g),d.multiply(BigInt(3)),d}}}}var Un=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Ts=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),dh=BigInt(0),Zc=BigInt(1),Ps=BigInt(2),ph=BigInt(3),$c=BigInt(5),Wc=BigInt(8);function Yc(r){let t=BigInt(10),e=BigInt(20),n=BigInt(40),o=BigInt(80),s=Un,a=r*r%s*r%s,c=Y(a,Ps,s)*a%s,f=Y(c,Zc,s)*r%s,u=Y(f,$c,s)*f%s,l=Y(u,t,s)*u%s,p=Y(l,e,s)*l%s,w=Y(p,n,s)*p%s,E=Y(w,o,s)*w%s,y=Y(E,o,s)*w%s,h=Y(y,t,s)*u%s;return{pow_p_5_8:Y(h,Ps,s)*r%s,b2:a}}function Xc(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}function Jc(r,t){let e=Un,n=z(t*t*t,e),o=z(n*n*t,e),s=Yc(r*o).pow_p_5_8,i=z(r*n*s,e),a=z(t*i*i,e),c=i,f=z(i*Ts,e),u=a===r,l=a===z(-r,e),p=a===z(-r*Ts,e);return u&&(i=c),(l||p)&&(i=f),bs(i,e)&&(i=z(-i,e)),{isValid:u||l,value:i}}var Ls=ee(Un,void 0,!0),Qc={a:Ls.create(BigInt(-1)),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Ls,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:Wc,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:yn,randomBytes:cr,adjustScalarBytes:Xc,uvRatio:Jc},Cs=Is(Qc);var pr=32;function Us(r,t,e){return Cs.verify(t,e instanceof Uint8Array?e:e.subarray(),r)}var mr=class{type="Ed25519";raw;constructor(t){this.raw=Dn(t,pr)}toMultihash(){return Tt.digest($t(this))}toCID(){return rt.createV1(114,this.toMultihash())}toString(){return $.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:at(this.raw,t.raw)}verify(t,e){return Us(this.raw,e,t)}};function _n(r){return r=Dn(r,pr),new mr(r)}function Dn(r,t){if(r=Uint8Array.from(r??[]),r.length!==t)throw new ot(`Key must be a Uint8Array of length ${t}, got ${r.length}`);return r}var eu=Math.pow(2,7),ru=Math.pow(2,14),nu=Math.pow(2,21),Kn=Math.pow(2,28),Rn=Math.pow(2,35),Nn=Math.pow(2,42),kn=Math.pow(2,49),V=128,ht=127;function wt(r){if(r<eu)return 1;if(r<ru)return 2;if(r<nu)return 3;if(r<Kn)return 4;if(r<Rn)return 5;if(r<Nn)return 6;if(r<kn)return 7;if(Number.MAX_SAFE_INTEGER!=null&&r>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function On(r,t,e=0){switch(wt(r)){case 8:t[e++]=r&255|V,r/=128;case 7:t[e++]=r&255|V,r/=128;case 6:t[e++]=r&255|V,r/=128;case 5:t[e++]=r&255|V,r/=128;case 4:t[e++]=r&255|V,r>>>=7;case 3:t[e++]=r&255|V,r>>>=7;case 2:t[e++]=r&255|V,r>>>=7;case 1:{t[e++]=r&255,r>>>=7;break}default:throw new Error("unreachable")}return t}function ou(r,t,e=0){switch(wt(r)){case 8:t.set(e++,r&255|V),r/=128;case 7:t.set(e++,r&255|V),r/=128;case 6:t.set(e++,r&255|V),r/=128;case 5:t.set(e++,r&255|V),r/=128;case 4:t.set(e++,r&255|V),r>>>=7;case 3:t.set(e++,r&255|V),r>>>=7;case 2:t.set(e++,r&255|V),r>>>=7;case 1:{t.set(e++,r&255),r>>>=7;break}default:throw new Error("unreachable")}return t}function Mn(r,t){let e=r[t],n=0;if(n+=e&ht,e<V||(e=r[t+1],n+=(e&ht)<<7,e<V)||(e=r[t+2],n+=(e&ht)<<14,e<V)||(e=r[t+3],n+=(e&ht)<<21,e<V)||(e=r[t+4],n+=(e&ht)*Kn,e<V)||(e=r[t+5],n+=(e&ht)*Rn,e<V)||(e=r[t+6],n+=(e&ht)*Nn,e<V)||(e=r[t+7],n+=(e&ht)*kn,e<V))return n;throw new RangeError("Could not decode varint")}function su(r,t){let e=r.get(t),n=0;if(n+=e&ht,e<V||(e=r.get(t+1),n+=(e&ht)<<7,e<V)||(e=r.get(t+2),n+=(e&ht)<<14,e<V)||(e=r.get(t+3),n+=(e&ht)<<21,e<V)||(e=r.get(t+4),n+=(e&ht)*Kn,e<V)||(e=r.get(t+5),n+=(e&ht)*Rn,e<V)||(e=r.get(t+6),n+=(e&ht)*Nn,e<V)||(e=r.get(t+7),n+=(e&ht)*kn,e<V))return n;throw new RangeError("Could not decode varint")}function Dt(r,t,e=0){return t==null&&(t=bt(wt(r))),t instanceof Uint8Array?On(r,t,e):ou(r,t,e)}function he(r,t=0){return r instanceof Uint8Array?Mn(r,t):su(r,t)}var Hn=new Float32Array([-0]),re=new Uint8Array(Hn.buffer);function _s(r,t,e){Hn[0]=r,t[e]=re[0],t[e+1]=re[1],t[e+2]=re[2],t[e+3]=re[3]}function Ks(r,t){return re[0]=r[t],re[1]=r[t+1],re[2]=r[t+2],re[3]=r[t+3],Hn[0]}var Vn=new Float64Array([-0]),dt=new Uint8Array(Vn.buffer);function Rs(r,t,e){Vn[0]=r,t[e]=dt[0],t[e+1]=dt[1],t[e+2]=dt[2],t[e+3]=dt[3],t[e+4]=dt[4],t[e+5]=dt[5],t[e+6]=dt[6],t[e+7]=dt[7]}function Ns(r,t){return dt[0]=r[t],dt[1]=r[t+1],dt[2]=r[t+2],dt[3]=r[t+3],dt[4]=r[t+4],dt[5]=r[t+5],dt[6]=r[t+6],dt[7]=r[t+7],Vn[0]}var iu=BigInt(Number.MAX_SAFE_INTEGER),au=BigInt(Number.MIN_SAFE_INTEGER),vt=class r{lo;hi;constructor(t,e){this.lo=t|0,this.hi=e|0}toNumber(t=!1){if(!t&&this.hi>>>31>0){let e=~this.lo+1>>>0,n=~this.hi>>>0;return e===0&&(n=n+1>>>0),-(e+n*4294967296)}return this.lo+this.hi*4294967296}toBigInt(t=!1){if(t)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let e=~this.lo+1>>>0,n=~this.hi>>>0;return e===0&&(n=n+1>>>0),-(BigInt(e)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(t=!1){return this.toBigInt(t).toString()}zzEncode(){let t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this}zzDecode(){let t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this}length(){let t=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?e===0?t<16384?t<128?1:2:t<2097152?3:4:e<16384?e<128?5:6:e<2097152?7:8:n<128?9:10}static fromBigInt(t){if(t===0n)return de;if(t<iu&&t>au)return this.fromNumber(Number(t));let e=t<0n;e&&(t=-t);let n=t>>32n,o=t-(n<<32n);return e&&(n=~n|0n,o=~o|0n,++o>ks&&(o=0n,++n>ks&&(n=0n))),new r(Number(o),Number(n))}static fromNumber(t){if(t===0)return de;let e=t<0;e&&(t=-t);let n=t>>>0,o=(t-n)/4294967296>>>0;return e&&(o=~o>>>0,n=~n>>>0,++n>4294967295&&(n=0,++o>4294967295&&(o=0))),new r(n,o)}static from(t){return typeof t=="number"?r.fromNumber(t):typeof t=="bigint"?r.fromBigInt(t):typeof t=="string"?r.fromBigInt(BigInt(t)):t.low!=null||t.high!=null?new r(t.low>>>0,t.high>>>0):de}},de=new vt(0,0);de.toBigInt=function(){return 0n};de.zzEncode=de.zzDecode=function(){return this};de.length=function(){return 1};var ks=4294967296n;function Os(r){let t=0,e=0;for(let n=0;n<r.length;++n)e=r.charCodeAt(n),e<128?t+=1:e<2048?t+=2:(e&64512)===55296&&(r.charCodeAt(n+1)&64512)===56320?(++n,t+=4):t+=3;return t}function Ms(r,t,e){if(e-t<1)return"";let o,s=[],i=0,a;for(;t<e;)a=r[t++],a<128?s[i++]=a:a>191&&a<224?s[i++]=(a&31)<<6|r[t++]&63:a>239&&a<365?(a=((a&7)<<18|(r[t++]&63)<<12|(r[t++]&63)<<6|r[t++]&63)-65536,s[i++]=55296+(a>>10),s[i++]=56320+(a&1023)):s[i++]=(a&15)<<12|(r[t++]&63)<<6|r[t++]&63,i>8191&&((o??(o=[])).push(String.fromCharCode.apply(String,s)),i=0);return o!=null?(i>0&&o.push(String.fromCharCode.apply(String,s.slice(0,i))),o.join("")):String.fromCharCode.apply(String,s.slice(0,i))}function Fn(r,t,e){let n=e,o,s;for(let i=0;i<r.length;++i)o=r.charCodeAt(i),o<128?t[e++]=o:o<2048?(t[e++]=o>>6|192,t[e++]=o&63|128):(o&64512)===55296&&((s=r.charCodeAt(i+1))&64512)===56320?(o=65536+((o&1023)<<10)+(s&1023),++i,t[e++]=o>>18|240,t[e++]=o>>12&63|128,t[e++]=o>>6&63|128,t[e++]=o&63|128):(t[e++]=o>>12|224,t[e++]=o>>6&63|128,t[e++]=o&63|128);return e-n}function Lt(r,t){return RangeError(`index out of range: ${r.pos} + ${t??1} > ${r.len}`)}function yr(r,t){return(r[t-4]|r[t-3]<<8|r[t-2]<<16|r[t-1]<<24)>>>0}var zn=class{buf;pos;len;_slice=Uint8Array.prototype.subarray;constructor(t){this.buf=t,this.pos=0,this.len=t.length}uint32(){let t=4294967295;if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,Lt(this,10);return t}int32(){return this.uint32()|0}sint32(){let t=this.uint32();return t>>>1^-(t&1)|0}bool(){return this.uint32()!==0}fixed32(){if(this.pos+4>this.len)throw Lt(this,4);return yr(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw Lt(this,4);return yr(this.buf,this.pos+=4)|0}float(){if(this.pos+4>this.len)throw Lt(this,4);let t=Ks(this.buf,this.pos);return this.pos+=4,t}double(){if(this.pos+8>this.len)throw Lt(this,4);let t=Ns(this.buf,this.pos);return this.pos+=8,t}bytes(){let t=this.uint32(),e=this.pos,n=this.pos+t;if(n>this.len)throw Lt(this,t);return this.pos+=t,e===n?new Uint8Array(0):this.buf.subarray(e,n)}string(){let t=this.bytes();return Ms(t,0,t.length)}skip(t){if(typeof t=="number"){if(this.pos+t>this.len)throw Lt(this,t);this.pos+=t}else do if(this.pos>=this.len)throw Lt(this);while((this.buf[this.pos++]&128)!==0);return this}skipType(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${t} at offset ${this.pos}`)}return this}readLongVarint(){let t=new vt(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Lt(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw Lt(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw Lt(this,8);let t=yr(this.buf,this.pos+=4),e=yr(this.buf,this.pos+=4);return new vt(t,e)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){let t=Mn(this.buf,this.pos);return this.pos+=wt(t),t}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}};function Gn(r){return new zn(r instanceof Uint8Array?r:r.subarray())}function qt(r,t,e){let n=Gn(r);return t.decode(n,void 0,e)}function jn(r){let t=r??8192,e=t>>>1,n,o=t;return function(i){if(i<1||i>e)return bt(i);o+i>t&&(n=bt(t),o=0);let a=n.subarray(o,o+=i);return(o&7)!==0&&(o=(o|7)+1),a}}var pe=class{fn;len;next;val;constructor(t,e,n){this.fn=t,this.len=e,this.next=void 0,this.val=n}};function Zn(){}var Wn=class{head;tail;len;next;constructor(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}},cu=jn();function uu(r){return globalThis.Buffer!=null?bt(r):cu(r)}var Ze=class{len;head;tail;states;constructor(){this.len=0,this.head=new pe(Zn,0,0),this.tail=this.head,this.states=null}_push(t,e,n){return this.tail=this.tail.next=new pe(t,e,n),this.len+=e,this}uint32(t){return this.len+=(this.tail=this.tail.next=new Yn((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this}int32(t){return t<0?this._push(gr,10,vt.fromNumber(t)):this.uint32(t)}sint32(t){return this.uint32((t<<1^t>>31)>>>0)}uint64(t){let e=vt.fromBigInt(t);return this._push(gr,e.length(),e)}uint64Number(t){return this._push(On,wt(t),t)}uint64String(t){return this.uint64(BigInt(t))}int64(t){return this.uint64(t)}int64Number(t){return this.uint64Number(t)}int64String(t){return this.uint64String(t)}sint64(t){let e=vt.fromBigInt(t).zzEncode();return this._push(gr,e.length(),e)}sint64Number(t){let e=vt.fromNumber(t).zzEncode();return this._push(gr,e.length(),e)}sint64String(t){return this.sint64(BigInt(t))}bool(t){return this._push($n,1,t?1:0)}fixed32(t){return this._push(je,4,t>>>0)}sfixed32(t){return this.fixed32(t)}fixed64(t){let e=vt.fromBigInt(t);return this._push(je,4,e.lo)._push(je,4,e.hi)}fixed64Number(t){let e=vt.fromNumber(t);return this._push(je,4,e.lo)._push(je,4,e.hi)}fixed64String(t){return this.fixed64(BigInt(t))}sfixed64(t){return this.fixed64(t)}sfixed64Number(t){return this.fixed64Number(t)}sfixed64String(t){return this.fixed64String(t)}float(t){return this._push(_s,4,t)}double(t){return this._push(Rs,8,t)}bytes(t){let e=t.length>>>0;return e===0?this._push($n,1,0):this.uint32(e)._push(lu,e,t)}string(t){let e=Os(t);return e!==0?this.uint32(e)._push(Fn,e,t):this._push($n,1,0)}fork(){return this.states=new Wn(this),this.head=this.tail=new pe(Zn,0,0),this.len=0,this}reset(){return this.states!=null?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new pe(Zn,0,0),this.len=0),this}ldelim(){let t=this.head,e=this.tail,n=this.len;return this.reset().uint32(n),n!==0&&(this.tail.next=t.next,this.tail=e,this.len+=n),this}finish(){let t=this.head.next,e=uu(this.len),n=0;for(;t!=null;)t.fn(t.val,e,n),n+=t.len,t=t.next;return e}};function $n(r,t,e){t[e]=r&255}function fu(r,t,e){for(;r>127;)t[e++]=r&127|128,r>>>=7;t[e]=r}var Yn=class extends pe{next;constructor(t,e){super(fu,t,e),this.next=void 0}};function gr(r,t,e){for(;r.hi!==0;)t[e++]=r.lo&127|128,r.lo=(r.lo>>>7|r.hi<<25)>>>0,r.hi>>>=7;for(;r.lo>127;)t[e++]=r.lo&127|128,r.lo=r.lo>>>7;t[e++]=r.lo}function je(r,t,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24}function lu(r,t,e){t.set(r,e)}globalThis.Buffer!=null&&(Ze.prototype.bytes=function(r){let t=r.length>>>0;return this.uint32(t),t>0&&this._push(hu,t,r),this},Ze.prototype.string=function(r){let t=globalThis.Buffer.byteLength(r);return this.uint32(t),t>0&&this._push(du,t,r),this});function hu(r,t,e){t.set(r,e)}function du(r,t,e){r.length<40?Fn(r,t,e):t.utf8Write!=null?t.utf8Write(r,e):t.set(G(r),e)}function Xn(){return new Ze}function Ht(r,t){let e=Xn();return t.encode(r,e,{lengthDelimited:!1}),e.finish()}var Le;(function(r){r[r.VARINT=0]="VARINT",r[r.BIT64=1]="BIT64",r[r.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",r[r.START_GROUP=3]="START_GROUP",r[r.END_GROUP=4]="END_GROUP",r[r.BIT32=5]="BIT32"})(Le||(Le={}));function br(r,t,e,n){return{name:r,type:t,encode:e,decode:n}}function Jn(r){function t(o){if(r[o.toString()]==null)throw new Error("Invalid enum value");return r[o]}let e=function(s,i){let a=t(s);i.int32(a)},n=function(s){let i=s.int32();return t(i)};return br("enum",Le.VARINT,e,n)}function Vt(r,t){return br("message",Le.LENGTH_DELIMITED,r,t)}var xr=class extends Error{code="ERR_MAX_LENGTH";name="MaxLengthError"};var tt;(function(r){r.RSA="RSA",r.Ed25519="Ed25519",r.secp256k1="secp256k1",r.ECDSA="ECDSA"})(tt||(tt={}));var Qn;(function(r){r[r.RSA=0]="RSA",r[r.Ed25519=1]="Ed25519",r[r.secp256k1=2]="secp256k1",r[r.ECDSA=3]="ECDSA"})(Qn||(Qn={}));(function(r){r.codec=()=>Jn(Qn)})(tt||(tt={}));var _t;(function(r){let t;r.codec=()=>(t==null&&(t=Vt((e,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),e.Type!=null&&(n.uint32(8),tt.codec().encode(e.Type,n)),e.Data!=null&&(n.uint32(18),n.bytes(e.Data)),o.lengthDelimited!==!1&&n.ldelim()},(e,n,o={})=>{let s={},i=n==null?e.len:e.pos+n;for(;e.pos<i;){let a=e.uint32();switch(a>>>3){case 1:{s.Type=tt.codec().decode(e);break}case 2:{s.Data=e.bytes();break}default:{e.skipType(a&7);break}}}return s})),t),r.encode=e=>Ht(e,r.codec()),r.decode=(e,n)=>qt(e,r.codec(),n)})(_t||(_t={}));var to;(function(r){let t;r.codec=()=>(t==null&&(t=Vt((e,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),e.Type!=null&&(n.uint32(8),tt.codec().encode(e.Type,n)),e.Data!=null&&(n.uint32(18),n.bytes(e.Data)),o.lengthDelimited!==!1&&n.ldelim()},(e,n,o={})=>{let s={},i=n==null?e.len:e.pos+n;for(;e.pos<i;){let a=e.uint32();switch(a>>>3){case 1:{s.Type=tt.codec().decode(e);break}case 2:{s.Data=e.bytes();break}default:{e.skipType(a&7);break}}}return s})),t),r.encode=e=>Ht(e,r.codec()),r.decode=(e,n)=>qt(e,r.codec(),n)})(to||(to={}));var $e=class extends Error{constructor(t="An error occurred while verifying a message"){super(t),this.name="VerificationError"}},wr=class extends Error{constructor(t="Missing Web Crypto API"){super(t),this.name="WebCryptoMissingError"}};var Vs={get(r=globalThis){let t=r.crypto;if(t?.subtle==null)throw new wr("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api");return t}};var ne=Vs;var Ye={};gt(Ye,{MAX_RSA_KEY_SIZE:()=>eo,generateRSAKeyPair:()=>js,jwkToJWKKeyPair:()=>Zs,jwkToPkcs1:()=>gu,jwkToPkix:()=>so,jwkToRSAPrivateKey:()=>uo,pkcs1MessageToJwk:()=>no,pkcs1MessageToRSAPrivateKey:()=>io,pkcs1ToJwk:()=>yu,pkcs1ToRSAPrivateKey:()=>Gs,pkixMessageToJwk:()=>oo,pkixMessageToRSAPublicKey:()=>co,pkixToJwk:()=>bu,pkixToRSAPublicKey:()=>ao});var Ce=class{type="RSA";jwk;_raw;_multihash;constructor(t,e){this.jwk=t,this._multihash=e}get raw(){return this._raw==null&&(this._raw=Ye.jwkToPkix(this.jwk)),this._raw}toMultihash(){return this._multihash}toCID(){return rt.createV1(114,this._multihash)}toString(){return $.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:at(this.raw,t.raw)}verify(t,e){return zs(this.jwk,e,t)}},We=class{type="RSA";jwk;_raw;publicKey;constructor(t,e){this.jwk=t,this.publicKey=e}get raw(){return this._raw==null&&(this._raw=Ye.jwkToPkcs1(this.jwk)),this._raw}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:at(this.raw,t.raw)}sign(t){return Fs(this.jwk,t)}};var eo=8192,ro=18,pu=1062,mu=Uint8Array.from([48,13,6,9,42,134,72,134,247,13,1,1,1,5,0]);function yu(r){let t=Nt(r);return no(t)}function no(r){return{n:k(r[1],"base64url"),e:k(r[2],"base64url"),d:k(r[3],"base64url"),p:k(r[4],"base64url"),q:k(r[5],"base64url"),dp:k(r[6],"base64url"),dq:k(r[7],"base64url"),qi:k(r[8],"base64url"),kty:"RSA"}}function gu(r){if(r.n==null||r.e==null||r.d==null||r.p==null||r.q==null||r.dp==null||r.dq==null||r.qi==null)throw new ot("JWK was missing components");return Zt([xt(Uint8Array.from([0])),xt(G(r.n,"base64url")),xt(G(r.e,"base64url")),xt(G(r.d,"base64url")),xt(G(r.p,"base64url")),xt(G(r.q,"base64url")),xt(G(r.dp,"base64url")),xt(G(r.dq,"base64url")),xt(G(r.qi,"base64url"))]).subarray()}function bu(r){let t=Nt(r,{offset:0});return oo(t)}function oo(r){let t=Nt(r[1],{offset:0});return{kty:"RSA",n:k(t[0],"base64url"),e:k(t[1],"base64url")}}function so(r){if(r.n==null||r.e==null)throw new ot("JWK was missing components");return Zt([mu,sr(Zt([xt(G(r.n,"base64url")),xt(G(r.e,"base64url"))]))]).subarray()}function Gs(r){let t=Nt(r);return io(t)}function io(r){let t=no(r);return uo(t)}function ao(r,t){if(r.byteLength>=pu)throw new ye("Key size is too large");let e=Nt(r,{offset:0});return co(e,r,t)}function co(r,t,e){let n=oo(r);if(e==null){let o=ie(_t.encode({Type:tt.RSA,Data:t}));e=It(ro,o)}return new Ce(n,e)}function uo(r){if(Ws(r)>eo)throw new ot("Key size is too large");let t=Zs(r),e=ie(_t.encode({Type:tt.RSA,Data:so(t.publicKey)})),n=It(ro,e);return new We(t.privateKey,new Ce(t.publicKey,n))}async function js(r){if(r>eo)throw new ot("Key size is too large");let t=await $s(r),e=ie(_t.encode({Type:tt.RSA,Data:so(t.publicKey)})),n=It(ro,e);return new We(t.privateKey,new Ce(t.publicKey,n))}function Zs(r){if(r==null)throw new ot("Missing key parameter");return{privateKey:r,publicKey:{kty:r.kty,n:r.n,e:r.e}}}async function $s(r){let t=await ne.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),e=await xu(t);return{privateKey:e[0],publicKey:e[1]}}async function Fs(r,t){let e=await ne.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await ne.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},e,t instanceof Uint8Array?t:t.subarray());return new Uint8Array(n,0,n.byteLength)}async function zs(r,t,e){let n=await ne.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return ne.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,e instanceof Uint8Array?e:e.subarray())}async function xu(r){if(r.privateKey==null||r.publicKey==null)throw new ot("Private and public key are required");return Promise.all([ne.get().subtle.exportKey("jwk",r.privateKey),ne.get().subtle.exportKey("jwk",r.publicKey)])}function Ws(r){if(r.kty!=="RSA")throw new ot("invalid key type");if(r.n==null)throw new ot("invalid key modulus");return G(r.n,"base64url").length*8}var Er=class extends Be{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,os(t);let n=Ve(e);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,s=new Uint8Array(o);s.set(n.length>o?t.create().update(n).digest():n);for(let i=0;i<s.length;i++)s[i]^=54;this.iHash.update(s),this.oHash=t.create();for(let i=0;i<s.length;i++)s[i]^=106;this.oHash.update(s),s.fill(0)}update(t){return ve(this),this.iHash.update(t),this}digestInto(t){ve(this),Ae(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:e,iHash:n,finished:o,destroyed:s,blockLen:i,outputLen:a}=this;return t=t,t.finished=o,t.destroyed=s,t.blockLen=i,t.outputLen=a,t.oHash=e._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},fo=(r,t,e)=>new Er(r,t).update(e).digest();fo.create=(r,t)=>new Er(r,t);function Ys(r){r.lowS!==void 0&&Ct("lowS",r.lowS),r.prehash!==void 0&&Ct("prehash",r.prehash)}function wu(r){let t=Ge(r);Mt(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:e,Fp:n,a:o}=t;if(e){if(!n.eql(o,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof e!="object"||typeof e.beta!="bigint"||typeof e.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...t})}var lo=class extends Error{constructor(t=""){super(t)}},Ft={Err:lo,_tlv:{encode:(r,t)=>{let{Err:e}=Ft;if(r<0||r>256)throw new e("tlv.encode: wrong tag");if(t.length&1)throw new e("tlv.encode: unpadded data");let n=t.length/2,o=Fe(n);if(o.length/2&128)throw new e("tlv.encode: long form length too big");let s=n>127?Fe(o.length/2|128):"";return Fe(r)+s+o+t},decode(r,t){let{Err:e}=Ft,n=0;if(r<0||r>256)throw new e("tlv.encode: wrong tag");if(t.length<2||t[n++]!==r)throw new e("tlv.decode: wrong tlv");let o=t[n++],s=!!(o&128),i=0;if(!s)i=o;else{let c=o&127;if(!c)throw new e("tlv.decode(long): indefinite length not supported");if(c>4)throw new e("tlv.decode(long): byte length is too big");let f=t.subarray(n,n+c);if(f.length!==c)throw new e("tlv.decode: length bytes not complete");if(f[0]===0)throw new e("tlv.decode(long): zero leftmost byte");for(let u of f)i=i<<8|u;if(n+=c,i<128)throw new e("tlv.decode(long): not minimal encoding")}let a=t.subarray(n,n+i);if(a.length!==i)throw new e("tlv.decode: wrong value length");return{v:a,l:t.subarray(n+i)}}},_int:{encode(r){let{Err:t}=Ft;if(r<zt)throw new t("integer: negative integers are not allowed");let e=Fe(r);if(Number.parseInt(e[0],16)&8&&(e="00"+e),e.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return e},decode(r){let{Err:t}=Ft;if(r[0]&128)throw new t("invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return Ot(r)}},toSig(r){let{Err:t,_int:e,_tlv:n}=Ft,o=X("signature",r),{v:s,l:i}=n.decode(48,o);if(i.length)throw new t("invalid signature: left bytes after parsing");let{v:a,l:c}=n.decode(2,s),{v:f,l:u}=n.decode(2,c);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:e.decode(a),s:e.decode(f)}},hexFromSig(r){let{_tlv:t,_int:e}=Ft,n=t.encode(2,e.encode(r.r)),o=t.encode(2,e.encode(r.s)),s=n+o;return t.encode(48,s)}},zt=BigInt(0),ct=BigInt(1),qd=BigInt(2),Xs=BigInt(3),Hd=BigInt(4);function Eu(r){let t=wu(r),{Fp:e}=t,n=ee(t.n,t.nBitLength),o=t.toBytes||((y,h,b)=>{let v=h.toAffine();return te(Uint8Array.from([4]),e.toBytes(v.x),e.toBytes(v.y))}),s=t.fromBytes||(y=>{let h=y.subarray(1),b=e.fromBytes(h.subarray(0,e.BYTES)),v=e.fromBytes(h.subarray(e.BYTES,2*e.BYTES));return{x:b,y:v}});function i(y){let{a:h,b}=t,v=e.sqr(y),m=e.mul(v,y);return e.add(e.add(m,e.mul(y,h)),b)}if(!e.eql(e.sqr(t.Gy),i(t.Gx)))throw new Error("bad generator point: equation left != right");function a(y){return fr(y,ct,t.n)}function c(y){let{allowedPrivateKeyLengths:h,nByteLength:b,wrapPrivateKey:v,n:m}=t;if(h&&typeof y!="bigint"){if(ae(y)&&(y=Qt(y)),typeof y!="string"||!h.includes(y.length))throw new Error("invalid private key");y=y.padStart(b*2,"0")}let B;try{B=typeof y=="bigint"?y:Ot(X("private key",y,b))}catch{throw new Error("invalid private key, expected hex or "+b+" bytes, got "+typeof y)}return v&&(B=z(B,m)),At("private key",B,ct,m),B}function f(y){if(!(y instanceof p))throw new Error("ProjectivePoint expected")}let u=Pe((y,h)=>{let{px:b,py:v,pz:m}=y;if(e.eql(m,e.ONE))return{x:b,y:v};let B=y.is0();h==null&&(h=B?e.ONE:e.inv(m));let D=e.mul(b,h),U=e.mul(v,h),T=e.mul(m,h);if(B)return{x:e.ZERO,y:e.ZERO};if(!e.eql(T,e.ONE))throw new Error("invZ was invalid");return{x:D,y:U}}),l=Pe(y=>{if(y.is0()){if(t.allowInfinityPoint&&!e.is0(y.py))return;throw new Error("bad point: ZERO")}let{x:h,y:b}=y.toAffine();if(!e.isValid(h)||!e.isValid(b))throw new Error("bad point: x or y not FE");let v=e.sqr(b),m=i(h);if(!e.eql(v,m))throw new Error("bad point: equation left != right");if(!y.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class p{constructor(h,b,v){if(h==null||!e.isValid(h))throw new Error("x required");if(b==null||!e.isValid(b))throw new Error("y required");if(v==null||!e.isValid(v))throw new Error("z required");this.px=h,this.py=b,this.pz=v,Object.freeze(this)}static fromAffine(h){let{x:b,y:v}=h||{};if(!h||!e.isValid(b)||!e.isValid(v))throw new Error("invalid affine point");if(h instanceof p)throw new Error("projective point not allowed");let m=B=>e.eql(B,e.ZERO);return m(b)&&m(v)?p.ZERO:new p(b,v,e.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(h){let b=e.invertBatch(h.map(v=>v.pz));return h.map((v,m)=>v.toAffine(b[m])).map(p.fromAffine)}static fromHex(h){let b=p.fromAffine(s(X("pointHex",h)));return b.assertValidity(),b}static fromPrivateKey(h){return p.BASE.multiply(c(h))}static msm(h,b){return dr(p,n,h,b)}_setWindowSize(h){E.setWindowSize(this,h)}assertValidity(){l(this)}hasEvenY(){let{y:h}=this.toAffine();if(e.isOdd)return!e.isOdd(h);throw new Error("Field doesn't support isOdd")}equals(h){f(h);let{px:b,py:v,pz:m}=this,{px:B,py:D,pz:U}=h,T=e.eql(e.mul(b,U),e.mul(B,m)),P=e.eql(e.mul(v,U),e.mul(D,m));return T&&P}negate(){return new p(this.px,e.neg(this.py),this.pz)}double(){let{a:h,b}=t,v=e.mul(b,Xs),{px:m,py:B,pz:D}=this,U=e.ZERO,T=e.ZERO,P=e.ZERO,L=e.mul(m,m),Z=e.mul(B,B),H=e.mul(D,D),N=e.mul(m,B);return N=e.add(N,N),P=e.mul(m,D),P=e.add(P,P),U=e.mul(h,P),T=e.mul(v,H),T=e.add(U,T),U=e.sub(Z,T),T=e.add(Z,T),T=e.mul(U,T),U=e.mul(N,U),P=e.mul(v,P),H=e.mul(h,H),N=e.sub(L,H),N=e.mul(h,N),N=e.add(N,P),P=e.add(L,L),L=e.add(P,L),L=e.add(L,H),L=e.mul(L,N),T=e.add(T,L),H=e.mul(B,D),H=e.add(H,H),L=e.mul(H,N),U=e.sub(U,L),P=e.mul(H,Z),P=e.add(P,P),P=e.add(P,P),new p(U,T,P)}add(h){f(h);let{px:b,py:v,pz:m}=this,{px:B,py:D,pz:U}=h,T=e.ZERO,P=e.ZERO,L=e.ZERO,Z=t.a,H=e.mul(t.b,Xs),N=e.mul(b,B),nt=e.mul(v,D),S=e.mul(m,U),I=e.add(b,v),C=e.add(B,D);I=e.mul(I,C),C=e.add(N,nt),I=e.sub(I,C),C=e.add(b,m);let g=e.add(B,U);return C=e.mul(C,g),g=e.add(N,S),C=e.sub(C,g),g=e.add(v,m),T=e.add(D,U),g=e.mul(g,T),T=e.add(nt,S),g=e.sub(g,T),L=e.mul(Z,C),T=e.mul(H,S),L=e.add(T,L),T=e.sub(nt,L),L=e.add(nt,L),P=e.mul(T,L),nt=e.add(N,N),nt=e.add(nt,N),S=e.mul(Z,S),C=e.mul(H,C),nt=e.add(nt,S),S=e.sub(N,S),S=e.mul(Z,S),C=e.add(C,S),N=e.mul(nt,C),P=e.add(P,N),N=e.mul(g,C),T=e.mul(I,T),T=e.sub(T,N),N=e.mul(I,nt),L=e.mul(g,L),L=e.add(L,N),new p(T,P,L)}subtract(h){return this.add(h.negate())}is0(){return this.equals(p.ZERO)}wNAF(h){return E.wNAFCached(this,h,p.normalizeZ)}multiplyUnsafe(h){let{endo:b,n:v}=t;At("scalar",h,zt,v);let m=p.ZERO;if(h===zt)return m;if(this.is0()||h===ct)return this;if(!b||E.hasPrecomputes(this))return E.wNAFCachedUnsafe(this,h,p.normalizeZ);let{k1neg:B,k1:D,k2neg:U,k2:T}=b.splitScalar(h),P=m,L=m,Z=this;for(;D>zt||T>zt;)D&ct&&(P=P.add(Z)),T&ct&&(L=L.add(Z)),Z=Z.double(),D>>=ct,T>>=ct;return B&&(P=P.negate()),U&&(L=L.negate()),L=new p(e.mul(L.px,b.beta),L.py,L.pz),P.add(L)}multiply(h){let{endo:b,n:v}=t;At("scalar",h,ct,v);let m,B;if(b){let{k1neg:D,k1:U,k2neg:T,k2:P}=b.splitScalar(h),{p:L,f:Z}=this.wNAF(U),{p:H,f:N}=this.wNAF(P);L=E.constTimeNegate(D,L),H=E.constTimeNegate(T,H),H=new p(e.mul(H.px,b.beta),H.py,H.pz),m=L.add(H),B=Z.add(N)}else{let{p:D,f:U}=this.wNAF(h);m=D,B=U}return p.normalizeZ([m,B])[0]}multiplyAndAddUnsafe(h,b,v){let m=p.BASE,B=(U,T)=>T===zt||T===ct||!U.equals(m)?U.multiplyUnsafe(T):U.multiply(T),D=B(this,b).add(B(h,v));return D.is0()?void 0:D}toAffine(h){return u(this,h)}isTorsionFree(){let{h,isTorsionFree:b}=t;if(h===ct)return!0;if(b)return b(p,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h,clearCofactor:b}=t;return h===ct?this:b?b(p,this):this.multiplyUnsafe(t.h)}toRawBytes(h=!0){return Ct("isCompressed",h),this.assertValidity(),o(p,this,h)}toHex(h=!0){return Ct("isCompressed",h),Qt(this.toRawBytes(h))}}p.BASE=new p(t.Gx,t.Gy,e.ONE),p.ZERO=new p(e.ZERO,e.ONE,e.ZERO);let w=t.nBitLength,E=hr(p,t.endo?Math.ceil(w/2):w);return{CURVE:t,ProjectivePoint:p,normPrivateKeyToScalar:c,weierstrassEquation:i,isWithinCurveOrder:a}}function Su(r){let t=Ge(r);return Mt(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function Js(r){let t=Su(r),{Fp:e,n}=t,o=e.BYTES+1,s=2*e.BYTES+1;function i(S){return z(S,n)}function a(S){return lr(S,n)}let{ProjectivePoint:c,normPrivateKeyToScalar:f,weierstrassEquation:u,isWithinCurveOrder:l}=Eu({...t,toBytes(S,I,C){let g=I.toAffine(),d=e.toBytes(g.x),x=te;return Ct("isCompressed",C),C?x(Uint8Array.from([I.hasEvenY()?2:3]),d):x(Uint8Array.from([4]),d,e.toBytes(g.y))},fromBytes(S){let I=S.length,C=S[0],g=S.subarray(1);if(I===o&&(C===2||C===3)){let d=Ot(g);if(!fr(d,ct,e.ORDER))throw new Error("Point is not on curve");let x=u(d),A;try{A=e.sqrt(x)}catch(O){let M=O instanceof Error?": "+O.message:"";throw new Error("Point is not on curve"+M)}let _=(A&ct)===ct;return(C&1)===1!==_&&(A=e.neg(A)),{x:d,y:A}}else if(I===s&&C===4){let d=e.fromBytes(g.subarray(0,e.BYTES)),x=e.fromBytes(g.subarray(e.BYTES,2*e.BYTES));return{x:d,y:x}}else{let d=o,x=s;throw new Error("invalid Point, expected length of "+d+", or uncompressed "+x+", got "+I)}}}),p=S=>Qt(ue(S,t.nByteLength));function w(S){let I=n>>ct;return S>I}function E(S){return w(S)?i(-S):S}let y=(S,I,C)=>Ot(S.slice(I,C));class h{constructor(I,C,g){At("r",I,ct,n),At("s",C,ct,n),this.r=I,this.s=C,g!=null&&(this.recovery=g),Object.freeze(this)}static fromCompact(I){let C=t.nByteLength;return I=X("compactSignature",I,C*2),new h(y(I,0,C),y(I,C,2*C))}static fromDER(I){let{r:C,s:g}=Ft.toSig(X("DER",I));return new h(C,g)}assertValidity(){}addRecoveryBit(I){return new h(this.r,this.s,I)}recoverPublicKey(I){let{r:C,s:g,recovery:d}=this,x=U(X("msgHash",I));if(d==null||![0,1,2,3].includes(d))throw new Error("recovery id invalid");let A=d===2||d===3?C+t.n:C;if(A>=e.ORDER)throw new Error("recovery id 2 or 3 invalid");let _=(d&1)===0?"02":"03",R=c.fromHex(_+p(A)),O=a(A),M=i(-x*O),q=i(g*O),F=c.BASE.multiplyAndAddUnsafe(R,M,q);if(!F)throw new Error("point at infinify");return F.assertValidity(),F}hasHighS(){return w(this.s)}normalizeS(){return this.hasHighS()?new h(this.r,i(-this.s),this.recovery):this}toDERRawBytes(){return ze(this.toDERHex())}toDERHex(){return Ft.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return ze(this.toCompactHex())}toCompactHex(){return p(this.r)+p(this.s)}}let b={isValidPrivateKey(S){try{return f(S),!0}catch{return!1}},normPrivateKeyToScalar:f,randomPrivateKey:()=>{let S=Bn(t.n);return ws(t.randomBytes(S),t.n)},precompute(S=8,I=c.BASE){return I._setWindowSize(S),I.multiply(BigInt(3)),I}};function v(S,I=!0){return c.fromPrivateKey(S).toRawBytes(I)}function m(S){let I=ae(S),C=typeof S=="string",g=(I||C)&&S.length;return I?g===o||g===s:C?g===2*o||g===2*s:S instanceof c}function B(S,I,C=!0){if(m(S))throw new Error("first arg must be private key");if(!m(I))throw new Error("second arg must be public key");return c.fromHex(I).multiply(f(S)).toRawBytes(C)}let D=t.bits2int||function(S){if(S.length>8192)throw new Error("input is too large");let I=Ot(S),C=S.length*8-t.nBitLength;return C>0?I>>BigInt(C):I},U=t.bits2int_modN||function(S){return i(D(S))},T=fe(t.nBitLength);function P(S){return At("num < 2^"+t.nBitLength,S,zt,T),ue(S,t.nByteLength)}function L(S,I,C=Z){if(["recovered","canonical"].some(Q=>Q in C))throw new Error("sign() legacy options not supported");let{hash:g,randomBytes:d}=t,{lowS:x,prehash:A,extraEntropy:_}=C;x==null&&(x=!0),S=X("msgHash",S),Ys(C),A&&(S=X("prehashed msgHash",g(S)));let R=U(S),O=f(I),M=[P(O),P(R)];if(_!=null&&_!==!1){let Q=_===!0?d(e.BYTES):_;M.push(X("extraEntropy",Q))}let q=te(...M),F=R;function et(Q){let ut=D(Q);if(!l(ut))return;let yt=a(ut),it=c.BASE.multiply(ut).toAffine(),lt=i(it.x);if(lt===zt)return;let Et=i(yt*i(F+lt*O));if(Et===zt)return;let Bt=(it.x===lt?0:2)|Number(it.y&ct),_e=Et;return x&&w(Et)&&(_e=E(Et),Bt^=1),new h(lt,_e,Bt)}return{seed:q,k2sig:et}}let Z={lowS:t.lowS,prehash:!1},H={lowS:t.lowS,prehash:!1};function N(S,I,C=Z){let{seed:g,k2sig:d}=L(S,I,C),x=t;return ms(x.hash.outputLen,x.nByteLength,x.hmac)(g,d)}c.BASE._setWindowSize(8);function nt(S,I,C,g=H){let d=S;I=X("msgHash",I),C=X("publicKey",C);let{lowS:x,prehash:A,format:_}=g;if(Ys(g),"strict"in g)throw new Error("options.strict was renamed to lowS");if(_!==void 0&&_!=="compact"&&_!=="der")throw new Error("format must be compact or der");let R=typeof d=="string"||ae(d),O=!R&&!_&&typeof d=="object"&&d!==null&&typeof d.r=="bigint"&&typeof d.s=="bigint";if(!R&&!O)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let M,q;try{if(O&&(M=new h(d.r,d.s)),R){try{_!=="compact"&&(M=h.fromDER(d))}catch(Bt){if(!(Bt instanceof Ft.Err))throw Bt}!M&&_!=="der"&&(M=h.fromCompact(d))}q=c.fromHex(C)}catch{return!1}if(!M||x&&M.hasHighS())return!1;A&&(I=t.hash(I));let{r:F,s:et}=M,Q=U(I),ut=a(et),yt=i(Q*ut),it=i(F*ut),lt=c.BASE.multiplyAndAddUnsafe(q,yt,it)?.toAffine();return lt?i(lt.x)===F:!1}return{CURVE:t,getPublicKey:v,getSharedSecret:B,sign:N,verify:nt,ProjectivePoint:c,Signature:h,utils:b}}function Au(r){return{hash:r,hmac:(t,...e)=>fo(r,t,hn(...e)),randomBytes:cr}}function Qs(r,t){let e=n=>Js({...r,...Au(n)});return{...e(t),create:e}}var ri=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),ti=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),vu=BigInt(1),ho=BigInt(2),ei=(r,t)=>(r+t/ho)/t;function Bu(r){let t=ri,e=BigInt(3),n=BigInt(6),o=BigInt(11),s=BigInt(22),i=BigInt(23),a=BigInt(44),c=BigInt(88),f=r*r*r%t,u=f*f*r%t,l=Y(u,e,t)*u%t,p=Y(l,e,t)*u%t,w=Y(p,ho,t)*f%t,E=Y(w,o,t)*w%t,y=Y(E,s,t)*E%t,h=Y(y,a,t)*y%t,b=Y(h,c,t)*h%t,v=Y(b,a,t)*y%t,m=Y(v,e,t)*u%t,B=Y(m,i,t)*E%t,D=Y(B,n,t)*f%t,U=Y(D,ho,t);if(!po.eql(po.sqr(U),r))throw new Error("Cannot find square root");return U}var po=ee(ri,void 0,void 0,{sqrt:Bu}),me=Qs({a:BigInt(0),b:BigInt(7),Fp:po,n:ti,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:r=>{let t=ti,e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-vu*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=e,i=BigInt("0x100000000000000000000000000000000"),a=ei(s*r,t),c=ei(-n*r,t),f=z(r-a*e-c*o,t),u=z(-a*n-c*s,t),l=f>i,p=u>i;if(l&&(f=t-f),p&&(u=t-u),f>i||u>i)throw new Error("splitScalar: Endomorphism failed, k="+r);return{k1neg:l,k1:f,k2neg:p,k2:u}}}},ie),Yd=BigInt(0);var Xd=me.ProjectivePoint;function ni(r){return r==null?!1:typeof r.then=="function"&&typeof r.catch=="function"&&typeof r.finally=="function"}function oi(r,t,e){let n=Oe.digest(e instanceof Uint8Array?e:e.subarray());if(ni(n))return n.then(({digest:o})=>me.verify(t,o,r)).catch(o=>{throw new $e(String(o))});try{return me.verify(t,n.digest,r)}catch(o){throw new $e(String(o))}}var Sr=class{type="secp256k1";raw;_key;constructor(t){this._key=ii(t),this.raw=si(this._key)}toMultihash(){return Tt.digest($t(this))}toCID(){return rt.createV1(114,this.toMultihash())}toString(){return $.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:at(this.raw,t.raw)}verify(t,e){return oi(this._key,e,t)}};function mo(r){return new Sr(r)}function si(r){return me.ProjectivePoint.fromHex(r).toRawBytes(!0)}function ii(r){try{return me.ProjectivePoint.fromHex(r),r}catch(t){throw new ye(String(t))}}function ai(r,t){let{Type:e,Data:n}=_t.decode(r),o=n??new Uint8Array;switch(e){case tt.RSA:return ao(o,t);case tt.Ed25519:return _n(o);case tt.secp256k1:return mo(o);case tt.ECDSA:return ln(o);default:throw new ge}}function ci(r){let{Type:t,Data:e}=_t.decode(r.digest),n=e??new Uint8Array;switch(t){case tt.Ed25519:return _n(n);case tt.secp256k1:return mo(n);case tt.ECDSA:return ln(n);default:throw new ge}}function $t(r){return _t.encode({Type:tt[r.type],Data:r.raw})}var Xe;(function(r){let t;r.codec=()=>(t==null&&(t=Vt((e,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),e.publicKey!=null&&e.publicKey.byteLength>0&&(n.uint32(10),n.bytes(e.publicKey)),e.payloadType!=null&&e.payloadType.byteLength>0&&(n.uint32(18),n.bytes(e.payloadType)),e.payload!=null&&e.payload.byteLength>0&&(n.uint32(26),n.bytes(e.payload)),e.signature!=null&&e.signature.byteLength>0&&(n.uint32(42),n.bytes(e.signature)),o.lengthDelimited!==!1&&n.ldelim()},(e,n,o={})=>{let s={publicKey:ft(0),payloadType:ft(0),payload:ft(0),signature:ft(0)},i=n==null?e.len:e.pos+n;for(;e.pos<i;){let a=e.uint32();switch(a>>>3){case 1:{s.publicKey=e.bytes();break}case 2:{s.payloadType=e.bytes();break}case 3:{s.payload=e.bytes();break}case 5:{s.signature=e.bytes();break}default:{e.skipType(a&7);break}}}return s})),t),r.encode=e=>Ht(e,r.codec()),r.decode=(e,n)=>qt(e,r.codec(),n)})(Xe||(Xe={}));var Ar=class extends Error{constructor(t="Invalid signature"){super(t),this.name="InvalidSignatureError"}};var vr=class r{static createFromProtobuf=async t=>{let e=Xe.decode(t),n=ai(e.publicKey);return new r({publicKey:n,payloadType:e.payloadType,payload:e.payload,signature:e.signature})};static seal=async(t,e)=>{if(e==null)throw new Error("Missing private key");let n=t.domain,o=t.codec,s=t.marshal(),i=ui(n,o,s),a=await e.sign(i.subarray());return new r({publicKey:e.publicKey,payloadType:o,payload:s,signature:a})};static openAndCertify=async(t,e)=>{let n=await r.createFromProtobuf(t);if(!await n.validate(e))throw new Ar("Envelope signature is not valid for the given domain");return n};publicKey;payloadType;payload;signature;marshaled;constructor(t){let{publicKey:e,payloadType:n,payload:o,signature:s}=t;this.publicKey=e,this.payloadType=n,this.payload=o,this.signature=s}marshal(){return this.marshaled==null&&(this.marshaled=Xe.encode({publicKey:$t(this.publicKey),payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(t){return at(this.marshal(),t.marshal())}async validate(t){let e=ui(t,this.payloadType,this.payload);return this.publicKey.verify(e.subarray(),this.signature)}},ui=(r,t,e)=>{let n=G(r),o=Dt(n.byteLength),s=Dt(t.length),i=Dt(e.length);return new pt(o,n,s,t,i,e)};var fi=Symbol.for("nodejs.util.inspect.custom"),Iu=114,Je=class{type;multihash;publicKey;string;constructor(t){this.type=t.type,this.multihash=t.multihash,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[kr]=!0;toString(){return this.string==null&&(this.string=$.encode(this.multihash.bytes).slice(1)),this.string}toMultihash(){return this.multihash}toCID(){return rt.createV1(Iu,this.multihash)}toJSON(){return this.toString()}equals(t){if(t==null)return!1;if(t instanceof Uint8Array)return at(this.multihash.bytes,t);if(typeof t=="string")return this.toString()===t;if(t?.toMultihash()?.bytes!=null)return at(this.multihash.bytes,t.toMultihash().bytes);throw new Error("not valid Id")}[fi](){return`PeerId(${this.toString()})`}},Br=class extends Je{type="RSA";publicKey;constructor(t){super({...t,type:"RSA"}),this.publicKey=t.publicKey}},Ir=class extends Je{type="Ed25519";publicKey;constructor(t){super({...t,type:"Ed25519"}),this.publicKey=t.publicKey}},Tr=class extends Je{type="secp256k1";publicKey;constructor(t){super({...t,type:"secp256k1"}),this.publicKey=t.publicKey}},Tu=2336,Pr=class{type="url";multihash;publicKey;url;constructor(t){this.url=t.toString(),this.multihash=Tt.digest(G(this.url))}[fi](){return`PeerId(${this.url})`}[kr]=!0;toString(){return this.toCID().toString()}toMultihash(){return this.multihash}toCID(){return rt.createV1(Tu,this.toMultihash())}toJSON(){return this.toString()}equals(t){return t==null?!1:(t instanceof Uint8Array&&(t=k(t)),t.toString()===this.toString())}};function li(r){if(Lu(r))return new Br({multihash:r});if(Pu(r))try{let t=ci(r);if(t.type==="Ed25519")return new Ir({multihash:r,publicKey:t});if(t.type==="secp256k1")return new Tr({multihash:r,publicKey:t})}catch{let e=k(r.digest);return new Pr(new URL(e))}throw new er("Supplied PeerID Multihash is invalid")}function Pu(r){return r.code===Tt.code}function Lu(r){return r.code===Oe.code}function hi(r,t){let e=(n,o)=>n.toString().localeCompare(o.toString());return r.length!==t.length?!1:(t.sort(e),r.sort(e).every((n,o)=>t[o].equals(n)))}var Lr=class{index=0;input="";new(t){return this.index=0,this.input=t,this}readAtomically(t){let e=this.index,n=t();return n===void 0&&(this.index=e),n}parseWith(t){let e=t();if(this.index===this.input.length)return e}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(t){return this.readAtomically(()=>{let e=this.readChar();if(e===t)return e})}readSeparator(t,e,n){return this.readAtomically(()=>{if(!(e>0&&this.readGivenChar(t)===void 0))return n()})}readNumber(t,e,n,o){return this.readAtomically(()=>{let s=0,i=0,a=this.peekChar();if(a===void 0)return;let c=a==="0",f=2**(8*o)-1;for(;;){let u=this.readAtomically(()=>{let l=this.readChar();if(l===void 0)return;let p=Number.parseInt(l,t);if(!Number.isNaN(p))return p});if(u===void 0)break;if(s*=t,s+=u,s>f||(i+=1,e!==void 0&&i>e))return}if(i!==0)return!n&&c&&i>1?void 0:s})}readIPv4Addr(){return this.readAtomically(()=>{let t=new Uint8Array(4);for(let e=0;e<t.length;e++){let n=this.readSeparator(".",e,()=>this.readNumber(10,3,!1,1));if(n===void 0)return;t[e]=n}return t})}readIPv6Addr(){let t=e=>{for(let n=0;n<e.length/2;n++){let o=n*2;if(n<e.length-3){let i=this.readSeparator(":",n,()=>this.readIPv4Addr());if(i!==void 0)return e[o]=i[0],e[o+1]=i[1],e[o+2]=i[2],e[o+3]=i[3],[o+4,!0]}let s=this.readSeparator(":",n,()=>this.readNumber(16,4,!0,2));if(s===void 0)return[o,!1];e[o]=s>>8,e[o+1]=s&255}return[e.length,!1]};return this.readAtomically(()=>{let e=new Uint8Array(16),[n,o]=t(e);if(n===16)return e;if(o||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;let s=new Uint8Array(14),i=16-(n+2),[a]=t(s.subarray(0,i));return e.set(s.subarray(0,a),16-a),e})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}};var di=45,Cu=15,Ue=new Lr;function yo(r){if(!(r.length>Cu))return Ue.new(r).parseWith(()=>Ue.readIPv4Addr())}function go(r){if(r.includes("%")&&(r=r.split("%")[0]),!(r.length>di))return Ue.new(r).parseWith(()=>Ue.readIPv6Addr())}function Cr(r,t=!1){if(r.includes("%")&&(r=r.split("%")[0]),r.length>di)return;let e=Ue.new(r).parseWith(()=>Ue.readIPAddr());if(e)return t&&e.length===4?Uint8Array.from([0,0,0,0,0,0,0,0,0,0,255,255,e[0],e[1],e[2],e[3]]):e}var v0=parseInt("0xFFFF",16),B0=new Uint8Array([0,0,0,0,0,0,0,0,0,0,255,255]);function yi(r){return!!yo(r)}function gi(r){return!!go(r)}function Ur(r){return!!Cr(r)}var bi=yi,Ru=gi,bo=function(r){let t=0;if(r=r.toString().trim(),bi(r)){let e=new Uint8Array(t+4);return r.split(/\./g).forEach(n=>{e[t++]=parseInt(n,10)&255}),e}if(Ru(r)){let e=r.split(":",8),n;for(n=0;n<e.length;n++){let s=bi(e[n]),i;s&&(i=bo(e[n]),e[n]=k(i.slice(0,2),"base16")),i!=null&&++n<8&&e.splice(n,0,k(i.slice(2,4),"base16"))}if(e[0]==="")for(;e.length<8;)e.unshift("0");else if(e[e.length-1]==="")for(;e.length<8;)e.push("0");else if(e.length<8){for(n=0;n<e.length&&e[n]!=="";n++);let s=[n,1];for(n=9-e.length;n>0;n--)s.push("0");e.splice.apply(e,s)}let o=new Uint8Array(t+16);for(n=0;n<e.length;n++){let s=parseInt(e[n],16);o[t++]=s>>8&255,o[t++]=s&255}return o}throw new Error("invalid ip address")},xi=function(r,t=0,e){t=~~t,e=e??r.length-t;let n=new DataView(r.buffer);if(e===4){let o=[];for(let s=0;s<e;s++)o.push(r[t+s]);return o.join(".")}if(e===16){let o=[];for(let s=0;s<e;s+=2)o.push(n.getUint16(t+s).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var De={},xo={},ku=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[481,-1,"http-path"],[777,-1,"memory"]];ku.forEach(r=>{let t=Ou(...r);xo[t.code]=t,De[t.name]=t});function Ou(r,t,e,n,o){return{code:r,size:t,name:e,resolvable:!!n,path:!!o}}function j(r){if(typeof r=="number"){if(xo[r]!=null)return xo[r];throw new Error(`no protocol with code: ${r}`)}else if(typeof r=="string"){if(De[r]!=null)return De[r];throw new Error(`no protocol with name: ${r}`)}throw new Error(`invalid protocol id type: ${typeof r}`)}var cm=j("ip4"),um=j("ip6"),fm=j("ipcidr");function Ao(r,t){switch(j(r).code){case 4:case 41:return qu(t);case 42:return So(t);case 43:return k(t,"base10");case 6:case 273:case 33:case 132:return Si(t).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return So(t);case 421:return zu(t);case 444:return Ei(t);case 445:return Ei(t);case 466:return Fu(t);case 481:return globalThis.encodeURIComponent(So(t));default:return k(t,"base16")}}function vo(r,t){switch(j(r).code){case 4:return wi(t);case 41:return wi(t);case 42:return Eo(t);case 43:return G(t,"base10");case 6:case 273:case 33:case 132:return Bo(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return Eo(t);case 421:return Hu(t);case 444:return Gu(t);case 445:return ju(t);case 466:return Vu(t);case 481:return Eo(globalThis.decodeURIComponent(t));default:return G(t,"base16")}}var wo=Object.values(Me).map(r=>r.decoder),Mu=function(){let r=wo[0].or(wo[1]);return wo.slice(2).forEach(t=>r=r.or(t)),r}();function wi(r){if(!Ur(r))throw new Error("invalid ip address");return bo(r)}function qu(r){let t=xi(r,0,r.length);if(t==null)throw new Error("ipBuff is required");if(!Ur(t))throw new Error("invalid ip address");return t}function Bo(r){let t=new ArrayBuffer(2);return new DataView(t).setUint16(0,r),new Uint8Array(t)}function Si(r){return new DataView(r.buffer).getUint16(r.byteOffset)}function Eo(r){let t=G(r),e=Uint8Array.from(Dt(t.length));return St([e,t],e.length+t.length)}function So(r){let t=he(r);if(r=r.slice(wt(t)),r.length!==t)throw new Error("inconsistent lengths");return k(r)}function Hu(r){let t;r[0]==="Q"||r[0]==="1"?t=oe($.decode(`z${r}`)).bytes:t=rt.parse(r).multihash.bytes;let e=Uint8Array.from(Dt(t.length));return St([e,t],e.length+t.length)}function Vu(r){let t=Mu.decode(r),e=Uint8Array.from(Dt(t.length));return St([e,t],e.length+t.length)}function Fu(r){let t=he(r),e=r.slice(wt(t));if(e.length!==t)throw new Error("inconsistent lengths");return"u"+k(e,"base64url")}function zu(r){let t=he(r),e=r.slice(wt(t));if(e.length!==t)throw new Error("inconsistent lengths");return k(e,"base58btc")}function Gu(r){let t=r.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==16)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);let e=Rt.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=Bo(n);return St([e,o],e.length+o.length)}function ju(r){let t=r.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==56)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);let e=Rt.decode(`b${t[0]}`),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=Bo(n);return St([e,o],e.length+o.length)}function Ei(r){let t=r.slice(0,r.length-2),e=r.slice(r.length-2),n=k(t,"base32"),o=Si(e);return`${n}:${o}`}function Ai(r){r=Io(r);let t=[],e=[],n=null,o=r.split("/").slice(1);if(o.length===1&&o[0]==="")return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let s=0;s<o.length;s++){let i=o[s],a=j(i);if(a.size===0){t.push([a.code]),e.push([a.code]);continue}if(s++,s>=o.length)throw new Dr("invalid address: "+r);if(a.path===!0){n=Io(o.slice(s).join("/")),t.push([a.code,vo(a.code,n)]),e.push([a.code,n]);break}let c=vo(a.code,o[s]);t.push([a.code,c]),e.push([a.code,Ao(a.code,c)])}return{string:vi(e),bytes:_r(t),tuples:t,stringTuples:e,path:n}}function To(r){let t=[],e=[],n=null,o=0;for(;o<r.length;){let s=he(r,o),i=wt(s),a=j(s),c=Zu(a,r.slice(o+i));if(c===0){t.push([s]),e.push([s]),o+=i;continue}let f=r.slice(o+i,o+i+c);if(o+=c+i,o>r.length)throw new Dr("Invalid address Uint8Array: "+k(r,"base16"));t.push([s,f]);let u=Ao(s,f);if(e.push([s,u]),a.path===!0){n=u;break}}return{bytes:Uint8Array.from(r),string:vi(e),tuples:t,stringTuples:e,path:n}}function vi(r){let t=[];return r.map(e=>{let n=j(e[0]);return t.push(n.name),e.length>1&&e[1]!=null&&t.push(e[1]),null}),Io(t.join("/"))}function _r(r){return St(r.map(t=>{let e=j(t[0]),n=Uint8Array.from(Dt(e.code));return t.length>1&&t[1]!=null&&(n=St([n,t[1]])),n}))}function Zu(r,t){if(r.size>0)return r.size/8;if(r.size===0)return 0;{let e=he(t instanceof Uint8Array?t:Uint8Array.from(t));return e+wt(e)}}function Io(r){return"/"+r.trim().split("/").filter(t=>t).join("/")}var Dr=class extends Error{static name="ParseError";name="ParseError";constructor(t){super(`Error parsing address: ${t}`)}};var $u=Symbol.for("nodejs.util.inspect.custom"),Lo=Symbol.for("@multiformats/js-multiaddr/multiaddr"),Wu=[j("dns").code,j("dns4").code,j("dns6").code,j("dnsaddr").code],Po=class extends Error{constructor(t="No available resolver"){super(t),this.name="NoAvailableResolverError"}},Kr=class r{bytes;#e;#t;#r;#n;[Lo]=!0;constructor(t){t==null&&(t="");let e;if(t instanceof Uint8Array)e=To(t);else if(typeof t=="string"){if(t.length>0&&t.charAt(0)!=="/")throw new Error(`multiaddr "${t}" must start with a "/"`);e=Ai(t)}else if(Ii(t))e=To(t.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=e.bytes,this.#e=e.string,this.#t=e.tuples,this.#r=e.stringTuples,this.#n=e.path}toString(){return this.#e}toJSON(){return this.toString()}toOptions(){let t,e,n,o,s="",i=j("tcp"),a=j("udp"),c=j("ip4"),f=j("ip6"),u=j("dns6"),l=j("ip6zone");for(let[w,E]of this.stringTuples())w===l.code&&(s=`%${E??""}`),Wu.includes(w)&&(e=i.name==="tcp"?"tcp":"udp",o=443,n=`${E??""}${s}`,t=w===u.code?6:4),(w===i.code||w===a.code)&&(e=j(w).name==="tcp"?"tcp":"udp",o=parseInt(E??"")),(w===c.code||w===f.code)&&(e=j(w).name==="tcp"?"tcp":"udp",n=`${E??""}${s}`,t=w===f.code?6:4);if(t==null||e==null||n==null||o==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:t,host:n,transport:e,port:o}}protos(){return this.#t.map(([t])=>Object.assign({},j(t)))}protoCodes(){return this.#t.map(([t])=>t)}protoNames(){return this.#t.map(([t])=>j(t).name)}tuples(){return this.#t.map(([t,e])=>e==null?[t]:[t,e])}stringTuples(){return this.#r.map(([t,e])=>e==null?[t]:[t,e])}encapsulate(t){return t=new r(t),new r(this.toString()+t.toString())}decapsulate(t){let e=t.toString(),n=this.toString(),o=n.lastIndexOf(e);if(o<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${t.toString()}`);return new r(n.slice(0,o))}decapsulateCode(t){let e=this.tuples();for(let n=e.length-1;n>=0;n--)if(e[n][0]===t)return new r(_r(e.slice(0,n)));return this}getPeerId(){try{let t=[];this.stringTuples().forEach(([n,o])=>{n===De.p2p.code&&t.push([n,o]),n===De["p2p-circuit"].code&&(t=[])});let e=t.pop();if(e?.[1]!=null){let n=e[1];return n[0]==="Q"||n[0]==="1"?k($.decode(`z${n}`),"base58btc"):k(rt.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){return this.#n}equals(t){return at(this.bytes,t.bytes)}async resolve(t){let e=this.protos().find(s=>s.resolvable);if(e==null)return[this];let n=Bi.get(e.name);if(n==null)throw new Po(`no available resolver for ${e.name}`);return(await n(this,t)).map(s=>Qe(s))}nodeAddress(){let t=this.toOptions();if(t.transport!=="tcp"&&t.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${t.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:t.family,address:t.host,port:t.port}}isThinWaistAddress(t){let e=(t??this).protos();return!(e.length!==2||e[0].code!==4&&e[0].code!==41||e[1].code!==6&&e[1].code!==273)}[$u](){return`Multiaddr(${this.#e})`}};var Bi=new Map;function Ii(r){return!!r?.[Lo]}function Qe(r){return new Kr(r)}var Ti="libp2p-peer-record",Pi=Uint8Array.from([3,1]);var tr;(function(r){let t;(function(n){let o;n.codec=()=>(o==null&&(o=Vt((s,i,a={})=>{a.lengthDelimited!==!1&&i.fork(),s.multiaddr!=null&&s.multiaddr.byteLength>0&&(i.uint32(10),i.bytes(s.multiaddr)),a.lengthDelimited!==!1&&i.ldelim()},(s,i,a={})=>{let c={multiaddr:ft(0)},f=i==null?s.len:s.pos+i;for(;s.pos<f;){let u=s.uint32();switch(u>>>3){case 1:{c.multiaddr=s.bytes();break}default:{s.skipType(u&7);break}}}return c})),o),n.encode=s=>Ht(s,n.codec()),n.decode=(s,i)=>qt(s,n.codec(),i)})(t=r.AddressInfo||(r.AddressInfo={}));let e;r.codec=()=>(e==null&&(e=Vt((n,o,s={})=>{if(s.lengthDelimited!==!1&&o.fork(),n.peerId!=null&&n.peerId.byteLength>0&&(o.uint32(10),o.bytes(n.peerId)),n.seq!=null&&n.seq!==0n&&(o.uint32(16),o.uint64(n.seq)),n.addresses!=null)for(let i of n.addresses)o.uint32(26),r.AddressInfo.codec().encode(i,o);s.lengthDelimited!==!1&&o.ldelim()},(n,o,s={})=>{let i={peerId:ft(0),seq:0n,addresses:[]},a=o==null?n.len:n.pos+o;for(;n.pos<a;){let c=n.uint32();switch(c>>>3){case 1:{i.peerId=n.bytes();break}case 2:{i.seq=n.uint64();break}case 3:{if(s.limits?.addresses!=null&&i.addresses.length===s.limits.addresses)throw new xr('Decode error - map field "addresses" had too many elements');i.addresses.push(r.AddressInfo.codec().decode(n,n.uint32(),{limits:s.limits?.addresses$}));break}default:{n.skipType(c&7);break}}}return i})),e),r.encode=n=>Ht(n,r.codec()),r.decode=(n,o)=>qt(n,r.codec(),o)})(tr||(tr={}));var Rr=class r{static createFromProtobuf=t=>{let e=tr.decode(t),n=li(oe(e.peerId)),o=(e.addresses??[]).map(i=>Qe(i.multiaddr)),s=e.seq;return new r({peerId:n,multiaddrs:o,seqNumber:s})};static DOMAIN=Ti;static CODEC=Pi;peerId;multiaddrs;seqNumber;domain=r.DOMAIN;codec=r.CODEC;marshaled;constructor(t){let{peerId:e,multiaddrs:n,seqNumber:o}=t;this.peerId=e,this.multiaddrs=n??[],this.seqNumber=o??BigInt(Date.now())}marshal(){return this.marshaled==null&&(this.marshaled=tr.encode({peerId:this.peerId.toMultihash().bytes,seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map(t=>({multiaddr:t.bytes}))})),this.marshaled}equals(t){return!(!(t instanceof r)||!this.peerId.equals(t.peerId)||this.seqNumber!==t.seqNumber||!hi(this.multiaddrs,t.multiaddrs))}};return ki(Yu);})();
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
return Libp2PPeerRecord}));
